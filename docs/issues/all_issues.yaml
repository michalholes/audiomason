issues:
  -
    comments:
      -
        body: "Resolved and tested.\n\nFixed by commits:\n1aa452a Issue #1: destination conflict handling (overwrite, fallback to abooks_ready, optional new folder)"
        created_at: "2025-12-31T18:27:18Z"
        html_url: "https://github.com/michalholes/audiomason/issues/1#issuecomment-3702665413"
        id: 3702665413
        updated_at: "2025-12-31T18:27:18Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "If destination directory already exists, stop processing that book.\n\n- Print:\n  [conflict] Author / Book already exists\n- Must never silently overwrite.\n- Applies to both: stage->output move and publish step.\n\nAcceptance:\n- Existing target dir => book is skipped/aborted with [conflict] message.\n- Exit code non-zero if any conflicts encountered (unless --yes defines otherwise)."
      closed_at: "2025-12-31T18:27:18Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:23:07Z"
      html_url: "https://github.com/michalholes/audiomason/issues/1"
      labels:
        -
          name: "feature"
        -
          name: "p0"
      milestone: null
      number: 1
      state: "closed"
      title: "Conflict detection in output (no overwrite)"
      updated_at: "2025-12-31T18:27:18Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:20Z"
        event: "labeled"
        id: 21807295580
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:20Z"
        event: "labeled"
        id: 21807295595
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "1aa452acf8eb92e51005195e66538f9a14e22ece"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/1aa452acf8eb92e51005195e66538f9a14e22ece"
        created_at: "2025-12-31T18:07:45Z"
        event: "referenced"
        id: 21811659759
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T18:27:18Z"
        event: "commented"
        id: 3702665413
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T18:27:19Z"
        event: "closed"
        id: 21811855419
  -
    comments:
      -
        body: "Resolved and tested.\n\nFixed by commits:\n5833108 Issue #2: pass stage_run to _process_book for dry-run summary file\n8900b76 Issue #2: write per-book dry-run summary file to stage_run\ndf1507a Issue #2: dry-run must not mutate FS (no stage clean/overwrite); ensure dryrun file written\nc028221 Issue #2: fix dry-run summary indentation (and remove datetime dependency)\n0c1a158 Issue #2: write human-readable dry-run summary to disk (per book)\ne1e049c Issue #24.3: stage reuse prompt + optional manifest answers (skip or default)\n810f345 Issue #24.3: bypass prompts when manifest already has answers\nb28049b Issue #24.2: fix indentation in stage reuse block\n56cdf39 Issue #24.2: reuse stage when fingerprint matches (skip re-copy)\nd3b70f5 Issue #24.1: write stage manifest.json (atomic) for preflight decisions"
        created_at: "2025-12-31T19:44:10Z"
        html_url: "https://github.com/michalholes/audiomason/issues/2#issuecomment-3702780362"
        id: 3702780362
        updated_at: "2025-12-31T19:44:10Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "--dry-run prints:\n- which books will be processed (source + book labels)\n- destination paths (author/book)\n- publish yes/no\n- ID3 wipe yes/no\n\nNo unpack, no convert, no cover writes, no tag writes, no mkdir, no move.\n\nAcceptance:\n- Running with --dry-run causes zero filesystem modifications.\n- Output includes a deterministic summary block per selected source."
      closed_at: "2025-12-31T19:44:11Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:23:08Z"
      html_url: "https://github.com/michalholes/audiomason/issues/2"
      labels:
        -
          name: "feature"
        -
          name: "p0"
      milestone: null
      number: 2
      state: "closed"
      title: "Dry-run summary (no filesystem changes)"
      updated_at: "2025-12-31T19:44:11Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:14Z"
        event: "labeled"
        id: 21807294733
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:15Z"
        event: "labeled"
        id: 21807294744
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "0c1a158580230c4e5dc670a36378a86b6e74dc8a"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/0c1a158580230c4e5dc670a36378a86b6e74dc8a"
        created_at: "2025-12-31T18:45:40Z"
        event: "referenced"
        id: 21812042446
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "c028221e319ebe5c176ca4560e4e095274d07441"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/c028221e319ebe5c176ca4560e4e095274d07441"
        created_at: "2025-12-31T18:47:55Z"
        event: "referenced"
        id: 21812064838
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "df1507a67a2e459e33a6edf8e4154bf755a775d2"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/df1507a67a2e459e33a6edf8e4154bf755a775d2"
        created_at: "2025-12-31T19:34:04Z"
        event: "referenced"
        id: 21812526766
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "8900b760c9dbaa07f984479ac611514c83fb5517"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/8900b760c9dbaa07f984479ac611514c83fb5517"
        created_at: "2025-12-31T19:38:32Z"
        event: "referenced"
        id: 21812570702
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "5833108e88619b289a7d2d95acd05684ae3085b4"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/5833108e88619b289a7d2d95acd05684ae3085b4"
        created_at: "2025-12-31T19:42:07Z"
        event: "referenced"
        id: 21812606065
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T19:44:10Z"
        event: "commented"
        id: 3702780362
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T19:44:11Z"
        event: "closed"
        id: 21812630467
  -
    comments:
      -
        body: "Fixed: canonical [source] and [book] log labels in import_flow.py"
        created_at: "2025-12-31T12:03:11Z"
        html_url: "https://github.com/michalholes/audiomason/issues/3#issuecomment-3702075895"
        id: 3702075895
        updated_at: "2025-12-31T12:03:11Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "All logs must use:\n[source] <n>/<total>: <src>\n[book]   <i>/<count>: <book>\n\nApplies to preflight prompts, processing, conflicts, skips, publish.\n\nAcceptance:\n- Grep for \"[source]\" and \"[book]\" shows only the canonical format."
      closed_at: "2025-12-31T12:03:11Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:23:09Z"
      html_url: "https://github.com/michalholes/audiomason/issues/3"
      labels:
        -
          name: "bug"
        -
          name: "p0"
      milestone: null
      number: 3
      state: "closed"
      title: "Consistent source/book labels in logs"
      updated_at: "2025-12-31T12:03:11Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:41:54Z"
        event: "labeled"
        id: 21807291773
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:41:54Z"
        event: "labeled"
        id: 21807291779
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T12:03:11Z"
        event: "closed"
        id: 21807951692
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T12:03:11Z"
        event: "commented"
        id: 3702075895
  -
    comments:
      -
        body: "Fixed on main and verified: Ctrl-C prints '[abort] cancelled by user' (no traceback) and exits with code 130."
        created_at: "2025-12-31T13:31:55Z"
        html_url: "https://github.com/michalholes/audiomason/issues/4#issuecomment-3702218672"
        id: 3702218672
        updated_at: "2025-12-31T13:31:55Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Ctrl-C should stop cleanly:\n- finish/terminate current ffmpeg step\n- do not delete or corrupt stage\n\nNext run reuses stage deterministically and continues.\n\nAcceptance:\n- Interrupt during split leaves stage intact.\n- Re-run continues without re-unpack and without overwriting stage."
      closed_at: "2025-12-31T13:31:56Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:23:11Z"
      html_url: "https://github.com/michalholes/audiomason/issues/4"
      labels:
        -
          name: "bug"
        -
          name: "p1"
      milestone: null
      number: 4
      state: "closed"
      title: "Resume after Ctrl-C (keep stage, continue next run)"
      updated_at: "2025-12-31T13:31:56Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:04Z"
        event: "labeled"
        id: 21807293146
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:04Z"
        event: "labeled"
        id: 21807293158
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T13:31:55Z"
        event: "commented"
        id: 3702218672
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T13:31:56Z"
        event: "closed"
        id: 21808955012
  -
    comments:
      -
        body: "Implemented read-only 'am inspect <source>' command with correct CLI dispatch and fully self-contained inspection logic (no staging, no FS mutation).\n\nCommits:\n- 2336b58 (initial wiring attempts for inspect)\n- 589894c (final fix: stable inspect implementation, self-contained audio/archive detection)"
        created_at: "2025-12-31T21:02:39Z"
        html_url: "https://github.com/michalholes/audiomason/issues/5#issuecomment-3702894654"
        id: 3702894654
        updated_at: "2025-12-31T21:02:39Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "New command: am inspect <source>\n\nMust be read-only:\n- no staging, no copying, no unpack, no writes\n\nPrints:\n- number of books\n- root audio present?\n- chapters count (if m4a present)\n\nAcceptance:\n- Running inspect produces no filesystem changes."
      closed_at: "2025-12-31T20:28:56Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:23:13Z"
      html_url: "https://github.com/michalholes/audiomason/issues/5"
      labels:
        -
          name: "bug"
        -
          name: "feature"
        -
          name: "p1"
      milestone: null
      number: 5
      state: "closed"
      title: "am inspect <source> (read-only analysis)"
      updated_at: "2025-12-31T21:02:39Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:01Z"
        event: "labeled"
        id: 21807292719
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:01Z"
        event: "labeled"
        id: 21807292727
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:26Z"
        event: "labeled"
        id: 21807296371
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "847ae7736a4846cd8845b14272b138b5f9c2e667"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/847ae7736a4846cd8845b14272b138b5f9c2e667"
        created_at: "2025-12-31T20:23:12Z"
        event: "referenced"
        id: 21813061103
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "c2ea9fde8e4a918a4946650460350b4c15c2b5ff"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/c2ea9fde8e4a918a4946650460350b4c15c2b5ff"
        created_at: "2025-12-31T20:26:15Z"
        event: "referenced"
        id: 21813087903
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "2336b581815b3ba29a9bfd44178c715e20b69351"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/2336b581815b3ba29a9bfd44178c715e20b69351"
        created_at: "2025-12-31T20:28:56Z"
        event: "closed"
        id: 21813114041
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "89f978de41c598edd232302be6f70a20c4cc0971"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/89f978de41c598edd232302be6f70a20c4cc0971"
        created_at: "2025-12-31T20:35:18Z"
        event: "referenced"
        id: 21813182052
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "095a83f2618098913bb42877c6f7126ef24f04a3"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/095a83f2618098913bb42877c6f7126ef24f04a3"
        created_at: "2025-12-31T20:37:11Z"
        event: "referenced"
        id: 21813199924
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "6d781eec28a472b1dbc184f53d7ef52e22879069"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/6d781eec28a472b1dbc184f53d7ef52e22879069"
        created_at: "2025-12-31T20:56:02Z"
        event: "referenced"
        id: 21813376236
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e2baf7e89107a7c4d5ff03874610c54365c0a541"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e2baf7e89107a7c4d5ff03874610c54365c0a541"
        created_at: "2025-12-31T20:57:52Z"
        event: "referenced"
        id: 21813394062
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "589894ce3053eaf505f2f3cedb467ecaa2aca691"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/589894ce3053eaf505f2f3cedb467ecaa2aca691"
        created_at: "2025-12-31T21:01:35Z"
        event: "referenced"
        id: 21813429754
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T21:02:39Z"
        event: "commented"
        id: 3702894654
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Optional helper suggests cleaned names by removing common noise:\n- (2021)(CZ)\n- (audiokniha)\n- bitrate/narrator info\n\nUser must confirm suggested normalized names.\n\nAcceptance:\n- Helper never changes output unless user confirms.\n- Default remains current behavior."
      closed_at: "2025-12-31T21:36:44Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:23:14Z"
      html_url: "https://github.com/michalholes/audiomason/issues/6"
      labels:
        -
          name: "feature"
        -
          name: "ux"
        -
          name: "p2"
      milestone: null
      number: 6
      state: "closed"
      title: "Normalized author/book naming helper (confirm before apply)"
      updated_at: "2025-12-31T21:36:44Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:34Z"
        event: "labeled"
        id: 21807297331
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:34Z"
        event: "labeled"
        id: 21807297336
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:34Z"
        event: "labeled"
        id: 21807297342
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "fadf36c826c94661fbc52549517e88ce8dc05d72"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/fadf36c826c94661fbc52549517e88ce8dc05d72"
        created_at: "2025-12-31T21:30:57Z"
        event: "referenced"
        id: 21813686149
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "d7963456fad69579d0c62608adf6b8380ffc9511"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/d7963456fad69579d0c62608adf6b8380ffc9511"
        created_at: "2025-12-31T21:33:03Z"
        event: "referenced"
        id: 21813702335
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "6829683a3ca6ea76b5ce461fc6ecba1dad1570a2"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/6829683a3ca6ea76b5ce461fc6ecba1dad1570a2"
        created_at: "2025-12-31T21:36:44Z"
        event: "closed"
        id: 21813730546
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "d9c0cea4713cc74ef6e16fc33183a63840c0dcc5"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/d9c0cea4713cc74ef6e16fc33183a63840c0dcc5"
        created_at: "2025-12-31T21:51:56Z"
        event: "referenced"
        id: 21813851178
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e588ff82475acd8cfcaa321978f8a6fe65066d7e"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e588ff82475acd8cfcaa321978f8a6fe65066d7e"
        created_at: "2025-12-31T22:56:55Z"
        event: "referenced"
        id: 21814272310
  -
    comments:
      -
        body: "Resolved by commit: 35abe54"
        created_at: "2026-01-01T08:53:05Z"
        html_url: "https://github.com/michalholes/audiomason/issues/7#issuecomment-3703431425"
        id: 3703431425
        updated_at: "2026-01-01T08:53:05Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "--quiet => only errors\n--verbose => include ffmpeg + unpack details\ndefault = current behavior\n\nAcceptance:\n- quiet suppresses progress logs.\n- verbose shows underlying commands and detailed steps."
      closed_at: "2026-01-01T08:53:05Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:23:15Z"
      html_url: "https://github.com/michalholes/audiomason/issues/7"
      labels:
        -
          name: "feature"
        -
          name: "p2"
      milestone: null
      number: 7
      state: "closed"
      title: "Logging levels (--quiet/--verbose)"
      updated_at: "2026-01-01T08:53:05Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:57:52Z"
        event: "labeled"
        id: 21807421454
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:57:52Z"
        event: "labeled"
        id: 21807421457
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T08:53:05Z"
        event: "closed"
        id: 21816874423
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T08:53:05Z"
        event: "commented"
        id: 3703431425
  -
    comments:
      -
        body: "Implemented online author/book validation via OpenLibrary in 'am verify' (read-only), with CLI toggles --lookup/--no-lookup.\n\nCommit:\n- 6813c9c Feature: OpenLibrary validation for author/book names (verify; --lookup/--no-lookup)"
        created_at: "2025-12-31T21:23:56Z"
        html_url: "https://github.com/michalholes/audiomason/issues/8#issuecomment-3702920746"
        id: 3702920746
        updated_at: "2025-12-31T21:23:56Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "After meta is collected (author + book), validate against public DB (OpenLibrary).\n\nIf not found:\n- warn user\n- prompt:\n  1) Continue as-is\n  2) Search similar titles\n\nIf 2) suggest max 5 similar titles.\n\nAcceptance:\n- Works without breaking offline runs (feature-gated / optional).\n- Never auto-changes metadata without confirmation."
      closed_at: "2025-12-31T21:23:58Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:23:17Z"
      html_url: "https://github.com/michalholes/audiomason/issues/8"
      labels:
        -
          name: "feature"
        -
          name: "p3"
      milestone: null
      number: 8
      state: "closed"
      title: "Public database validation (OpenLibrary) (DEFERRED)"
      updated_at: "2025-12-31T21:23:58Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:43Z"
        event: "labeled"
        id: 21807298441
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:43Z"
        event: "labeled"
        id: 21807298450
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T21:23:56Z"
        event: "commented"
        id: 3702920746
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T21:23:58Z"
        event: "closed"
        id: 21813633060
  -
    comments:
      -
        body: "Implemented full TRACE debug mode: --debug now logs every high-level out() line and all low-level operations (os/shutil/subprocess) as [TRACE]/[TRACE-OP], with no behavior change."
        created_at: "2025-12-31T17:11:38Z"
        html_url: "https://github.com/michalholes/audiomason/issues/9#issuecomment-3702536516"
        id: 3702536516
        updated_at: "2025-12-31T17:11:38Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Add a DEBUG logging level that prints *everything* the tool does.\n\nRequirements:\n- New flag: --debug (or --log-level debug)\n- DEBUG outputs:\n  - every filesystem operation (mkdir/copy/move/remove)\n  - every external command (ffmpeg/unpack) including full argv\n  - all resolved paths (drop/stage/output/archive) + env overrides\n  - every decision (reuse stage, skip, conflict, dry-run plan)\n  - per-book and per-source state transitions\n\nPriority: HIGH\n\nAcceptance:\n- With --debug, user can reconstruct the full pipeline deterministically from logs.\n- Default behavior unchanged.\n- --quiet still suppresses non-errors (debug must not override quiet unless explicitly chosen)."
      closed_at: "2025-12-31T17:11:39Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:24:53Z"
      html_url: "https://github.com/michalholes/audiomason/issues/9"
      labels:
        -
          name: "bug"
        -
          name: "feature"
        -
          name: "p0"
        -
          name: "p1"
      milestone: null
      number: 9
      state: "closed"
      title: "Logging: add DEBUG level (print every action) [HIGH]"
      updated_at: "2025-12-31T17:11:39Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:05Z"
        event: "labeled"
        id: 21807293445
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:05Z"
        event: "labeled"
        id: 21807293456
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:23Z"
        event: "labeled"
        id: 21807295968
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:23Z"
        event: "labeled"
        id: 21807295975
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "2c9b34005047a328a461f9437356c8f87cb3dd69"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/2c9b34005047a328a461f9437356c8f87cb3dd69"
        created_at: "2025-12-31T16:40:54Z"
        event: "referenced"
        id: 21810796087
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "43aba51d8c0e9b9483ca9c7305fbc65eb85af199"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/43aba51d8c0e9b9483ca9c7305fbc65eb85af199"
        created_at: "2025-12-31T16:45:28Z"
        event: "referenced"
        id: 21810839134
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "94f7298291200f34b64b98c3b5bbf9b1c89ace1d"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/94f7298291200f34b64b98c3b5bbf9b1c89ace1d"
        created_at: "2025-12-31T16:48:35Z"
        event: "referenced"
        id: 21810866066
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "028e04c88d0847f7e3c7d58adbcddc857b5bdd8a"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/028e04c88d0847f7e3c7d58adbcddc857b5bdd8a"
        created_at: "2025-12-31T17:05:09Z"
        event: "referenced"
        id: 21811019967
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "67b6f63879bb70a55fbb916f9a2b4d92e79d73b3"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/67b6f63879bb70a55fbb916f9a2b4d92e79d73b3"
        created_at: "2025-12-31T17:09:35Z"
        event: "referenced"
        id: 21811055861
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T17:11:38Z"
        event: "commented"
        id: 3702536516
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:11:39Z"
        event: "closed"
        id: 21811083896
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Fix archive iteration so ALL books are processed.\n\nRequirements:\n- Detect __ROOT_AUDIO__ + every top-level directory as a separate book\n- When selecting 'all':\n  - prompt for metadata for EACH book\n  - clearly print which folder/book is being asked about\n- Process root audio AND subdirectories independently\n\nAcceptance:\n- No book in archive is silently skipped\n- Logs show correct [book] i/n for all books"
      closed_at: "2025-12-31T12:27:57Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:14Z"
      html_url: "https://github.com/michalholes/audiomason/issues/10"
      labels:
        -
          name: "bug"
        -
          name: "p0"
        -
          name: "p1"
      milestone: null
      number: 10
      state: "closed"
      title: "Multi-book archive processing (root + subdirs) [P0]"
      updated_at: "2025-12-31T12:27:57Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:41:51Z"
        event: "labeled"
        id: 21807291303
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:41:51Z"
        event: "labeled"
        id: 21807291309
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:41:59Z"
        event: "labeled"
        id: 21807292511
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "27cb3b5f1723e5e3f21e74330b50ae23418ff40f"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/27cb3b5f1723e5e3f21e74330b50ae23418ff40f"
        created_at: "2025-12-31T12:27:57Z"
        event: "closed"
        id: 21808192259
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e0992a7feb5d1a6b4bb868d8eabac7e05ad91eed"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e0992a7feb5d1a6b4bb868d8eabac7e05ad91eed"
        created_at: "2025-12-31T12:53:36Z"
        event: "referenced"
        id: 21808443927
  -
    comments:
      -
        body: "Implemented single-pass chapter split (1 ffmpeg per book) using ffmpeg segment muxer; replaces per-chapter ffmpeg runs for major RPi4 perf win.\n\nCommit:\n- 0e1a0ec Perf: single-pass ffmpeg chapter split using segment muxer\n\nDiscussed/iterated in this chat (AudioMason project thread, Dec 31, 2025)."
        created_at: "2025-12-31T20:16:06Z"
        html_url: "https://github.com/michalholes/audiomason/issues/11#issuecomment-3702845999"
        id: 3702845999
        updated_at: "2025-12-31T20:16:06Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Replace NÃ— ffmpeg chapter splitting with single-pass split per book.\n\nRequirements:\n- One ffmpeg process per book\n- Deterministic output\n- Significantly reduced CPU usage and runtime (RPi-friendly)\n\nAcceptance:\n- Exactly one ffmpeg invocation per book\n- Output tracks identical to current behavior"
      closed_at: "2025-12-31T20:16:07Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:15Z"
      html_url: "https://github.com/michalholes/audiomason/issues/11"
      labels:
        -
          name: "feature"
        -
          name: "perf"
        -
          name: "p0"
      milestone: null
      number: 11
      state: "closed"
      title: "Single-pass chapter split (1 ffmpeg per book) [P0]"
      updated_at: "2025-12-31T20:16:07Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:12Z"
        event: "labeled"
        id: 21807294336
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:12Z"
        event: "labeled"
        id: 21807294341
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:12Z"
        event: "labeled"
        id: 21807294349
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T20:16:06Z"
        event: "commented"
        id: 3702845999
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T20:16:08Z"
        event: "closed"
        id: 21812996160
  -
    comments:
      -
        body: "Unified preflight decisions for title+cover and persisted them in manifest.\n\nCommit:\n- 53362bc BUG #12: unify preflight decisions (title+cover) and store in manifest"
        created_at: "2025-12-31T20:19:16Z"
        html_url: "https://github.com/michalholes/audiomason/issues/12#issuecomment-3702849425"
        id: 3702849425
        updated_at: "2025-12-31T20:19:16Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Ask ALL user decisions before any filesystem or ffmpeg work starts.\n\nIncludes:\n- author\n- book(s)\n- covers\n- publish yes/no\n- ID3 wipe yes/no\n\nRules:\n- No prompts during processing phase\n- One deterministic preflight block\n\nAcceptance:\n- After preflight, processing runs without interaction\n- --yes skips the entire preflight deterministically"
      closed_at: "2025-12-31T20:19:17Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:17Z"
      html_url: "https://github.com/michalholes/audiomason/issues/12"
      labels:
        -
          name: "feature"
        -
          name: "ux"
        -
          name: "p0"
      milestone: null
      number: 12
      state: "closed"
      title: "Unified preflight decision block [P0]"
      updated_at: "2025-12-31T20:19:17Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:09Z"
        event: "labeled"
        id: 21807293887
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:09Z"
        event: "labeled"
        id: 21807293897
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:09Z"
        event: "labeled"
        id: 21807293908
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "53362bc341c810691a939cf1f5f578ca746bbac2"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/53362bc341c810691a939cf1f5f578ca746bbac2"
        created_at: "2025-12-31T17:20:27Z"
        event: "referenced"
        id: 21811207339
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T20:19:16Z"
        event: "commented"
        id: 3702849425
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T20:19:17Z"
        event: "closed"
        id: 21813026493
  -
    comments:
      -
        body: "Stage reuse (deterministic resume) is implemented and verified: manifest-backed decisions, stable stage_run context, and dry-run safety ensure deterministic resumes.\n\nCommits:\n- 386675d (manifest-backed preflight / clean_stage)\n- df1507a (dry-run does not mutate FS)\n- 8900b76 (per-book dry-run summary in stage_run)\n- 5833108 (pass stage_run through processing)"
        created_at: "2025-12-31T20:21:06Z"
        html_url: "https://github.com/michalholes/audiomason/issues/13#issuecomment-3702851343"
        id: 3702851343
        updated_at: "2025-12-31T20:21:06Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Reuse existing stage safely and deterministically.\n\nRequirements:\n- If stage already exists:\n  - do not unpack again\n  - do not overwrite files\n- Enables resume after interruption\n\nAcceptance:\n- Re-run after interruption continues without re-unpack\n- Stage contents are never silently overwritten"
      closed_at: "2025-12-31T20:21:08Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:18Z"
      html_url: "https://github.com/michalholes/audiomason/issues/13"
      labels:
        -
          name: "enhancement"
        -
          name: "p0"
      milestone: null
      number: 13
      state: "closed"
      title: "Stage reuse (deterministic resume) [P1]"
      updated_at: "2025-12-31T20:21:08Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:31:46Z"
        event: "closed"
        id: 21807207942
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:52:48Z"
        event: "reopened"
        id: 21807382864
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:56:35Z"
        event: "labeled"
        id: 21807412090
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:56:35Z"
        event: "labeled"
        id: 21807412093
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T20:21:06Z"
        event: "commented"
        id: 3702851343
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T20:21:08Z"
        event: "closed"
        id: 21813042953
  -
    comments:
      -
        body: "Verified that root-level audio files are treated as a first-class logical book (__ROOT_AUDIO__).\n\n- Root audio appears as a selectable book\n- Uses identical prompts, logging, and processing pipeline as directory-based books\n- Behavior manually tested during real import runs\n\nCommits involved:\nea40245\n461938c\n577847b\n197942e\nf2b66fc"
        created_at: "2026-01-01T11:11:33Z"
        html_url: "https://github.com/michalholes/audiomason/issues/14#issuecomment-3703563440"
        id: 3703563440
        updated_at: "2026-01-01T11:11:33Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Treat audio files in archive root as a normal book.\n\nRequirements:\n- Root-level audio becomes its own logical book (__ROOT_AUDIO__)\n- Same prompts, logging, and processing as directory-based books\n\nAcceptance:\n- Root audio appears as a selectable book\n- Processing is identical to subdir-based books"
      closed_at: "2026-01-01T11:11:34Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:20Z"
      html_url: "https://github.com/michalholes/audiomason/issues/14"
      labels:
        -
          name: "bug"
        -
          name: "p1"
      milestone: null
      number: 14
      state: "closed"
      title: "Root-audio handling as first-class book [P1]"
      updated_at: "2026-01-01T11:11:34Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:41:58Z"
        event: "labeled"
        id: 21807292239
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:41:58Z"
        event: "labeled"
        id: 21807292245
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T11:11:33Z"
        event: "commented"
        id: 3703563440
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T11:11:34Z"
        event: "closed"
        id: 21817686840
  -
    comments:
      -
        body: "Implemented clear phase boundaries (PREPARE / PROCESS / FINALIZE) with per-book progress tracking and interactive resume (ask before skipping processed books). Commit: <PASTE_SHA_HERE>"
        created_at: "2026-01-01T17:58:46Z"
        html_url: "https://github.com/michalholes/audiomason/issues/15#issuecomment-3703950031"
        id: 3703950031
        updated_at: "2026-01-01T17:58:46Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Implemented clear phase boundaries (PREPARE / PROCESS / FINALIZE) with per-book progress tracking and interactive resume (ask before skipping processed books). Commit: f22f525\n"
        created_at: "2026-01-01T18:01:49Z"
        html_url: "https://github.com/michalholes/audiomason/issues/15#issuecomment-3703952342"
        id: 3703952342
        updated_at: "2026-01-01T18:01:49Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Make 'book' the atomic unit of work.\n\nPhases:\n- PREPARE (all questions)\n- PROCESS (CPU/IO)\n- FINALIZE (publish, cleanup)\n\nBenefits:\n- Simpler resume\n- Cleaner logs\n- Deterministic behavior\n\nAcceptance:\n- Each book is processed independently with clear phase transitions"
      closed_at: "2026-01-01T18:01:50Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:22Z"
      html_url: "https://github.com/michalholes/audiomason/issues/15"
      labels:
        -
          name: "feature"
        -
          name: "p0"
      milestone: null
      number: 15
      state: "closed"
      title: "One book = one unit of work (clear phase boundaries) [P1]"
      updated_at: "2026-01-01T18:01:50Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:56:10Z"
        event: "labeled"
        id: 21807408792
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:56:10Z"
        event: "labeled"
        id: 21807408799
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T17:58:46Z"
        event: "commented"
        id: 3703950031
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:58:47Z"
        event: "closed"
        id: 21820041737
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T18:00:48Z"
        event: "reopened"
        id: 21820050142
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T18:01:49Z"
        event: "commented"
        id: 3703952342
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T18:01:50Z"
        event: "closed"
        id: 21820056581
  -
    comments:
      -
        body: "Added CLI override --cpu-cores and wired it into deterministic ffmpeg thread derivation.\n\nCommits:\n- a477970 (initial attempt; superseded)\n- db51275 (final stable state at HEAD)"
        created_at: "2025-12-31T20:11:24Z"
        html_url: "https://github.com/michalholes/audiomason/issues/16#issuecomment-3702840910"
        id: 3702840910
        updated_at: "2025-12-31T20:11:24Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Add explicit performance profiles.\n\nExamples:\n- --rpi4\n- --low-cpu\n- --fast\n\nProfiles control:\n- ffmpeg threads\n- seek behavior\n- encoder presets\n\nAcceptance:\n- Same input + same profile => same performance behavior\n- Default profile remains current behavior"
      closed_at: "2025-12-31T20:11:25Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:23Z"
      html_url: "https://github.com/michalholes/audiomason/issues/16"
      labels:
        -
          name: "feature"
        -
          name: "perf"
        -
          name: "p1"
      milestone: null
      number: 16
      state: "closed"
      title: "Explicit performance profiles (--rpi4, --low-cpu, --fast) [P1]"
      updated_at: "2025-12-31T20:11:25Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:28Z"
        event: "labeled"
        id: 21807296648
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:28Z"
        event: "labeled"
        id: 21807296653
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:28Z"
        event: "labeled"
        id: 21807296661
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T20:11:24Z"
        event: "commented"
        id: 3702840910
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T20:11:25Z"
        event: "closed"
        id: 21812945855
  -
    comments:
      -
        body: "Filesystem path contract already enforced: all roots derive from AUDIOMASON_ROOT, fail-fast validation via validate_paths_contract(), covered by tests. Verified in current main branch."
        created_at: "2026-01-01T18:03:55Z"
        html_url: "https://github.com/michalholes/audiomason/issues/17#issuecomment-3703954184"
        id: 3703954184
        updated_at: "2026-01-01T18:03:55Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Enforce filesystem path contract strictly.\n\nRules:\n- All roots derive from AUDIOMASON_ROOT\n- Fail fast if contract is violated\n- Covered by tests\n\nAcceptance:\n- Invalid path layout aborts early with clear error"
      closed_at: "2026-01-01T18:03:55Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:24Z"
      html_url: "https://github.com/michalholes/audiomason/issues/17"
      labels:
        -
          name: "feature"
        -
          name: "p1"
      milestone: null
      number: 17
      state: "closed"
      title: "Strict path contract enforcement (AUDIOMASON_ROOT) [P1]"
      updated_at: "2026-01-01T18:03:55Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:55:26Z"
        event: "labeled"
        id: 21807403637
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:55:26Z"
        event: "labeled"
        id: 21807403642
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T18:03:55Z"
        event: "commented"
        id: 3703954184
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T18:03:56Z"
        event: "closed"
        id: 21820070944
  -
    comments:
      -
        body: "Implemented optional --json end-of-run report (deterministic, parseable) with required sections (sources/books/decisions/results) while keeping default human output unchanged. Commit: <PASTE_SHA_HERE>"
        created_at: "2026-01-01T18:19:29Z"
        html_url: "https://github.com/michalholes/audiomason/issues/18#issuecomment-3703969739"
        id: 3703969739
        updated_at: "2026-01-01T18:19:29Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Implemented optional --json end-of-run report (deterministic, parseable) with required sections (sources/books/decisions/results) while keeping default human output unchanged. Commit: 2c50bc7"
        created_at: "2026-01-01T18:20:12Z"
        html_url: "https://github.com/michalholes/audiomason/issues/18#issuecomment-3703970528"
        id: 3703970528
        updated_at: "2026-01-01T18:20:12Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Add optional machine-readable output.\n\nRequirements:\n- --json prints structured output:\n  - sources\n  - books\n  - decisions\n  - results\n- No change to default human output\n\nAcceptance:\n- JSON output is deterministic and parseable"
      closed_at: "2026-01-01T18:20:13Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:25Z"
      html_url: "https://github.com/michalholes/audiomason/issues/18"
      labels:
        -
          name: "feature"
        -
          name: "p2"
      milestone: null
      number: 18
      state: "closed"
      title: "Machine-readable output mode (--json) [P2]"
      updated_at: "2026-01-01T18:20:13Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:37Z"
        event: "labeled"
        id: 21807297743
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:37Z"
        event: "labeled"
        id: 21807297751
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T18:19:29Z"
        event: "commented"
        id: 3703969739
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T18:19:30Z"
        event: "closed"
        id: 21820175525
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T18:19:56Z"
        event: "reopened"
        id: 21820178064
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T18:20:12Z"
        event: "commented"
        id: 3703970528
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T18:20:13Z"
        event: "closed"
        id: 21820179522
  -
    comments:
      -
        body: "Added deterministic disk cache for OpenLibrary validation results (author/book), stored under AUDIOMASON_ROOT/_state/openlibrary_cache.json, with atomic writes and dry-run safety.\n\nCommit:\n- 373977a Feature #19: add disk cache for OpenLibrary validation results"
        created_at: "2025-12-31T21:28:51Z"
        html_url: "https://github.com/michalholes/audiomason/issues/19#issuecomment-3702924881"
        id: 3702924881
        updated_at: "2025-12-31T21:28:51Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Resolved by commits:\n- ea40245 Fix: show OpenLibrary not-found warnings for author and book when lookup is enabled\n- 197942e Debug: print OpenLibrary status and hits under --debug\n- f2b66fc Debug: print OpenLibrary result fields (ok/not_found/top) under --debug\n- 577847b Fix: OpenLibrary author typo fallback (surname search) to produce top suggestion\n- 461938c Fix: guard author typo fallback to avoid wrong OpenLibrary suggestions\n"
        created_at: "2026-01-01T02:29:26Z"
        html_url: "https://github.com/michalholes/audiomason/issues/19#issuecomment-3703183396"
        id: 3703183396
        updated_at: "2026-01-01T02:29:26Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Cache results of public DB validation.\n\nRequirements:\n- Cache author/book lookups\n- Offline-friendly behavior\n- Optional / feature-gated\n\nAcceptance:\n- No repeated external lookups for same metadata\n- Offline runs still work"
      closed_at: "2026-01-01T02:29:26Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:26:26Z"
      html_url: "https://github.com/michalholes/audiomason/issues/19"
      labels:
        -
          name: "feature"
        -
          name: "p3"
      milestone: null
      number: 19
      state: "closed"
      title: "Public DB validation cache (OpenLibrary) [P3]"
      updated_at: "2026-01-01T02:29:26Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:40Z"
        event: "labeled"
        id: 21807298176
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:40Z"
        event: "labeled"
        id: 21807298186
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "373977a8ac7382fc002993f9a9eb091f42172217"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/373977a8ac7382fc002993f9a9eb091f42172217"
        created_at: "2025-12-31T21:27:32Z"
        event: "referenced"
        id: 21813659484
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T21:28:51Z"
        event: "commented"
        id: 3702924881
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T21:28:53Z"
        event: "closed"
        id: 21813669624
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T02:29:15Z"
        event: "reopened"
        id: 21815438139
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T02:29:26Z"
        event: "closed"
        id: 21815438552
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T02:29:26Z"
        event: "commented"
        id: 3703183396
  -
    comments:
      -
        body: "Resolved: Configurable pipeline_steps with fail-fast validation, deterministic resolved order, debug visibility, and PROCESS-step reordering.\n\nCommits:\n- 68ba9cb Config: add pipeline_steps with validation resolver\n- 9f92edf Import: validate pipeline_steps early (fail fast before filesystem)\n- a0fadc1 Pipeline: introduce resolved execution order skeleton\n- 6fb1419 Pipeline: make pipeline_steps control PROCESS step order\n- 1b90d8c Pipeline: finalize pipeline_steps defaults, dry-run and debug output\n- f261c0a Fix: use state.DEBUG (not OPTS.debug) for debug pipeline logging\n- 9f96852 Fix: pass steps into _process_book call-site\n- 1c47d01 Fix: call write_tags with required cover kwargs in pipeline step runner\n- 8f8202a Config: fail-fast pipeline_steps order constraints (stage fixed, process reorder)\n\nManual verification:\n- invalid pipeline_steps aborts before touching filesystem\n- --debug prints resolved order\n- PROCESS steps execute in configured order\n\nFollow-up:\nCover prompt/decision persistence and default skip behavior is a separate bug to be tracked in a new issue."
        created_at: "2026-01-01T20:05:59Z"
        html_url: "https://github.com/michalholes/audiomason/issues/20#issuecomment-3704061845"
        id: 3704061845
        updated_at: "2026-01-01T20:05:59Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Add ability to configure the order of pipeline steps via config.\n\nRequirements:\n- Config key (example):\n  pipeline_steps:\n    - unpack\n    - convert\n    - chapters\n    - split\n    - rename\n    - tags\n    - cover\n    - publish\n- Default order = current behavior (no behavior change without config).\n- Validate config:\n  - unknown step => error (fail fast)\n  - duplicate step => error\n  - missing required steps => error (define required set)\n- Deterministic execution:\n  - same input + same config => same order and result\n- Works with --dry-run (summary must reflect configured order)\n- Works with --debug logs (must print resolved order)\n\nAcceptance:\n- Setting pipeline_steps changes execution order.\n- Invalid pipeline_steps aborts before touching filesystem.\n- Existing runs without pipeline_steps behave exactly as today."
      closed_at: "2026-01-01T20:05:59Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T10:38:46Z"
      html_url: "https://github.com/michalholes/audiomason/issues/20"
      labels:
        -
          name: "feature"
        -
          name: "p0"
        -
          name: "p1"
      milestone: null
      number: 20
      state: "closed"
      title: "Config: allow customizing pipeline step order"
      updated_at: "2026-01-01T20:05:59Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:17Z"
        event: "labeled"
        id: 21807295154
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:17Z"
        event: "labeled"
        id: 21807295162
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T10:42:31Z"
        event: "labeled"
        id: 21807297031
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T20:05:59Z"
        event: "commented"
        id: 3704061845
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T20:06:00Z"
        event: "closed"
        id: 21820820983
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T20:06:59Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "Implemented configurable cover cache modes (memory/disk/off) with optional cover.cache_dir, respects --dry-run, logs hits/misses under --debug, deterministic behavior. SHAs: 20d4a4c f7d9278 1116503 2a81b43 8e11579 2e572aa c6faebe 06d6cdf 9f4e346 edf9676"
        created_at: "2026-01-01T17:04:22Z"
        html_url: "https://github.com/michalholes/audiomason/issues/21#issuecomment-3703904864"
        id: 3703904864
        updated_at: "2026-01-01T17:04:22Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Add configurable cover cache behavior.\n\nCurrent state:\n- cover_cache is implicit, in-memory only\n- lives for a single run\n- not configurable\n\nRequirements:\n- Configurable cache mode:\n  - memory (current behavior, default)\n  - disk (persistent between runs)\n  - off (always ask)\n- Optional config keys:\n  cover:\n    cache: memory|disk|off\n    cache_dir: <path>   # used when cache=disk\n- Must respect:\n  - --dry-run (no writes)\n  - --debug (log cache hits/misses)\n- Deterministic behavior:\n  - same input + same cache state => same result\n\nAcceptance:\n- Default behavior unchanged.\n- disk cache persists covers across runs.\n- off disables caching completely.\n- Clear logging when cache is used or bypassed."
      closed_at: "2026-01-01T17:04:23Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T11:46:10Z"
      html_url: "https://github.com/michalholes/audiomason/issues/21"
      labels:
        -
          name: "enhancement"
        -
          name: "p1"
      milestone: null
      number: 21
      state: "closed"
      title: "Cover cache configuration (memory / disk / off)"
      updated_at: "2026-01-01T17:04:23Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:23:20Z"
        event: "labeled"
        id: 21811226844
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:23:20Z"
        event: "labeled"
        id: 21811226851
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T17:04:22Z"
        event: "commented"
        id: 3703904864
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:04:23Z"
        event: "closed"
        id: 21819785281
  -
    comments:
      -
        body: "FIXED on main. Verified: when publish=no, output is written to OUTPUT_ROOT (abooks_ready) per config contract; no conflicts with archive."
        created_at: "2025-12-31T13:25:58Z"
        html_url: "https://github.com/michalholes/audiomason/issues/22#issuecomment-3702209705"
        id: 3702209705
        updated_at: "2025-12-31T13:25:58Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "[repro]\n1) Run: AUDIOMASON_ROOT=/mnt/warez am\n2) Choose a source + books\n3) Answer: Publish after import? -> n\n4) Continue import\n\n[expected]\nWhen publish=no, output must be written under OUTPUT_ROOT (abooks_ready), as defined by config/paths contract. No conflict with archive paths should occur.\n\n[actual]\nImport crashes with conflict error saying files already exist in archive (abooks). This indicates the pipeline still targets ARCHIVE_ROOT when publish is disabled.\n\n[impact]\nBlocks non-publish workflow; makes safe-by-default staging/output unusable.\n\n[notes]\nConfig contract: inbox->stage->output (abooks_ready) -> optional publish to archive.\nCurrent behavior violates contract."
      closed_at: "2025-12-31T13:25:59Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T13:01:49Z"
      html_url: "https://github.com/michalholes/audiomason/issues/22"
      labels:
        -
          name: "bug"
        -
          name: "p0"
      milestone: null
      number: 22
      state: "closed"
      title: "P0 BUG: publish=no should write to abooks_ready (OUTPUT_ROOT), but conflicts with archive output"
      updated_at: "2025-12-31T13:25:59Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T13:01:51Z"
        event: "labeled"
        id: 21808527785
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T13:01:51Z"
        event: "labeled"
        id: 21808527803
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T13:25:58Z"
        event: "commented"
        id: 3702209705
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T13:25:59Z"
        event: "closed"
        id: 21808852398
  -
    comments:
      -
        body: "Fixed: cover prompt now clearly identifies which book is requesting a cover."
        created_at: "2025-12-31T16:28:06Z"
        html_url: "https://github.com/michalholes/audiomason/issues/23#issuecomment-3702473226"
        id: 3702473226
        updated_at: "2025-12-31T16:28:06Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "[repro]\n1) Run import with multiple books (ALL)\n2) Reach cover selection phase\n\n[observed]\nPrompt shows:\n\"No cover found. Path or URL to image (Enter=skip):\"\nwithout indicating author/book.\n\n[expected]\nCover prompt must clearly identify the current book (author + title or [book i/n]: label) so the user knows which book the cover applies to.\n\n[impact]\nHigh UX risk during multi-book imports; easy to attach wrong cover to wrong book.\n\n[example]\n[id3] wiped 35.mp3\n[id3] wiped 36.mp3\nNo cover found. Path or URL to image (Enter=skip):\n\nShould be:\n[cover] [book 2/5] Stoparuv pruvodce galaxii 2\nNo cover found. Path or URL to image (Enter=skip):"
      closed_at: "2025-12-31T16:28:06Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T13:02:02Z"
      html_url: "https://github.com/michalholes/audiomason/issues/23"
      labels:
        -
          name: "bug"
        -
          name: "p0"
      milestone: null
      number: 23
      state: "closed"
      title: "BUG: cover prompt does not identify which book is requesting a cover"
      updated_at: "2025-12-31T16:28:06Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T13:02:03Z"
        event: "labeled"
        id: 21808530130
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T13:02:03Z"
        event: "labeled"
        id: 21808530156
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "9adef3a7555bd5610443989b3f9d0d199e69a7d4"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/9adef3a7555bd5610443989b3f9d0d199e69a7d4"
        created_at: "2025-12-31T16:18:14Z"
        event: "referenced"
        id: 21810617741
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T16:28:06Z"
        event: "closed"
        id: 21810688617
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T16:28:06Z"
        event: "commented"
        id: 3702473226
  -
    comments:
      -
        body: "Implemented: stage manifest persistence (24.1), deterministic stage reuse with fingerprint (24.2), and resume UX with reuse prompt + optional manifest answers (24.3)."
        created_at: "2025-12-31T16:15:52Z"
        html_url: "https://github.com/michalholes/audiomason/issues/24#issuecomment-3702458049"
        id: 3702458049
        updated_at: "2025-12-31T16:15:52Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "[goal]\nMake imports resumable and deterministic after crashes/interrupts.\n\n[proposal]\nWrite a run manifest into the stage directory that stores ALL decisions already asked (preflight + per-book metadata), and reuse it on the next run if the same staged source is present.\n\n[required behavior]\n1) During preflight, persist decisions immediately to stage (atomic writes):\n   - publish yes/no\n   - wipe_id3 yes/no\n   - author (per source)\n   - per-book titles + any per-book selections\n   - cover choice / cover URL / cover path (if provided)\n2) On restart after crash/CTRL-C:\n   - detect existing stage for the selected source\n   - load manifest and continue WITHOUT re-asking answered prompts\n   - continue at the next unfinished book/step deterministically\n3) Stage reuse:\n   - do NOT re-copy / re-unpack source into stage if stage already contains the staged src for that source\n   - only restage if explicitly forced OR if a mismatch is detected (e.g. different source chosen / stage missing / manifest indicates incomplete staging)\n\n[acceptance]\n- A crash during staging/processing does not lose answers.\n- Re-running the same source continues where it left off.\n- If stage already has the source data, am does not copy/unpack again.\n- Deterministic and safe-by-default (no silent overwrite).\n\n[notes]\nUser observation: data is copied into stage every run; this is wasteful. Reuse existing stage when valid."
      closed_at: "2025-12-31T16:15:53Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T13:13:12Z"
      html_url: "https://github.com/michalholes/audiomason/issues/24"
      labels:
        -
          name: "feature"
        -
          name: "p0"
      milestone: null
      number: 24
      state: "closed"
      title: "P0 FEATURE: persist preflight answers in stage and reuse stage data for crash-resume (no re-copy)"
      updated_at: "2025-12-31T16:15:53Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T13:13:13Z"
        event: "labeled"
        id: 21808636327
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T13:13:13Z"
        event: "labeled"
        id: 21808636355
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "d3b70f54abc70aec361ee5fdc9bc98d0f7b39a38"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/d3b70f54abc70aec361ee5fdc9bc98d0f7b39a38"
        created_at: "2025-12-31T13:47:48Z"
        event: "referenced"
        id: 21809281037
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "56cdf39273181ef20f34a4fb01162dc2b1791da5"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/56cdf39273181ef20f34a4fb01162dc2b1791da5"
        created_at: "2025-12-31T13:55:36Z"
        event: "referenced"
        id: 21809372072
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "b28049b26113b3d9baa0194a67a6b2e67a91d599"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/b28049b26113b3d9baa0194a67a6b2e67a91d599"
        created_at: "2025-12-31T13:57:58Z"
        event: "referenced"
        id: 21809391481
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "810f34566d9a200b07d44e81569c373ec85eb020"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/810f34566d9a200b07d44e81569c373ec85eb020"
        created_at: "2025-12-31T14:15:55Z"
        event: "referenced"
        id: 21809550496
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e1e049c16ce85dedde658c3831a15bdae3d8067c"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e1e049c16ce85dedde658c3831a15bdae3d8067c"
        created_at: "2025-12-31T16:07:28Z"
        event: "referenced"
        id: 21810529715
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T16:15:52Z"
        event: "commented"
        id: 3702458049
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T16:15:53Z"
        event: "closed"
        id: 21810599948
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T19:44:11Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "Resolved.\n\nFixed by commit:\n- 6d96453 BUG #25: enforce AUDIOMASON_ROOT-derived output (no cwd scatter); accept legacy paths.ready"
        created_at: "2025-12-31T17:56:18Z"
        html_url: "https://github.com/michalholes/audiomason/issues/25#issuecomment-3702606373"
        id: 3702606373
        updated_at: "2025-12-31T17:56:18Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Observed behavior:\n- abooks_ready (OUTPUT_ROOT when publish=no) is written to different and inconsistent filesystem locations.\n- In some runs, output ends up under unexpected paths (e.g. relative to repo / cwd), not under AUDIOMASON_ROOT-derived OUTPUT_ROOT.\n\nExpected behavior:\n- OUTPUT_ROOT must be derived exclusively from AUDIOMASON_ROOT.\n- publish=no MUST ALWAYS write to: <AUDIOMASON_ROOT>/abooks_ready\n- No fallback to CWD, repo root, or implicit paths.\n\nImpact:\n- High risk of data scattering and accidental overwrites.\n- Breaks filesystem contract.\n\nNotes:\n- Likely path resolution leak between env override, defaults, and call sites.\n- Must be deterministic and test-covered."
      closed_at: "2025-12-31T17:56:18Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T17:31:27Z"
      html_url: "https://github.com/michalholes/audiomason/issues/25"
      labels:
        -
          name: "bug"
        -
          name: "p0"
      milestone: null
      number: 25
      state: "closed"
      title: "BUG: abooks_ready written to inconsistent / incorrect locations"
      updated_at: "2025-12-31T17:56:18Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:31:28Z"
        event: "labeled"
        id: 21811300346
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:31:28Z"
        event: "labeled"
        id: 21811300367
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "6d9645329d243f8968518026f4b39a103111557c"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/6d9645329d243f8968518026f4b39a103111557c"
        created_at: "2025-12-31T17:48:16Z"
        event: "referenced"
        id: 21811436221
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T17:56:18Z"
        event: "commented"
        id: 3702606373
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:56:19Z"
        event: "closed"
        id: 21811515175
  -
    comments:
      -
        body: "Resolved and tested.\n\nFixed by commits:\n20693cd Feature #26: preflight prompt to clean stage at end (manifest-backed)\ndf06c6b Fix: remove dangling publish stub (IndentationError)"
        created_at: "2025-12-31T18:41:23Z"
        html_url: "https://github.com/michalholes/audiomason/issues/26#issuecomment-3702690874"
        id: 3702690874
        updated_at: "2025-12-31T18:41:23Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Request:\n- During preflight, ask whether stage should be cleaned at the end of the run.\n\nExpected behavior:\n- New preflight question (once per run): \"Clean stage after successful import?\" [y/N]\n- Decision must be persisted in stage manifest for resume/reuse consistency.\n- Behavior:\n  - If Yes: after successful completion of the run, remove the stage_run directory (or a deterministic subset), without touching input/output.\n  - If No: keep stage as-is (current behavior).\n\nConstraints:\n- Deterministic, safe-by-default.\n- Must not clean stage on abort/CTRL-C unless explicitly decided (default: do not)."
      closed_at: "2025-12-31T18:41:23Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2025-12-31T17:53:26Z"
      html_url: "https://github.com/michalholes/audiomason/issues/26"
      labels:
        -
          name: "feature"
        -
          name: "ux"
        -
          name: "p0"
      milestone: null
      number: 26
      state: "closed"
      title: "FEATURE: preflight prompt to clean stage at end"
      updated_at: "2025-12-31T18:41:23Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:53:27Z"
        event: "labeled"
        id: 21811487891
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:53:27Z"
        event: "labeled"
        id: 21811487901
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T17:53:27Z"
        event: "labeled"
        id: 21811487911
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "20693cd01229a158b3d4b5186f645cb8c8196bf3"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/20693cd01229a158b3d4b5186f645cb8c8196bf3"
        created_at: "2025-12-31T18:35:01Z"
        event: "referenced"
        id: 21811940771
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2025-12-31T18:41:23Z"
        event: "closed"
        id: 21811998224
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2025-12-31T18:41:23Z"
        event: "commented"
        id: 3702690874
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "386675d2e75c830ee8c1d01f9ec01afc80269903"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/386675d2e75c830ee8c1d01f9ec01afc80269903"
        created_at: "2025-12-31T18:54:43Z"
        event: "referenced"
        id: 21812134197
  -
    comments:
      -
        body: "Resolved and tested (guarded OpenLibrary fuzzy title suggestions; prompt-only; deterministic). Commits: 63d5506 d9c0cea"
        created_at: "2026-01-01T11:04:48Z"
        html_url: "https://github.com/michalholes/audiomason/issues/27#issuecomment-3703550525"
        id: 3703550525
        updated_at: "2026-01-01T11:04:48Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Goal:\n- When lookup is enabled and validate_book(author,title) returns not_found with no top suggestion, offer a guarded closest-title suggestion.\n\nRules (non-negotiable):\n- Deterministic behavior only.\n- No silent overwrites: always prompt to accept suggestion.\n- Safe-by-default: if confidence is low, offer nothing.\n- Must respect --no-lookup.\n- Must not write OpenLibrary cache in --dry-run.\n\nProposed approach:\n- On book not_found: secondary OpenLibrary search constrained by author.\n- Score candidate titles vs entered title (e.g. SequenceMatcher).\n- Suggest only if score >= conservative threshold.\n\nAcceptance criteria:\n- Typo title triggers suggestion prompt when strong match exists.\n- Weak/ambiguous matches produce no suggestion.\n- Correct author+title stays silent.\n- --no-lookup disables everything."
      closed_at: "2026-01-01T11:04:49Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T02:31:05Z"
      html_url: "https://github.com/michalholes/audiomason/issues/27"
      labels:
        -
          name: "feature"
      milestone: null
      number: 27
      state: "closed"
      title: "FEATURE: guarded fuzzy suggestions for book titles (OpenLibrary)"
      updated_at: "2026-01-01T11:04:49Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T02:31:06Z"
        event: "labeled"
        id: 21815442914
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T11:04:48Z"
        event: "commented"
        id: 3703550525
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T11:04:49Z"
        event: "closed"
        id: 21817608832
  -
    comments:
      -
        body: "Fixed in ed1cc3d1d822317e09366ea4ada0f268b5cf226b."
        created_at: "2026-01-01T10:39:16Z"
        html_url: "https://github.com/michalholes/audiomason/issues/28#issuecomment-3703528101"
        id: 3703528101
        updated_at: "2026-01-01T10:39:16Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "am import currently rejects a positional source path with 'unrecognized arguments'. Expected: allow 'am import /path/to/source' while keeping current interactive behavior when no path is provided. Must respect --dry-run and --lookup/--no-lookup. Needed for scripting and testing."
      closed_at: "2026-01-01T10:39:16Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T09:06:16Z"
      html_url: "https://github.com/michalholes/audiomason/issues/28"
      labels:
        -
          name: "bug"
      milestone: null
      number: 28
      state: "closed"
      title: "BUG: import should accept source path as CLI argument"
      updated_at: "2026-01-01T10:39:16Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T09:06:17Z"
        event: "labeled"
        id: 21816977664
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T10:39:16Z"
        event: "closed"
        id: 21817479563
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T10:39:16Z"
        event: "commented"
        id: 3703528101
  -
    comments:
      -
        body: "Blocked by OpenLibrary data (no CZ/SK editions for target work). Implemented best-effort OL localization fallback. Commits: dd1c5c1, 07090c6, 99ad02a"
        created_at: "2026-01-01T10:00:26Z"
        html_url: "https://github.com/michalholes/audiomason/issues/29#issuecomment-3703491868"
        id: 3703491868
        updated_at: "2026-01-01T10:00:26Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem: /search.json returns work-level 'title' (often English) even when using language:cze/slo filters. We want suggestions in Czech/Slovak when available.\\n\\nGoal:\\n- When offering a guarded book title suggestion, prefer edition titles in CZ/SK.\\n- Strategy: after selecting best matching work candidate, fetch editions for that work and pick an edition title where language includes 'cze' or 'slo' (prefer cze then slo, or configurable later).\\n- Still deterministic, prompt-only (no silent overwrites), safe-by-default.\\n- Must respect --no-lookup.\\n- Must not write OL cache in --dry-run.\\n\\nAcceptance:\\n- For Douglas Adams query, suggestion offered as Czech title when Czech edition exists.\\n- If only English exists, fall back to current behavior.\\n- If ambiguous/low confidence, offer nothing."
      closed_at: "2026-01-01T10:00:27Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T09:32:50Z"
      html_url: "https://github.com/michalholes/audiomason/issues/29"
      labels:
        -
          name: "feature"
      milestone: null
      number: 29
      state: "closed"
      title: "FEATURE: prefer CZ/SK edition titles for OpenLibrary book suggestions"
      updated_at: "2026-01-01T10:00:27Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T09:32:51Z"
        event: "labeled"
        id: 21817165201
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T10:00:26Z"
        event: "commented"
        id: 3703491868
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T10:00:27Z"
        event: "closed"
        id: 21817285195
  -
    comments:
      -
        body: "Implemented Google Books fallback for localized (CZ/SK) title suggestions. Deterministic + prompt-only + safe-by-default; dry-run does not perform network calls. Commits: ddbde02, 1c064ed, ff6a598, c5379bd"
        created_at: "2026-01-01T10:31:42Z"
        html_url: "https://github.com/michalholes/audiomason/issues/30#issuecomment-3703522765"
        id: 3703522765
        updated_at: "2026-01-01T10:31:42Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Goal:\\n- When user-entered title looks CZ/SK but OpenLibrary suggests only EN (or no localized editions), query Google Books Volumes API for candidate titles.\\n- Deterministic, prompt-only, safe-by-default threshold+gap.\\n- Respect --no-lookup.\\n- No network/cache writes in --dry-run.\\n\\nAcceptance:\\n- CZ typo title can trigger CZ suggestion when strong match exists.\\n- Weak/ambiguous => no suggestion.\\n- Correct author+title stays silent."
      closed_at: "2026-01-01T10:31:43Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T09:59:20Z"
      html_url: "https://github.com/michalholes/audiomason/issues/30"
      labels:
        -
          name: "feature"
      milestone: null
      number: 30
      state: "closed"
      title: "FEATURE: Google Books fallback for localized (CZ/SK) title suggestions"
      updated_at: "2026-01-01T10:31:43Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T09:59:20Z"
        event: "labeled"
        id: 21817279861
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T10:02:11Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T10:31:42Z"
        event: "commented"
        id: 3703522765
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T10:31:43Z"
        event: "closed"
        id: 21817451148
  -
    comments:
      -
        body: "Duplicate of #30. Closing to keep a single source of truth."
        created_at: "2026-01-01T10:02:10Z"
        html_url: "https://github.com/michalholes/audiomason/issues/31#issuecomment-3703493450"
        id: 3703493450
        updated_at: "2026-01-01T10:02:10Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Goal:\\n- When OpenLibrary returns only EN titles or no localized editions, query Google Books Volumes API for localized (CZ/SK) title suggestions.\\n\\nRules:\\n- Deterministic behavior only.\\n- Prompt-only (no silent overwrites).\\n- Safe-by-default (threshold + gap).\\n- Must respect --no-lookup.\\n- Must not write any cache in --dry-run.\\n\\nAcceptance:\\n- CZ/SK typo title can trigger CZ/SK suggestion when strong match exists.\\n- Weak/ambiguous matches produce no suggestion.\\n- Correct author+title stays silent."
      closed_at: "2026-01-01T10:02:11Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T10:00:49Z"
      html_url: "https://github.com/michalholes/audiomason/issues/31"
      labels:
        -
          name: "feature"
      milestone: null
      number: 31
      state: "closed"
      title: "FEATURE: Google Books fallback for localized (CZ/SK) title suggestions"
      updated_at: "2026-01-01T10:02:11Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T10:00:50Z"
        event: "labeled"
        id: 21817287045
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T10:02:10Z"
        event: "commented"
        id: 3703493450
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T10:02:11Z"
        event: "closed"
        id: 21817296968
  -
    comments:
      -
        body: "Fixed and verified. Commits: 02f044e"
        created_at: "2026-01-01T10:57:35Z"
        html_url: "https://github.com/michalholes/audiomason/issues/32#issuecomment-3703540927"
        id: 3703540927
        updated_at: "2026-01-01T10:57:35Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "When a concrete source PATH is provided on CLI (am import <PATH>), the import must process it regardless of ignore rules. Ignore list should apply only to interactive DROP_ROOT listings."
      closed_at: "2026-01-01T10:57:36Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T10:57:14Z"
      html_url: "https://github.com/michalholes/audiomason/issues/32"
      labels:
        -
          name: "bug"
      milestone: null
      number: 32
      state: "closed"
      title: "BUG: explicit 'am import <PATH>' must bypass ignore list"
      updated_at: "2026-01-01T10:57:36Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T10:57:15Z"
        event: "labeled"
        id: 21817548010
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T10:57:35Z"
        event: "commented"
        id: 3703540927
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T10:57:36Z"
        event: "closed"
        id: 21817549146
  -
    comments:
      -
        body: "Hardcoded filesystem paths cleanup completed and verified.\n\n- All paths are resolved via configuration.yaml\n- No absolute paths or CWD fallbacks remain in active code\n- App root and data roots are cleanly separated\n- Verified via ripgrep audit\n\nCommits involved:\n064dffc 6721a2c b70adbe 9afb0ae e7cb0dd 4b46ce5 b9aa4b6 02f044e ed1cc3d c5379bd "
        created_at: "2026-01-01T13:19:23Z"
        html_url: "https://github.com/michalholes/audiomason/issues/33#issuecomment-3703685299"
        id: 3703685299
        updated_at: "2026-01-01T13:19:23Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Audit and cleanup of hardcoded filesystem paths across AudioMason.\n\nScope:\n- Removed absolute hardcoded paths (/mnt, /etc, cwd fallbacks)\n- Introduced strict path resolution via configuration.yaml\n- Separated app root (AUDIOMASON_ROOT) from data roots\n- Updated tests and legacy code\n\nResult:\n- No hardcoded filesystem paths remain in active code\n- Verified via ripgrep audit\n\nThis issue documents the cleanup and is closed after verification."
      closed_at: "2026-01-01T13:19:23Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:19:20Z"
      html_url: "https://github.com/michalholes/audiomason/issues/33"
      labels:
        []
      milestone: null
      number: 33
      state: "closed"
      title: "Hardcoded filesystem paths audit & cleanup"
      updated_at: "2026-01-01T13:19:23Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T13:19:23Z"
        event: "commented"
        id: 3703685299
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:19:24Z"
        event: "closed"
        id: 21818384968
  -
    comments:
      -
        body: "Fixed verify to scan Author/Book directories (no longer treats author dirs as books). SHA: f7d9278"
        created_at: "2026-01-01T16:44:59Z"
        html_url: "https://github.com/michalholes/audiomason/issues/34#issuecomment-3703888159"
        id: 3703888159
        updated_at: "2026-01-01T16:44:59Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Audit finding: src/audiomason/verify.py iterates immediate subdirs of root as books, but canonical layout is Author/Book.\\n\\nImpact:\\n- false verify failures\\n- real books may be skipped\\n\\nAcceptance:\\n- verify walks Author -> Book\\n- tests updated"
      closed_at: "2026-01-01T16:45:00Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:27:37Z"
      html_url: "https://github.com/michalholes/audiomason/issues/34"
      labels:
        -
          name: "bug"
      milestone: null
      number: 34
      state: "closed"
      title: "BUG: verify checks wrong directory level (author dirs treated as books)"
      updated_at: "2026-01-01T16:45:00Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:27:38Z"
        event: "labeled"
        id: 21818431108
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T16:44:59Z"
        event: "commented"
        id: 3703888159
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T16:45:00Z"
        event: "closed"
        id: 21819691159
  -
    comments:
      -
        body: "Fixed config schema alignment across CLI+README (publish root key, split_chapters root key, ffmpeg.loglevel). SHAs: <SHA1> <SHA2>"
        created_at: "2026-01-01T15:06:10Z"
        html_url: "https://github.com/michalholes/audiomason/issues/35#issuecomment-3703805635"
        id: 3703805635
        updated_at: "2026-01-01T15:06:10Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Fixed configuration key mismatch across CLI/README: publish is root-level, split_chapters is root-level, ffmpeg.loglevel is canonical (no stale audio.* references). SHAs: 06d6cdf 9f4e346"
        created_at: "2026-01-01T15:08:09Z"
        html_url: "https://github.com/michalholes/audiomason/issues/35#issuecomment-3703807940"
        id: 3703807940
        updated_at: "2026-01-01T15:08:09Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Audit finding: config keys differ between src/audiomason/config.py defaults, cli lookups, and README examples (publish, ffmpeg, audio).\\n\\nImpact:\\n- configuration.yaml values may be ignored\\n\\nAcceptance:\\n- single canonical schema\\n- CLI + defaults + docs aligned\\n- tests cover config parsing"
      closed_at: "2026-01-01T15:08:10Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:27:46Z"
      html_url: "https://github.com/michalholes/audiomason/issues/35"
      labels:
        -
          name: "bug"
      milestone: null
      number: 35
      state: "closed"
      title: "BUG: configuration key mismatch across config, CLI, and README"
      updated_at: "2026-01-01T15:08:10Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:27:47Z"
        event: "labeled"
        id: 21818431986
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T15:06:10Z"
        event: "commented"
        id: 3703805635
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T15:06:11Z"
        event: "closed"
        id: 21819157254
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T15:08:04Z"
        event: "reopened"
        id: 21819170278
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T15:08:09Z"
        event: "commented"
        id: 3703807940
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T15:08:10Z"
        event: "closed"
        id: 21819170913
  -
    comments:
      -
        body: "Cover URL cache now honors paths.cache from configuration.yaml; cfg correctly plumbed through import flow. Commits: edf9676 3820a74 71723b8 "
        created_at: "2026-01-01T14:45:47Z"
        html_url: "https://github.com/michalholes/audiomason/issues/36#issuecomment-3703788483"
        id: 3703788483
        updated_at: "2026-01-01T14:45:47Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Audit finding: src/audiomason/covers.py uses CACHE_ROOT constant instead of resolving cache root from cfg.\\n\\nImpact:\\n- paths.cache is ignored\\n\\nAcceptance:\\n- cache root resolved from cfg\\n- test verifies configured cache path"
      closed_at: "2026-01-01T14:45:47Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:27:53Z"
      html_url: "https://github.com/michalholes/audiomason/issues/36"
      labels:
        -
          name: "bug"
      milestone: null
      number: 36
      state: "closed"
      title: "BUG: cover cache path ignores configuration.yaml (CACHE_ROOT constant used)"
      updated_at: "2026-01-01T14:45:47Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:27:54Z"
        event: "labeled"
        id: 21818432643
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T14:45:47Z"
        event: "closed"
        id: 21819055901
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T14:45:47Z"
        event: "commented"
        id: 3703788483
  -
    comments:
      -
        body: "Fail-fast added for missing external archive tools (unzip/unrar/7z) with human-readable error messages. Commit: 71723b8"
        created_at: "2026-01-01T14:06:07Z"
        html_url: "https://github.com/michalholes/audiomason/issues/37#issuecomment-3703734449"
        id: 3703734449
        updated_at: "2026-01-01T14:06:07Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Audit finding: src/audiomason/archives.py raises FileNotFoundError when unzip/7z/unrar is missing.\\n\\nExpected:\\n- fail-fast with clear error message\\n- name missing tool + hint\\n\\nAcceptance:\\n- explicit detection\\n- readable RuntimeError"
      closed_at: "2026-01-01T14:06:08Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:29:16Z"
      html_url: "https://github.com/michalholes/audiomason/issues/37"
      labels:
        -
          name: "bug"
      milestone: null
      number: 37
      state: "closed"
      title: "BUG: missing external archive tools cause raw FileNotFoundError"
      updated_at: "2026-01-01T14:06:08Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:29:18Z"
        event: "labeled"
        id: 21818439906
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T14:06:07Z"
        event: "commented"
        id: 3703734449
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T14:06:08Z"
        event: "closed"
        id: 21818736562
  -
    comments:
      -
        body: "Replaced cover prompt raw print/input with out/prompt for consistent CLI UX. Commit: 0f926ad"
        created_at: "2026-01-01T14:00:48Z"
        html_url: "https://github.com/michalholes/audiomason/issues/38#issuecomment-3703725499"
        id: 3703725499
        updated_at: "2026-01-01T14:00:48Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Audit finding: import_flow.py and covers.py mix raw print/input with audiomason.util out/prompt.\\n\\nImpact:\\n- --quiet / --debug not consistently respected\\n\\nAcceptance:\\n- all interaction via util wrappers\\n- uniform UX behavior"
      closed_at: "2026-01-01T14:00:48Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:29:23Z"
      html_url: "https://github.com/michalholes/audiomason/issues/38"
      labels:
        -
          name: "bug"
      milestone: null
      number: 38
      state: "closed"
      title: "BUG: mixed print/input bypasses quiet/debug UX contract"
      updated_at: "2026-01-01T14:00:48Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:29:24Z"
        event: "labeled"
        id: 21818440382
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T14:00:48Z"
        event: "closed"
        id: 21818672811
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T14:00:48Z"
        event: "commented"
        id: 3703725499
  -
    comments:
      -
        body: "Fail-fast enforced for malformed configuration: paths must be mapping; configuration root must be mapping. Commits: 1a41977 2e11dad "
        created_at: "2026-01-01T13:45:49Z"
        html_url: "https://github.com/michalholes/audiomason/issues/39#issuecomment-3703710853"
        id: 3703710853
        updated_at: "2026-01-01T13:45:49Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Audit finding: src/audiomason/paths.py has 'except Exception: pass' when reading cfg.\\n\\nThis violates fail-fast contract.\\n\\nAcceptance:\\n- remove broad exception swallowing\\n- raise clear RuntimeError with context\\n- tests for malformed config"
      closed_at: "2026-01-01T13:45:50Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:29:31Z"
      html_url: "https://github.com/michalholes/audiomason/issues/39"
      labels:
        -
          name: "bug"
      milestone: null
      number: 39
      state: "closed"
      title: "BUG: paths._get swallows exceptions and hides config errors"
      updated_at: "2026-01-01T13:45:50Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:29:32Z"
        event: "labeled"
        id: 21818440914
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T13:45:49Z"
        event: "commented"
        id: 3703710853
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:45:50Z"
        event: "closed"
        id: 21818567018
  -
    comments:
      -
        body: "README configuration section aligned with current AUDIOMASON_ROOT + configuration.yaml contract. Commit: 2b0d519"
        created_at: "2026-01-01T13:32:04Z"
        html_url: "https://github.com/michalholes/audiomason/issues/40#issuecomment-3703698414"
        id: 3703698414
        updated_at: "2026-01-01T13:32:04Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Audit finding: README still references legacy config discovery (/etc, ~/.config) and outdated key layout.\\n\\nAcceptance:\\n- document AUDIOMASON_ROOT resolution\\n- only /configuration.yaml\\n- examples match real schema"
      closed_at: "2026-01-01T13:32:05Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:29:38Z"
      html_url: "https://github.com/michalholes/audiomason/issues/40"
      labels:
        -
          name: "documentation"
      milestone: null
      number: 40
      state: "closed"
      title: "Docs: README configuration section out of sync with current contract"
      updated_at: "2026-01-01T13:32:05Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:29:39Z"
        event: "labeled"
        id: 21818441471
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T13:32:04Z"
        event: "commented"
        id: 3703698414
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:32:05Z"
        event: "closed"
        id: 21818452582
  -
    comments:
      -
        body: "Verified manually:\n- No tracebacks for expected exits (invalid config, missing tools, Ctrl+C)\n- Ctrl+C exits cleanly with rc=130 and no '[skip]'\n- Tracebacks preserved for real bugs\n\nCommits:\n1da98d5\nafadd98"
        created_at: "2026-01-01T18:39:54Z"
        html_url: "https://github.com/michalholes/audiomason/issues/41#issuecomment-3703985330"
        id: 3703985330
        updated_at: "2026-01-01T18:39:54Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "### Problem\n\nCurrently, AudioMason prints Python tracebacks for many expected termination scenarios (invalid configuration, missing external tools, validation failures, user abort via Ctrl+C). This is noisy and user-unfriendly. Tracebacks should be reserved only for genuine programmer bugs (unexpected exceptions).\n\n---\n\n### Goal\n\nDefine and enforce a strict CLI contract:\n\n- No tracebacks for expected exits\n- Always show a single, human-readable message explaining why the program exited\n- Deterministic exit codes\n- Centralized handling in CLI entrypoint\n\n---\n\n### Proposed Design\n\n#### 1) Controlled exit exception hierarchy\n\nIntroduce explicit exit exceptions:\n\nExample:\n\nclass AmExit(RuntimeError):\n    exit_code = 1\n\nclass AmConfigError(AmExit):\n    pass\n\nclass AmValidationError(AmExit):\n    pass\n\nclass AmExternalToolError(AmExit):\n    pass\n\nclass AmAbort(AmExit):\n    exit_code = 130  # Ctrl+C\n\nNotes:\n- No printing inside exceptions\n- Message only\n\n---\n\n#### 2) Single catch point in cli.main()\n\nExample:\n\ntry:\n    ...\nexcept AmAbort as e:\n    out(f\"[abort] {e}\")\n    return e.exit_code\nexcept AmExit as e:\n    out(f\"[error] {e}\")\n    return e.exit_code\n\n- No other broad excepts elsewhere\n\n---\n\n#### 3) KeyboardInterrupt handling\n\nExample:\n\nexcept KeyboardInterrupt:\n    raise AmAbort(\"cancelled by user\")\n\n---\n\n#### 4) Replace raw RuntimeError usage\n\nAll expected failures must raise an appropriate AmExit subclass instead of raw RuntimeError / ValueError:\n\n- config load / validation\n- paths contract enforcement\n- verify failures\n- missing external tools (ffmpeg, unzip, 7z, unrar)\n\n---\n\n### User-visible behavior\n\nInvalid config:\n[error] Invalid configuration: paths must be a mapping\n\nMissing external tool:\n[error] Missing external tool: ffmpeg (install ffmpeg)\n\nCtrl+C:\n[abort] cancelled by user\n\nReal bug:\nTraceback (most recent call last):\n  ...\n\n---\n\n### Acceptance Criteria\n\n- No Python tracebacks for expected termination paths\n- All expected exits go through AmExit hierarchy\n- Single catch point in CLI\n- Tracebacks remain for unexpected bugs only\n- Covered by tests where applicable\n\n---\n\n### Notes\n\nThis is a CLI UX contract change and should be treated as a foundational behavior guarantee.\n"
      closed_at: "2026-01-01T18:39:55Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:46:03Z"
      html_url: "https://github.com/michalholes/audiomason/issues/41"
      labels:
        -
          name: "bug"
      milestone: null
      number: 41
      state: "closed"
      title: "CLI: replace expected tracebacks with human-readable exits"
      updated_at: "2026-01-01T18:39:55Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:46:04Z"
        event: "labeled"
        id: 21818568881
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T13:47:40Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T18:39:54Z"
        event: "commented"
        id: 3703985330
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T18:39:55Z"
        event: "closed"
        id: 21820285130
  -
    comments:
      -
        body: "Duplicate of #41 (created due to bash backtick command-substitution in body)."
        created_at: "2026-01-01T13:47:39Z"
        html_url: "https://github.com/michalholes/audiomason/issues/42#issuecomment-3703712761"
        id: 3703712761
        updated_at: "2026-01-01T13:47:39Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "### Problem\\n\\nCurrently, AudioMason prints Python tracebacks for many *expected* termination scenarios (invalid configuration, missing external tools, validation failures, user abort via Ctrl+C). This is noisy, user-unfriendly, and not aligned with a CLI tool intended to run on constrained systems (e.g. Raspberry Pi) or by non-developers.\\n\\nTracebacks should be reserved **only** for genuine programmer bugs (unexpected exceptions).\\n\\n---\\n\\n### Goal\\n\\nDefine and enforce a strict CLI contract:\\n\\n- **No tracebacks for expected exits**\\n- Always show a **single, human-readable message** explaining *why* the program exited\\n- Deterministic exit codes\\n- Centralized handling in CLI entrypoint\\n\\n---\\n\\n### Proposed Design\\n\\n#### 1. Controlled exit exception hierarchy\\n\\nIntroduce a small set of explicit exit exceptions:\\n\\n\\n\\n- No printing inside exceptions\\n- Message only\\n\\n---\\n\\n#### 2. Single catch point in cli.main()\\n\\n\\n\\n- No other broad excepts elsewhere\\n\\n---\\n\\n#### 3. KeyboardInterrupt handling\\n\\n\\n\\n---\\n\\n#### 4. Replace raw RuntimeError usage\\n\\nAll expected failures must raise an appropriate  subclass instead of raw RuntimeError / ValueError:\\n\\n- config load / validation\\n- paths contract enforcement\\n- verify failures\\n- missing external tools (ffmpeg, unzip, 7z, unrar)\\n\\n---\\n\\n### User-visible behavior\\n\\n**Invalid config**\\n\\n\\n**Missing external tool**\\n\\n\\n**Ctrl+C**\\n\\n\\n**Real bug**\\n\\n\\n---\\n\\n### Acceptance Criteria\\n\\n- No Python tracebacks for expected termination paths\\n- All expected exits go through AmExit hierarchy\\n- Single catch point in CLI\\n- Tracebacks remain for unexpected bugs only\\n- Covered by tests where applicable\\n\\n---\\n\\n### Notes\\n\\nThis is a CLI UX contract change and should be treated as a foundational behavior guarantee."
      closed_at: "2026-01-01T13:47:39Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T13:46:12Z"
      html_url: "https://github.com/michalholes/audiomason/issues/42"
      labels:
        -
          name: "bug"
      milestone: null
      number: 42
      state: "closed"
      title: "CLI: replace expected tracebacks with human-readable exits"
      updated_at: "2026-01-01T13:47:39Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:46:13Z"
        event: "labeled"
        id: 21818569977
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T13:47:39Z"
        event: "closed"
        id: 21818580182
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T13:47:39Z"
        event: "commented"
        id: 3703712761
  -
    comments:
      -
        body: "Resolved: cover decisions are made during preflight only (URL/path/embedded/file/skip). Processing no longer prompts for cover and only applies the preflight decision. Resume/stage reuse reuses the persisted decision deterministically.\n\nCommit:\n- 4aa09f6 Feat: move cover selection to preflight (no prompts in processing)"
        created_at: "2026-01-01T21:04:40Z"
        html_url: "https://github.com/michalholes/audiomason/issues/43#issuecomment-3704105949"
        id: 3704105949
        updated_at: "2026-01-01T21:04:40Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "### Problem\n\nCover selection currently happens in the processing phase via `choose_cover(...)`. This clashes with the project rule that processing should not prompt (see the existing preflight/processing separation). In practice, when no embedded/file cover is detected in preflight, `cover_mode` becomes `\"skip\"` and processing prints `[cover] skipped`, even though the user could supply a URL/path at that time.\n\nExample observed flow:\n- preflight sets `cover_mode = \"skip\"` when no cover is detected\n- processing phase calls `choose_cover(..., mode=\"skip\")` and never asks for a URL/path\n- result: `[cover] skipped`\n\n### Goal\n\nMove **all cover decisions and user interaction** into **preflight** so that:\n- processing phase never prompts\n- cover never gets silently skipped when the user could provide one\n- crash-resume can reuse the selected cover deterministically\n\n### Requirements\n\n1) Preflight must determine a final cover input for each book:\n- `embedded` (from audio) OR\n- `file` (existing cover file) OR\n- `url` (download + cached file) OR\n- `path` (user-supplied local file path) OR\n- explicit `skip`\n\n2) Preflight prompts:\n- If a cover is detected (embedded/file), allow confirm/override/skip.\n- If no cover is detected, prompt the user for:\n  - URL (http/https) OR\n  - local file path OR\n  - skip\n\n3) Processing phase:\n- Must only apply the preflight decision (no prompts).\n- Must not call interactive cover selection.\n- Must print a single concise line indicating which cover was used (embedded/file/url/path/skip).\n\n4) Persistence / resume:\n- Store the chosen cover decision in stage/manifest so crash-resume reuses it without prompting.\n- If cover is URL, store the cached file path (or the URL + cache key) so it is deterministic.\n\n5) Config integration:\n- URL cover downloads must use the configured cache root (`paths.cache`) if set.\n\n### Acceptance Criteria\n\n- Running `am import` with a book that has no cover:\n  - preflight asks once for cover URL/path/skip\n  - processing never prompts and does not output `[cover] skipped` unless the user chose skip\n- Re-running after crash or stage reuse:\n  - no cover prompt repeats if manifest already contains the decision\n- Tests added/updated for:\n  - preflight cover decision persistence\n  - processing uses preflight decision\n  - URL cover uses configured cache root\n\n### Notes\n\nThis change is meant to align cover handling with the preflight/processing contract and improve deterministic resume behavior.\n"
      closed_at: "2026-01-01T21:04:40Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T14:42:23Z"
      html_url: "https://github.com/michalholes/audiomason/issues/43"
      labels:
        []
      milestone: null
      number: 43
      state: "closed"
      title: "FEATURE: choose/add cover during preflight (no cover prompts in processing)"
      updated_at: "2026-01-01T21:04:40Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T21:04:40Z"
        event: "commented"
        id: 3704105949
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T21:04:41Z"
        event: "closed"
        id: 21821118919
  -
    comments:
      -
        body: "Added deterministic config discovery via --config PATH and exposed loaded_from under --debug. Also fixed YAML boolean publish handling. SHAs: 8e11579 2e572aa c6faebe"
        created_at: "2026-01-01T15:18:11Z"
        html_url: "https://github.com/michalholes/audiomason/issues/44#issuecomment-3703817089"
        id: 3703817089
        updated_at: "2026-01-01T15:18:11Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\n- It is currently not possible to reliably test AudioMason with a throwaway configuration in a temporary working directory.\n- Running from a temp dir containing configuration.yaml still loads the \"real\" config/defaults (e.g. inbox stays /mnt/warez/abooksinbox).\n- load_config() does not expose which file was loaded (\"loaded_from\" is unknown), so this is hard to verify/debug.\n\nRepro\n1) Create a temp config and run am from that temp dir:\n\nTMP=$(mktemp -d)\ncat >\"$TMP/configuration.yaml\" <<'YAML'\npublish: no\nsplit_chapters: true\npaths:\n  inbox:  /tmp/am_inbox\n  stage:  /tmp/am_stage\n  output: /tmp/am_output\n  archive:/tmp/am_archive\n  cache:  /tmp/am_cache\nffmpeg:\n  loglevel: error\n  loudnorm: false\n  q_a: \"4\"\nYAML\nmkdir -p /tmp/am_inbox /tmp/am_stage /tmp/am_output /tmp/am_archive /tmp/am_cache\ncd \"$TMP\"\nam --dry-run\n\nExpected\n- Config discovery should be deterministic and test-friendly:\n  - Either respect configuration.yaml in the current working directory, OR\n  - Provide a --config /path/to/configuration.yaml flag to force a specific file.\n- Under --debug (or equivalent), print which config file was loaded, e.g.:\n  [config] loaded_from=/path/to/configuration.yaml\n\nActual\n- am --dry-run still reads sources from the real inbox (e.g. /mnt/warez/abooksinbox).\n- load_config() provides no reliable \"loaded_from\" info (shows unknown), so the active config source cannot be verified.\n\nScope / acceptance criteria\n- Add a deterministic way to select config:\n  - Option A: search order includes CWD/configuration.yaml (documented), OR\n  - Option B: implement --config PATH that overrides discovery.\n- Add \"loaded_from\" visibility:\n  - Print loaded_from under --debug, and/or\n  - Store loaded_from in cfg (or a module-level var) for programmatic inspection.\n- Update README with the discovery/override behavior.\n\nNotes\n- This blocks reliable isolated testing and makes troubleshooting configuration issues harder.\n"
      closed_at: "2026-01-01T15:18:12Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T15:10:23Z"
      html_url: "https://github.com/michalholes/audiomason/issues/44"
      labels:
        -
          name: "bug"
        -
          name: "feature"
      milestone: null
      number: 44
      state: "closed"
      title: "Config: allow --config / CWD configuration.yaml and show loaded_from under --debug"
      updated_at: "2026-01-01T15:18:12Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T15:10:24Z"
        event: "labeled"
        id: 21819182821
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T15:10:24Z"
        event: "labeled"
        id: 21819182832
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T15:18:11Z"
        event: "commented"
        id: 3703817089
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T15:18:12Z"
        event: "closed"
        id: 21819222623
  -
    comments:
      -
        body: "Hi @michalholes i want to take this issue \n"
        created_at: "2026-01-01T17:15:47Z"
        html_url: "https://github.com/michalholes/audiomason/issues/45#issuecomment-3703917921"
        id: 3703917921
        updated_at: "2026-01-01T17:15:47Z"
        user:
          id: 126257520
          login: "KnightofInd"
      -
        body: "Fixed: URL cover cache now detects MIME and stores correct extension (.jpg/.png/.webp); fixed bad cover_from_input call. Commit: 1f53020"
        created_at: "2026-01-01T17:37:48Z"
        html_url: "https://github.com/michalholes/audiomason/issues/45#issuecomment-3703935524"
        id: 3703935524
        updated_at: "2026-01-01T17:37:48Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\n- Disk cover cache currently stores downloads as .img, losing the original content-type/extension.\n- This makes cache harder to inspect/debug and can break downstream tooling that expects correct extensions.\n\nRequirements\n- Detect MIME type of downloaded cover bytes (or via HTTP headers where available).\n- Store cache files with correct extension:\n  - image/jpeg -> .jpg\n  - image/png  -> .png\n  - image/webp -> .webp\n  - fallback -> .img\n- Deterministic mapping:\n  - same URL + same bytes => same cached filename (stable).\n- Respect:\n  - --dry-run (no writes)\n  - --debug (log detected MIME + chosen extension)\n\nAcceptance\n- Existing behavior unchanged unless cache=disk is enabled.\n- Disk cache files become human-friendly and correctly typed.\n"
      closed_at: "2026-01-01T17:37:49Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T17:05:08Z"
      html_url: "https://github.com/michalholes/audiomason/issues/45"
      labels:
        -
          name: "enhancement"
      milestone: null
      number: 45
      state: "closed"
      title: "Covers: detect MIME and store cached covers with correct extension (.jpg/.png/.webp)"
      updated_at: "2026-01-01T17:37:49Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:05:09Z"
        event: "labeled"
        id: 21819790095
      -
        actor:
          id: 126257520
          login: "KnightofInd"
        created_at: "2026-01-01T17:15:47Z"
        event: "commented"
        id: 3703917921
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:15:48Z"
        event: "mentioned"
        id: 21819852114
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:15:48Z"
        event: "subscribed"
        id: 21819852115
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T17:37:48Z"
        event: "commented"
        id: 3703935524
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:37:49Z"
        event: "closed"
        id: 21819957638
  -
    comments:
      -
        body: "Resolved: added deterministic disk cover cache cleanup via CLI command 'am cache gc' with age-based (--days) and size-based (--max-mb) pruning. Respects --dry-run and --debug, operates strictly within configured cache root, and deletes only known cache files.\n\nCommits:\n- 1e7165c Feat: add cover cache GC command (am cache gc)\n- a1adda6 Fix: cache gc argparse (reuse global --dry-run)"
        created_at: "2026-01-01T21:16:50Z"
        html_url: "https://github.com/michalholes/audiomason/issues/46#issuecomment-3704116285"
        id: 3704116285
        updated_at: "2026-01-01T21:16:50Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\n- Disk cover cache can grow unbounded over time.\n- There is no built-in way to prune old/unused entries.\n\nRequirements (pick one or combine)\n- Add a GC/cleanup mechanism for disk cache, with deterministic and safe defaults.\n- Options:\n  A) Command: am cache gc [--days N] [--max-mb M] [--dry-run]\n  B) Config-based policy: cover.cache_gc (days/max_mb/off)\n- Must respect:\n  - --dry-run (report only)\n  - --debug (log what would be removed / why)\n- Safety:\n  - never delete outside the configured cache dir\n  - only delete known cache files\n\nAcceptance\n- User can reduce cache size deterministically.\n- Dry-run shows exactly what would be removed.\n"
      closed_at: "2026-01-01T21:16:50Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T17:05:16Z"
      html_url: "https://github.com/michalholes/audiomason/issues/46"
      labels:
        -
          name: "enhancement"
      milestone: null
      number: 46
      state: "closed"
      title: "Covers: add cache GC / cleanup for disk cover cache"
      updated_at: "2026-01-01T21:16:50Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:05:17Z"
        event: "labeled"
        id: 21819791020
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T21:16:50Z"
        event: "commented"
        id: 3704116285
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T21:16:51Z"
        event: "closed"
        id: 21821192419
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Problem\n- AudioMason is currently installed via editable pip / venv only.\n- There is no system-native package for easy installation, upgrade, or removal.\n\nGoal\n- Provide an optional .deb package for Debian-based systems (Debian, Ubuntu, Raspberry Pi OS).\n- This is low priority (P2) and not required for core functionality.\n\nRequirements\n- Build a .deb package that:\n  - installs audiomason CLI system-wide (read-only)\n  - does NOT assume writable system paths at runtime\n  - respects existing config model (AUDIOMASON_ROOT / configuration.yaml)\n- No daemon, no systemd service.\n- Packaging only; runtime behavior unchanged.\n\nNotes / constraints\n- Likely approaches:\n  - setuptools + debhelper\n  - fpm-based packaging\n  - or simple dpkg-deb wrapper\n- Must not break venv-based development workflow.\n\nAcceptance\n- .deb can be built reproducibly.\n- Installing the package provides the 'audiomason' command.\n- Uninstall cleanly removes files.\n"
      closed_at: "2026-01-02T01:54:42Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T17:06:22Z"
      html_url: "https://github.com/michalholes/audiomason/issues/47"
      labels:
        -
          name: "enhancement"
        -
          name: "p2"
      milestone: null
      number: 47
      state: "closed"
      title: "Packaging: provide .deb package for system-wide install"
      updated_at: "2026-01-02T01:54:42Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:06:23Z"
        event: "labeled"
        id: 21819798023
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T17:06:23Z"
        event: "labeled"
        id: 21819798032
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-02T01:54:42Z"
        event: "closed"
        id: 21822402747
  -
    comments:
      -
        body: "Resolved: cover is no longer silently skipped. In interactive mode (without --yes), missing cover now prompts the user even when a stage/manifest exists, and choosing 'Use saved answers? n' correctly ignores sticky manifest cover_mode.\n\nCommit:\n- aee32a9 Fix: prompt cover in interactive mode when no local cover"
        created_at: "2026-01-01T20:32:02Z"
        html_url: "https://github.com/michalholes/audiomason/issues/48#issuecomment-3704083128"
        id: 3704083128
        updated_at: "2026-01-01T20:32:02Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Cover handling has a UX/behavior bug independent of pipeline_steps.\n\nObserved:\n- Stage manifest can contain book_meta.__ROOT_AUDIO__.cover_mode = \"skip\"\n- Even when selecting \"Use saved answers? n\", cover remains silently skipped.\n- If cover_mode key is deleted from manifest, behavior still defaults to skip (no prompt) when prompts are enabled.\n- Result: cover step executes but does not prompt and logs \"[cover] skipped\".\n\nExpected:\n- Selecting \"Use saved answers? n\" should clear cover_mode decisions (or at least cover decisions).\n- When prompts are enabled, missing cover_mode should default to asking (not silent skip).\n- Provide an explicit mechanism to reset/override cover decision (config flag or CLI switch).\n\nNotes:\n- Discovered during validation of issue #20.\n- Intentionally split out to keep pipeline_steps issue clean and closed.\n"
      closed_at: "2026-01-01T20:32:02Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T20:06:58Z"
      html_url: "https://github.com/michalholes/audiomason/issues/48"
      labels:
        []
      milestone: null
      number: 48
      state: "closed"
      title: "BUG: Cover silently skipped due to sticky manifest cover_mode and skip default"
      updated_at: "2026-01-01T20:32:02Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T20:21:03Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T20:32:02Z"
        event: "commented"
        id: 3704083128
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T20:32:03Z"
        event: "closed"
        id: 21820957533
  -
    comments:
      -
        body: "Resolved: crash when downloading cover from URL caused by duplicate check=True passed to subprocess.run via run_cmd.\n\nCommit:\n- b9d5579 Fix: cover URL download crash (dedupe check=True in run_cmd)"
        created_at: "2026-01-01T20:29:36Z"
        html_url: "https://github.com/michalholes/audiomason/issues/49#issuecomment-3704081413"
        id: 3704081413
        updated_at: "2026-01-01T20:29:36Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Repro:\n- Interactive run with cover prompt\n- Select URL cover\n- App crashes with:\n  TypeError: subprocess.run() got multiple values for keyword argument 'check'\n\nTraceback ends at:\n- audiomason/covers.py: download_url()\n- run_cmd([...], check=True)\n- util.run_cmd() already passes check=True internally\n\nRoot cause:\n- check=True is passed twice to subprocess.run()\n\nExpected:\n- URL cover downloads without crash\n\nScope:\n- src/audiomason/covers.py\n- Remove explicit check=True from run_cmd() call\n\nNotes:\n- Found while testing Issue #48 (cover prompt behavior)\n- Issue #48 remains OPEN\n"
      closed_at: "2026-01-01T20:29:37Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T20:21:02Z"
      html_url: "https://github.com/michalholes/audiomason/issues/49"
      labels:
        []
      milestone: null
      number: 49
      state: "closed"
      title: "BUG: crash when downloading cover URL (duplicate check=True in run_cmd)"
      updated_at: "2026-01-01T20:29:37Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T20:29:36Z"
        event: "commented"
        id: 3704081413
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T20:29:37Z"
        event: "closed"
        id: 21820948305
  -
    comments:
      -
        body: "Resolved: stage directory is now correctly cleaned after successful import when the user confirms cleanup. FINALIZE phase now enforces the persisted clean_stage decision and respects --dry-run.\n\nCommit:\n- 483400c Fix: clean stage after successful import in FINALIZE phase"
        created_at: "2026-01-01T21:53:31Z"
        html_url: "https://github.com/michalholes/audiomason/issues/50#issuecomment-3704144359"
        id: 3704144359
        updated_at: "2026-01-01T21:53:31Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\nStage directory is not cleaned after a successful import, even when the user confirms cleanup.\n\nRepro (interactive run):\n- Choose source with existing stage\n- Reuse existing staged source? -> Y\n- Use saved answers? -> N\n- Clean stage after successful import? -> (Yes / default)\n- Import completes successfully (PROCESS + FINALIZE)\n\nObserved\n- Stage directory remains on disk\n- No error or warning is shown\n- FINALIZE phase completes, but stage is not removed\n\nExpected\n- If user confirms \"Clean stage after successful import?\", the stage directory must be deleted after FINALIZE\n- Behavior should be deterministic and explicit\n\nNotes\n- This is NOT a dry-run\n- Import finished successfully\n- Likely regression or missing hook in FINALIZE phase\n- Related to stage reuse / crash-resume logic\n\nFull log excerpt (abridged):\n[stage] Reuse existing staged source? [Y/n] y\n[manifest] Use saved answers (skip prompts)? [Y/n] n\n...\nClean stage after successful import? [Y/n]\n...\n[phase] FINALIZE\n(stage still exists)\n\nEnvironment\n- AudioMason main branch\n- Python 3.11\n- Run inside venv\n- Real data (Asimov.Isaac, multiple books)\n"
      closed_at: "2026-01-01T21:53:31Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T21:42:35Z"
      html_url: "https://github.com/michalholes/audiomason/issues/50"
      labels:
        []
      milestone: null
      number: 50
      state: "closed"
      title: "BUG: stage not cleaned after successful import despite confirmation"
      updated_at: "2026-01-01T21:53:31Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T21:53:31Z"
        event: "closed"
        id: 21821383497
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T21:53:31Z"
        event: "commented"
        id: 3704144359
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T21:54:56Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "Resolved: after successful import, AudioMason now adds the processed source directory to ignore so it no longer appears in subsequent runs.\n\nCommit:\n- c2fd0ba Fix: add processed source directory to ignore after successful import"
        created_at: "2026-01-01T22:02:23Z"
        html_url: "https://github.com/michalholes/audiomason/issues/51#issuecomment-3704150594"
        id: 3704150594
        updated_at: "2026-01-01T22:02:23Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\nAfter a successful book import, AudioMason does not add the processed book directory to the ignore list. As a result, the same directories are shown again as candidates in subsequent runs.\n\nRepro\n- Run am import\n- Successfully process one or more books\n- Stage cleanup may occur correctly\n- Run am again on the same inbox root\n\nObserved\n- Already processed book directories are listed again as selectable sources/books\n\nExpected\n- After successful processing, AudioMason should mark processed content as ignored\n- Minimal acceptable behavior: add the MAIN processed directory (book root) to ignore\n- Ignored directories must not be listed in subsequent runs\n\nNotes\n- This is not about stage cleanup (already fixed in #50)\n- Applies after successful import only\n- Deterministic behavior required (no silent reprocessing)\n- Likely related to ignore handling after FINALIZE\n\nEnvironment\n- AudioMason main branch\n- Python 3.11\n- Run inside venv\n- Real data\n"
      closed_at: "2026-01-01T22:02:24Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T21:54:55Z"
      html_url: "https://github.com/michalholes/audiomason/issues/51"
      labels:
        []
      milestone: null
      number: 51
      state: "closed"
      title: "BUG: processed book directories not added to ignore; reappear in next run"
      updated_at: "2026-01-01T22:02:24Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T22:02:23Z"
        event: "commented"
        id: 3704150594
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T22:02:24Z"
        event: "closed"
        id: 21821420749
  -
    comments:
      -
        body: "Resolved: AudioMason now explicitly logs when staging copy starts, informing the user before data is copied into the stage directory. This avoids the appearance of a hang on slow or I/O-constrained systems.\n\nCommit:\n- 45499fd Fix: log before staging copy starts"
        created_at: "2026-01-01T22:11:36Z"
        html_url: "https://github.com/michalholes/audiomason/issues/52#issuecomment-3704163501"
        id: 3704163501
        updated_at: "2026-01-01T22:11:36Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\nAfter selecting a source, AudioMason begins copying data into the stage directory (when the stage does not already exist), but it does not inform the user that copying has started. This is confusing on slow hardware (Raspberry Pi 4B), as the CLI appears idle.\n\nRepro\n- Run am\n- Select a source\n- When no existing stage is present for that source, AudioMason copies source data into stage\n- User sees no explicit log line indicating the copy phase/progress started\n\nObserved\n- Copy happens silently (no clear \"[stage] copy ...\" or similar)\n- On large sources this looks like a hang\n\nExpected\n- Before copying begins, print a clear message, e.g.:\n  - \"[stage] copying source into stage...\"\n  - include src path and stage path\n- Ideally, provide minimal progress info (file count or per-dir messages), but at minimum one explicit start line is required\n- Must respect --quiet / --dry-run behavior as appropriate\n\nNotes\n- This is about user feedback/visibility; copy behavior itself is correct\n- Particularly important on CPU/I/O constrained systems\n\nEnvironment\n- AudioMason main branch\n- Raspberry Pi 4B\n- Python 3.11\n- Run inside venv\n"
      closed_at: "2026-01-01T22:11:37Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T22:00:31Z"
      html_url: "https://github.com/michalholes/audiomason/issues/52"
      labels:
        []
      milestone: null
      number: 52
      state: "closed"
      title: "BUG: stage copy starts without informing user (no [stage]/[copy] progress)"
      updated_at: "2026-01-01T22:11:37Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T22:11:36Z"
        event: "commented"
        id: 3704163501
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T22:11:37Z"
        event: "closed"
        id: 21821498733
  -
    comments:
      -
        body: "Resolved: OpenLibrary book title suggestions are now de-diacritized (ASCII-only) before prompting, and suggestions are suppressed entirely if they are identical to the user-entered title after normalization. This ensures the prompt never offers diacritics and avoids offering the same title again.\n\nCommits:\n- fc40208 Fix: OpenLibrary title suggestions strip diacritics and suppress identical\n- d3c8ddc Test: align OL suggestion sanitize output (no dash normalization)"
        created_at: "2026-01-01T22:30:28Z"
        html_url: "https://github.com/michalholes/audiomason/issues/53#issuecomment-3704190066"
        id: 3704190066
        updated_at: "2026-01-01T22:30:28Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\nAudioMason currently offers OpenLibrary book title suggestions that contain diacritics, even though the project explicitly rejects diacritics in titles.\n\nExample:\n[ol] book title suggestion: 'Vychovavame deti a rosteme s nimi' -> 'VychovÃ¡vÃ¡me dÄ›ti a rosteme s nimi'\nPrompt:\nUse suggested book title 'VychovÃ¡vÃ¡me dÄ›ti a rosteme s nimi'?\n\nObserved\n- Suggested title contains diacritics\n- User is prompted to accept a title that violates AudioMason naming rules\n\nExpected\n- Any OpenLibrary-suggested title must be normalized to ASCII (no diacritics) *before* being presented to the user\n- Example expected suggestion:\n  'Vychovavame deti a rosteme s nimi'\n- Prompt must never offer a diacritics-containing string\n\nNotes\n- This applies to OpenLibrary title suggestions only\n- De-diacritization should be deterministic and consistent with existing AM normalization rules\n- No change to matching/scoring logic required; only the presented suggestion\n\nEnvironment\n- AudioMason main branch\n- Python 3.11\n- Run inside venv\n"
      closed_at: "2026-01-01T22:30:29Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T22:11:47Z"
      html_url: "https://github.com/michalholes/audiomason/issues/53"
      labels:
        []
      milestone: null
      number: 53
      state: "closed"
      title: "BUG: OpenLibrary title suggestions must be de-diacritized before prompting"
      updated_at: "2026-01-01T22:30:29Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T22:30:28Z"
        event: "commented"
        id: 3704190066
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T22:30:29Z"
        event: "closed"
        id: 21821652866
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T22:33:37Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "Resolved: fixed OpenLibrary author validation crash (NameError) by sanitizing author suggestions using the correct entered author string (q) instead of undefined variable t.\n\nCommit:\n- 275641c Fix: OpenLibrary validate_author uses q for suggestion sanitize (no NameError)"
        created_at: "2026-01-01T22:40:22Z"
        html_url: "https://github.com/michalholes/audiomason/issues/54#issuecomment-3704196067"
        id: 3704196067
        updated_at: "2026-01-01T22:40:22Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\nAudioMason crashes with NameError during author validation after the OpenLibrary suggestion sanitize change (#53).\n\nObserved crash:\nNameError: name 't' is not defined\n\nTraceback (abridged):\nFile \"src/audiomason/openlibrary.py\", line 123, in validate_author\n    top = _sanitize_title_suggestion(t, top)\nNameError: name 't' is not defined\n\nRepro\n- Run am\n- Proceed through import\n- At author prompt, enter an author name\n- Validation crashes immediately\n\nObserved\n- Application terminates with NameError\n- Happens in validate_author(), where variable 't' does not exist\n\nExpected\n- Author validation must not reference undefined variables\n- OpenLibrary sanitize logic should only apply where correct context (book title vs author) exists\n- No crash during author validation\n\nNotes\n- Regression introduced by Issue #53 fix (OpenLibrary title suggestion sanitization)\n- validate_author() should not use book-title variables\n- Likely fix: remove or adjust sanitize call in validate_author()\n\nEnvironment\n- AudioMason main branch\n- Python 3.11\n- Run inside venv\n"
      closed_at: "2026-01-01T22:40:23Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T22:33:36Z"
      html_url: "https://github.com/michalholes/audiomason/issues/54"
      labels:
        []
      milestone: null
      number: 54
      state: "closed"
      title: "BUG: NameError in validate_author after OL suggestion sanitize (undefined variable t)"
      updated_at: "2026-01-01T22:40:23Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-01T22:40:22Z"
        event: "commented"
        id: 3704196067
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-01T22:40:23Z"
        event: "closed"
        id: 21821686072
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Problem\nWhen input MP3 files already contain embedded cover art, AudioMason performs ID3 wipe before preserving the cover. As a result, cover art is lost and the output MP3s end up without a cover.\n\nObserved\n- Input MP3s had cover art embedded\n- AudioMason wiped ID3 tags\n- AudioMason did NOT first persist the embedded cover to cover.jpg (or otherwise preserve it)\n- Output MP3s do not include cover art\n\nRule / Expected behavior\n- If MP3 already has an embedded cover, AudioMason MUST preserve it across wipe.\n- It does NOT need to extract it to cover.jpg before wipe (optional), but it must not lose it.\n- Minimal acceptable fix: if embedded cover is detected, keep/apply it after wipe automatically.\n\nAcceptance\n- Given MP3s with embedded cover and wipe enabled:\n  - output MP3s still contain cover art\n  - no requirement for cover.jpg to be created unless needed by pipeline\n\nNotes\n- This is separate from preflight cover selection; this is about preservation of existing embedded art when wiping tags.\n- Likely fix location: processing step order around wipe_id3 vs cover selection/application.\n\nEnvironment\n- AudioMason main branch\n- Python 3.11\n- Run inside venv\n"
      closed_at: "2026-01-01T22:47:19Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-01T22:44:17Z"
      html_url: "https://github.com/michalholes/audiomason/issues/55"
      labels:
        []
      milestone: null
      number: 55
      state: "closed"
      title: "BUG: existing MP3 embedded cover lost after wipe (not preserved to cover.jpg)"
      updated_at: "2026-01-01T22:47:19Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "cb18b75be12ac993a198f664d978d075ecc1999d"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/cb18b75be12ac993a198f664d978d075ecc1999d"
        created_at: "2026-01-01T22:47:20Z"
        event: "closed"
        id: 21821708671
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-03T17:56:31Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "Resolved.\n\nCommits:\n- 04e9596 Fix: accept *_root aliases in paths resolvers\n- 5914129 Test: use AUDIOMASON_DATA_ROOT for default path base"
        created_at: "2026-01-02T15:42:05Z"
        html_url: "https://github.com/michalholes/audiomason/issues/56#issuecomment-3705611851"
        id: 3705611851
        updated_at: "2026-01-02T15:42:05Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "On a clean .deb install, running `audiomason` could attempt to create inbox/stage/output under `/etc/audiomason/*`, causing:\n\nPermissionError: [Errno 13] Permission denied: '/etc/audiomason/abooksinbox'\n\nExpected:\n- Clean install must use user-safe defaults under ~/.local/share/audiomason unless configured paths are provided.\n\nFix:\n- Accept *_root aliases in paths resolvers.\n- Make default data base user-safe and align tests to AUDIOMASON_DATA_ROOT.\n\nVerification:\n- `audiomason --debug` shows mkdir under ~/.local/share/audiomason and inbox empty (no PermissionError).\n"
      closed_at: "2026-01-02T15:42:05Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-02T15:42:04Z"
      html_url: "https://github.com/michalholes/audiomason/issues/56"
      labels:
        []
      milestone: null
      number: 56
      state: "closed"
      title: "BUG: clean install tries to mkdir under /etc/audiomason (PermissionError)"
      updated_at: "2026-01-02T15:42:05Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-02T15:42:05Z"
        event: "commented"
        id: 3705611851
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-02T15:42:06Z"
        event: "closed"
        id: 21828833492
  -
    comments:
      -
        body: "Resolved by ensuring CI creates /etc/audiomason/config.yaml before pytest in the editable install workflow.\n\nCommits:\n- 169fa0e CI: ensure /etc/audiomason/config.yaml exists for pytest"
        created_at: "2026-01-02T16:39:31Z"
        html_url: "https://github.com/michalholes/audiomason/issues/57#issuecomment-3705746104"
        id: 3705746104
        updated_at: "2026-01-02T16:39:31Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem:\n- GitHub Actions runs tests after an editable install (pip install -e .)\n- CLI arg parsing loads config, and load_config() requires /etc/audiomason/config.yaml\n- CI environment does not have this file, so pytest fails early\n\nFix:\n- CI now ensures /etc/audiomason/config.yaml exists before running pytest (uses debian/config.yaml)\n\nResult:\n- CI green again\n\nCommits:\n- 169fa0e CI: ensure /etc/audiomason/config.yaml exists for pytest"
      closed_at: "2026-01-02T16:39:32Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-02T16:39:30Z"
      html_url: "https://github.com/michalholes/audiomason/issues/57"
      labels:
        -
          name: "bug"
      milestone: null
      number: 57
      state: "closed"
      title: "CI: tests fail without /etc/audiomason/config.yaml in editable install"
      updated_at: "2026-01-02T16:39:32Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-02T16:39:31Z"
        event: "commented"
        id: 3705746104
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-02T16:39:31Z"
        event: "labeled"
        id: 21829389913
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-02T16:39:32Z"
        event: "closed"
        id: 21829390120
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Build: AM Remote API service (FastAPI) as stable server-side wrapper\n\nGoal\n- Introduce a new HTTP service that wraps AudioMason functionality for remote control (GUI client).\n\nScope\n- New package/module: src/audiomason/remote_api/ (or similar)\n- Provide a minimal FastAPI app with health/version endpoint\n- Provide a consistent run-id concept for server-triggered executions\n\nAcceptance criteria\n- `GET /health` returns ok + version\n- Service can be started locally (dev) and returns responses deterministically\n- No interactive prompts over HTTP (this issue only lays foundation)\n\nNotes\n- Assume access over Tailscale (no public exposure) for MVP.\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T08:55:22Z"
      html_url: "https://github.com/michalholes/audiomason/issues/58"
      labels:
        []
      milestone: null
      number: 58
      state: "open"
      title: "Feat: add AM Remote API service (FastAPI) foundation"
      updated_at: "2026-01-03T08:55:22Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Feat: Non-interactive import request model (no prompts)\n\nGoal\n- Make server-triggered imports fully non-interactive so the GUI can drive them.\n\nScope\n- Define a strict JSON request schema for an import job (source selection, config overrides, decisions)\n- Add a codepath that runs import using provided answers (fail-fast if required answers missing)\n- Keep output deterministic for same request\n\nAcceptance criteria\n- API can start an import run without any stdin prompts\n- Missing required decision -> 4xx error with machine-readable list of missing fields\n- Existing CLI behavior stays unchanged\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T08:55:23Z"
      html_url: "https://github.com/michalholes/audiomason/issues/59"
      labels:
        []
      milestone: null
      number: 59
      state: "open"
      title: "Feat: non-interactive import request (GUI-driven, fail-fast)"
      updated_at: "2026-01-03T08:55:23Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Feat: Runs registry (run-id, status, JSON report persistence)\n\nGoal\n- Track each server-triggered run so the GUI can list runs and open details.\n\nScope\n- Introduce a runs registry under an app-controlled state directory (deterministic structure)\n- Store:\n  - run metadata (request, timestamps)\n  - current status (queued/running/succeeded/failed/canceled)\n  - final JSON report (reuse existing JSON report mode if available)\n  - path to log file for the run\n\nAcceptance criteria\n- `GET /runs` lists recent runs with status\n- `GET /runs/{id}` returns run details + links/paths to artifacts (log/report)\n- Data survives service restart\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T08:55:24Z"
      html_url: "https://github.com/michalholes/audiomason/issues/60"
      labels:
        []
      milestone: null
      number: 60
      state: "open"
      title: "Feat: run registry + status/report persistence for remote runs"
      updated_at: "2026-01-03T08:55:24Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Feat: Log and progress streaming endpoints (polling-first MVP)\n\nGoal\n- Allow GUI to show live logs and a basic progress indicator.\n\nScope\n- Add endpoints:\n  - `GET /runs/{id}/log` (tail with offset/limit; polling-friendly)\n  - optional: `GET /runs/{id}/events` (SSE) if easy; otherwise stick to polling MVP\n- Ensure deterministic log formatting where possible (no random ordering)\n\nAcceptance criteria\n- GUI can poll log tail without re-downloading whole file\n- Offset-based log reads are correct and stable\n- Clear handling when run is finished (EOF)\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T08:55:26Z"
      html_url: "https://github.com/michalholes/audiomason/issues/61"
      labels:
        []
      milestone: null
      number: 61
      state: "open"
      title: "Feat: remote run logs + progress endpoints (polling MVP)"
      updated_at: "2026-01-03T08:55:26Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Security: Authentication for Remote API (Tailscale-first, token-based)\n\nGoal\n- Prevent accidental access even on trusted networks.\n\nScope\n- Implement a simple bearer token auth (env var or config entry)\n- Deny by default if token not configured (explicit opt-in)\n- Add request logging with redaction (no token leakage)\n\nAcceptance criteria\n- All non-health endpoints require valid token\n- Invalid/missing token -> 401\n- Token never appears in logs\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T08:55:27Z"
      html_url: "https://github.com/michalholes/audiomason/issues/62"
      labels:
        []
      milestone: null
      number: 62
      state: "open"
      title: "Security: Remote API auth (bearer token, opt-in, redacted logs)"
      updated_at: "2026-01-03T08:55:27Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Feat: Minimal Web GUI (MVP) for iPhone Safari\n\nGoal\n- Provide a tiny web UI to drive imports and monitor runs from iPhone (Safari).\n\nScope\n- Web pages:\n  - Runs list\n  - Run detail (status + log tail + link to JSON report)\n  - Start import form (very small; uses non-interactive request schema)\n- Prefer server-rendered HTML or minimal JS (keep dependencies low)\n\nAcceptance criteria\n- Works in iPhone Safari\n- Can start an import and follow logs to completion\n- No complex styling; function > form\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T08:55:29Z"
      html_url: "https://github.com/michalholes/audiomason/issues/63"
      labels:
        []
      milestone: null
      number: 63
      state: "open"
      title: "Feat: Web GUI MVP (runs list, run detail, start import)"
      updated_at: "2026-01-03T08:55:29Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Ops: Systemd service for AM Remote API (deployable on Debian/Ubuntu)\n\nGoal\n- Make the Remote API run as a managed service on the server.\n\nScope\n- Add systemd unit file (and install path decisions aligned with .deb packaging)\n- Define environment/config loading for token + bind address/port\n- Ensure log location is deterministic and writable\n\nAcceptance criteria\n- `systemctl start audiomason-remote` works\n- Service restarts cleanly\n- Runs registry/logs persist across restarts\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T08:55:30Z"
      html_url: "https://github.com/michalholes/audiomason/issues/64"
      labels:
        []
      milestone: null
      number: 64
      state: "open"
      title: "Ops: systemd service for AM Remote API"
      updated_at: "2026-01-03T08:55:30Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      -
        body: "Resolved: clean_inbox decision is prompted in per-source preflight and executed only after successful import (manifest-driven). No FINALIZE prompt.\n\nCommits:\n- 4a97851 Fix: honor --config from argv when loading config (avoid /etc fallback)\n- 96f9cf3 Fix: preserve --config across double-parse (no fallback to /etc)\n- 728b8d1 Fix: make --debug argv-driven (parse_args can drop ns.debug)\n- 623225b Fix: apply config clean_inbox default unless CLI overrides; debug prints mode\n- b52f7fb Fix: apply config clean_inbox default unless CLI overrides (debug prints mode)\n- d046ce6 Fix: clean_inbox decision in per-source preflight (manifest-driven finalize)\n- 9eb771e Feat: inbox cleanup control (ask/yes/no, deterministic)\n- 828e49a Test: avoid leaking global state from BUG #70 coverage\n- e500956 Fix: require /etc/audiomason/config.yaml; safe data defaults; dynamic version\n- 3c7668e Fix: CLI exits non-zero on invalid system config\n- cb18b75 Fix #55: preserve embedded MP3 cover across ID3 wipe\n- 45499fd Fix: log before staging copy starts\n- c2fd0ba Fix: add processed source directory to ignore after successful import\n- 483400c Fix: clean stage after successful import in FINALIZE phase\n- a1adda6 Fix: cache gc argparse (reuse global --dry-run)\n- 4aa09f6 Feat: move cover selection to preflight (no prompts in processing)\n- aee32a9 Fix: prompt cover in interactive mode when no local cover\n- 1c47d01 Fix: call write_tags with required cover kwargs in pipeline step runner\n- 9f96852 Fix: pass steps into _process_book call-site\n- f261c0a Fix: use state.DEBUG (not OPTS.debug) for debug pipeline logging\n- 1b90d8c Pipeline: finalize pipeline_steps defaults, dry-run and debug output\n- 6fb1419 Pipeline: make pipeline_steps control PROCESS step order\n- 83564de Tags: split cover embedding into write_cover step\n- a0fadc1 Pipeline: introduce resolved execution order skeleton\n- 9f92edf Import: validate pipeline_steps early (fail fast before filesystem)\n- 1da98d5 CLI: replace expected tracebacks with human-readable exits\n- 2c50bc7 Feat: --json report mode (deterministic end-of-run JSON)\n- f22f525 Feat: phase boundaries + resume (ask before skipping processed books)\n- 8e11579 Fix: print config loaded_from after --debug wiring\n- 2e572aa Fix: accept YAML boolean publish in CLI defaults"
        created_at: "2026-01-03T17:56:30Z"
        html_url: "https://github.com/michalholes/audiomason/issues/65#issuecomment-3707241284"
        id: 3707241284
        updated_at: "2026-01-03T17:56:30Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Feat: Inbox cleanup option (prompt + CLI configurable)\n\nGoal\n- Allow controlled cleanup of the inbox directory after a successful import.\n\nProblem\n- Today, inbox cleanup behavior is implicit or inconsistent.\n- User wants:\n  - an explicit question (interactive mode)\n  - a deterministic CLI option (non-interactive / automation / GUI)\n\nScope\n- Introduce a clear inbox cleanup decision with three modes:\n  - ask      -> prompt user after successful import\n  - yes      -> always clean inbox after successful import\n  - no       -> never clean inbox\n- Expose this via:\n  - CLI flag (e.g. --clean-inbox={ask,yes,no})\n  - config default (if CLI flag not provided)\n- Ensure behavior is:\n  - fail-safe (never deletes on failed import)\n  - deterministic\n  - testable\n\nAcceptance criteria\n- Interactive CLI:\n  - user is explicitly asked whether to clean inbox (only on success)\n- Non-interactive CLI:\n  - --clean-inbox=yes cleans inbox automatically after success\n  - --clean-inbox=no skips cleanup\n- Missing decision in non-interactive mode -> fail fast with clear error\n- Behavior covered by tests\n- No change to existing defaults unless explicitly configured\n\nNotes\n- Required for future GUI / Remote API integration.\n"
      closed_at: "2026-01-03T17:56:31Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T08:56:56Z"
      html_url: "https://github.com/michalholes/audiomason/issues/65"
      labels:
        []
      milestone: null
      number: 65
      state: "closed"
      title: "Feat: inbox cleanup control (prompt + CLI option, deterministic)"
      updated_at: "2026-01-03T17:56:31Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-03T17:56:30Z"
        event: "commented"
        id: 3707241284
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-03T17:56:31Z"
        event: "closed"
        id: 21837269302
  -
    comments:
      -
        body: "Issue #66 closed.\n\nImplementation (code + tests): dd7b455\nDocumentation + repo_manifest: 1cd69c7\n\nScope fulfilled. Follow-up refactor/enhancement tracked separately."
        created_at: "2026-01-08T20:50:38Z"
        html_url: "https://github.com/michalholes/audiomason/issues/66#issuecomment-3725736884"
        id: 3725736884
        updated_at: "2026-01-08T20:50:38Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Feat: Configurable preflight question order\n\nGoal\n- Allow deterministic configuration of the order in which preflight questions are asked.\n\nProblem\n- Preflight currently asks questions in a fixed, code-defined order.\n- For CLI power users and future GUI integration, the order must be:\n  - configurable\n  - deterministic\n  - validated fail-fast\n\nScope\n- Introduce a configurable list (e.g. `preflight_steps`) defining question order.\n- Each step represents one logical preflight decision (source, book, id3 wipe, cover, publish, cleanup, etc.).\n- Validate configuration at startup:\n  - unknown step -> error\n  - missing required step -> error\n  - duplicate steps -> error\n- CLI behavior must strictly follow configured order.\n- Default configuration preserves current behavior exactly.\n\nAcceptance criteria\n- User can define preflight question order via config (and optionally CLI override if appropriate).\n- Order is enforced deterministically.\n- Invalid configuration fails fast with a clear error.\n- Fully covered by tests.\n- No change to default behavior unless explicitly configured.\n\nNotes\n- This is a prerequisite for GUI-driven and non-interactive preflight flows.\n"
      closed_at: "2026-01-08T20:50:39Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T09:13:07Z"
      html_url: "https://github.com/michalholes/audiomason/issues/66"
      labels:
        []
      milestone: null
      number: 66
      state: "closed"
      title: "Feat: configurable preflight question order (deterministic, validated)"
      updated_at: "2026-01-08T20:50:39Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "1cd69c796fcb789c93ecb8685468324435b5a226"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/1cd69c796fcb789c93ecb8685468324435b5a226"
        created_at: "2026-01-08T20:47:07Z"
        event: "referenced"
        id: 21932460446
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:50:38Z"
        event: "commented"
        id: 3725736884
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-08T20:50:39Z"
        event: "closed"
        id: 21932529681
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:51:52Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "4da3cf30248eaea00dc2244cc84d5fbb8c85e300"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/4da3cf30248eaea00dc2244cc84d5fbb8c85e300"
        created_at: "2026-01-08T21:00:14Z"
        event: "referenced"
        id: 21932715837
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T21:08:27Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "Resolved.\n\nIssue #67 is complete: deterministic disabling of selected preflight questions.\n\nCommits:\n- 6d3fc2d Feat: disable selected preflight questions\n- d18603d Fix: honor preflight_disable for manifest + reuse prompts\n- 13d0088 Fix: honor preflight_disable for cover override prompts\n- 4f6f4fa Feat: debug log for disabled preflight prompts\n- 325adc7 Fix: debug skip log uses state.DEBUG\n- 89778b7 Fix: avoid cover prompt during dry-run (tests) + keep skip deterministic\n\nAll acceptance criteria met. Global (non-preflight) prompt disabling is handled in a follow-up issue."
        created_at: "2026-01-05T22:36:18Z"
        html_url: "https://github.com/michalholes/audiomason/issues/67#issuecomment-3712324103"
        id: 3712324103
        updated_at: "2026-01-05T22:36:18Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Feat: Disable selected preflight questions (skip prompts deterministically)\n\nGoal\n- Allow users to disable (skip) specific preflight questions/prompts in a deterministic, configurable way.\n\nProblem\n- Preflight currently prompts for multiple decisions.\n- For automation, power users, and future GUI/Remote API, some questions must be suppressible:\n  - either because defaults are desired\n  - or because the decision is provided elsewhere (CLI/config/request)\n\nScope\n- Add configuration to disable a set of preflight questions (e.g. `preflight_disable` list).\n- Disabled questions must:\n  - not be prompted\n  - resolve deterministically via defaults / config / CLI options\n- Fail-fast rules:\n  - If a disabled question has no deterministic resolution (no default / config / CLI), error out before any filesystem changes.\n  - Unknown question keys -> error.\n- Defaults:\n  - Nothing disabled by default (preserve current behavior).\n\nAcceptance criteria\n- User can disable one or more preflight questions via config.\n- Disabled questions are not prompted.\n- Runs remain deterministic.\n- Missing required deterministic value for a disabled prompt -> fail fast with clear error.\n- Covered by tests.\n"
      closed_at: "2026-01-05T22:36:19Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T09:15:18Z"
      html_url: "https://github.com/michalholes/audiomason/issues/67"
      labels:
        []
      milestone: null
      number: 67
      state: "closed"
      title: "Feat: disable selected preflight questions (deterministic skip + fail-fast)"
      updated_at: "2026-01-05T22:36:19Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-03T23:33:04Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-05T22:36:18Z"
        event: "commented"
        id: 3712324103
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-05T22:36:19Z"
        event: "closed"
        id: 21864098902
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Feat: Configurable default answers for binary (y/n) preflight questions\n\nGoal\n- Allow deterministic configuration of default answers for binary (yes/no) preflight questions.\n\nProblem\n- Binary preflight questions (y/N, Y/n) currently have hardcoded interactive defaults.\n- For automation, power users, and future GUI/Remote API usage, defaults must be:\n  - configurable\n  - explicit\n  - deterministic\n- Relying on implicit interactive defaults is not acceptable in non-interactive contexts.\n\nScope\n- Introduce configuration for default answers to binary preflight questions\n  (e.g. `preflight_defaults` mapping: question_key -> yes|no).\n- Defaults apply when:\n  - question is asked interactively and user just presses Enter\n  - question is disabled but needs deterministic resolution\n- Validation rules:\n  - unknown question key -> error\n  - non-binary question referenced -> error\n  - invalid value -> error\n- CLI-provided answers always override configured defaults.\n- Default configuration preserves current behavior exactly.\n\nAcceptance criteria\n- User can configure default answers for y/n preflight questions.\n- Configured defaults override interactive hardcoded defaults.\n- CLI flags take precedence over config defaults.\n- Missing deterministic value in non-interactive context -> fail fast.\n- Fully covered by tests.\n- No behavior change unless explicitly configured.\n\nNotes\n- This is complementary to:\n  - configurable preflight order\n  - disabling preflight questions\n- Required for GUI-driven and Remote API workflows.\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T09:19:55Z"
      html_url: "https://github.com/michalholes/audiomason/issues/68"
      labels:
        []
      milestone: null
      number: 68
      state: "open"
      title: "Feat: configurable default answers for binary preflight questions (y/n)"
      updated_at: "2026-01-03T09:19:55Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Feat: Configurable handling of non-binary preflight questions\n\nGoal\n- Allow deterministic configuration of how non-binary preflight questions are handled.\n\nProblem\n- Non-binary preflight questions (free text, selections, lists, numeric input, etc.)\n  currently rely on interactive prompting.\n- For automation, power users, and future GUI / Remote API usage, their behavior must be:\n  - configurable\n  - explicit\n  - deterministic\n- Implicit interactive behavior is not acceptable in non-interactive contexts.\n\nScope\n- Introduce a configuration model for non-binary preflight questions, allowing:\n  - predefined default values\n  - required explicit values (no default allowed)\n  - optional questions that may be skipped\n- Define per-question policy, e.g.:\n  - required | optional\n  - default value (if allowed)\n- Resolution order:\n  1) CLI-provided value\n  2) Configured value\n  3) Interactive prompt (only if allowed)\n- Fail-fast rules:\n  - Missing required value in non-interactive mode -> error\n  - Unknown question key -> error\n  - Invalid value (type/format/enum) -> error\n\nAcceptance criteria\n- User can configure handling rules for non-binary preflight questions.\n- Non-interactive runs either resolve deterministically or fail fast.\n- Interactive runs respect configured defaults and requirements.\n- CLI values always override config values.\n- Default configuration preserves current behavior exactly.\n- Covered by tests.\n\nNotes\n- Complements:\n  - configurable preflight order\n  - disabling preflight questions\n  - configurable defaults for binary questions\n- Required for full GUI-driven and Remote API-based workflows.\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-03T09:23:03Z"
      html_url: "https://github.com/michalholes/audiomason/issues/69"
      labels:
        []
      milestone: null
      number: 69
      state: "open"
      title: "Feat: configurable handling of non-binary preflight questions (deterministic)"
      updated_at: "2026-01-03T09:23:03Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      -
        body: "Resolved: selecting 'a' (all sources) now expands to independent per-source processing with isolated author/preflight state and deterministic order.\n\nCommits:\n- 828e49a"
        created_at: "2026-01-03T09:39:57Z"
        html_url: "https://github.com/michalholes/audiomason/issues/70#issuecomment-3706929219"
        id: 3706929219
        updated_at: "2026-01-03T09:39:57Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Resolved: selecting 'a' (all sources) now runs PREPARE for all sources first, then PROCESS for all sources, enforcing strict phase separation and deterministic batch decisions.\n\nCommits:\n- 89778b7 Fix: avoid cover prompt during dry-run (tests) + keep skip deterministic"
        created_at: "2026-01-05T02:02:20Z"
        html_url: "https://github.com/michalholes/audiomason/issues/70#issuecomment-3708692972"
        id: 3708692972
        updated_at: "2026-01-05T02:02:20Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "BUG: Choosing a (all sources) in inbox menu is treated as a single author\n\nRepro\n1) Run: am\n2) At inbox menu, enter: a\n3) AudioMason then proceeds as if all selected sources belong to one author (single author flow).\n\nObserved\n- After selecting a, AM behaves as if it has one combined author/source, instead of processing each source independently.\n\nExpected\n- Selecting a should process sources one-by-one, in a deterministic order:\n  - For each selected source, ask author name (and other per-source/book questions) separately.\n  - No cross-contamination of author/title answers between sources.\n\nScope / likely area\n- Inbox source selection handling and the loop that dispatches per-source import runs.\n\nAcceptance criteria\n- a expands to a list of sources and triggers the same per-source flow as selecting them individually.\n- Prompts are repeated per source (author name, etc.) rather than once for the whole batch.\n- Order is deterministic (e.g., menu order).\n- Covered by tests:\n  - Selecting a results in N independent source processing iterations.\n  - Each source gets its own author prompt / state.\n\nNotes\n- This is required for correct multi-source imports and future GUI/Remote API batching.\n\n---\n\nAdditional bug: incorrect phase ordering when selecting all sources\n\nObserved behavior\n- When selecting all sources using input \"a\" / \"A\", AudioMason executes:\n  (preflight for source 1) -> (process source 1) -> (preflight for source 2) -> (process source 2) -> ...\n\nExpected behavior\n- When selecting all sources, AudioMason must:\n  - run preflight for all selected sources first (one by one, collecting decisions)\n  - only after all preflights complete, start processing for all sources\n\nRationale\n- Ensures deterministic batch decisions before any processing starts\n- Prevents partial processing when later sources would lead to different preflight outcomes\n- Aligns with phase separation principles already present in the pipeline\n\nAcceptance criteria\n- With \"a\" / \"A\" selection:\n  - no processing occurs until preflight has completed for all sources\n  - processing starts only after the last preflight finishes\n"
      closed_at: "2026-01-05T02:02:20Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T09:27:27Z"
      html_url: "https://github.com/michalholes/audiomason/issues/70"
      labels:
        []
      milestone: null
      number: 70
      state: "closed"
      title: "BUG: selecting 'a' (all sources) treats multiple sources as one author"
      updated_at: "2026-01-05T02:02:20Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "828e49a242f0a71110cc501d785662291a312721"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/828e49a242f0a71110cc501d785662291a312721"
        created_at: "2026-01-03T09:35:04Z"
        event: "referenced"
        id: 21835317841
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-03T09:39:57Z"
        event: "commented"
        id: 3706929219
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-03T09:39:58Z"
        event: "closed"
        id: 21835331252
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-03T17:56:31Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-04T22:11:45Z"
        event: "reopened"
        id: 21843575669
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-05T02:02:20Z"
        event: "closed"
        id: 21844829175
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-05T02:02:20Z"
        event: "commented"
        id: 3708692972
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Chore: Document mandatory deterministic patch-script workflow for development\n\nGoal\n- Formally document the mandatory patching workflow using deterministic Python edit scripts.\n\nBackground\n- Diff-based patches frequently fail due to context drift.\n- The project now mandates a single, robust patching method based on Python edit scripts\n  with anchor checks, idempotency, and fail-fast behavior.\n\nScope\n- Update developer documentation to define:\n  - Mandatory use of Python edit scripts for all code changes\n  - Standard location: tools/patches/issue_XX.py\n  - Required properties:\n    - anchor checks\n    - idempotency\n    - fail-fast behavior\n    - post-edit assertions\n  - Forbidden practices:\n    - diff patches\n    - manual edits\n    - heredoc-based scripts\n- Document the required end-to-end workflow:\n  edit â†’ pytest â†’ git add â†’ commit â†’ push\n- Explicitly state that patches must be written only against authoritative files\n  provided by the user.\n\nAcceptance criteria\n- Developer documentation clearly describes the required patch workflow.\n- Rules are unambiguous and enforceable.\n- No behavioral or runtime code changes.\n\nNotes\n- This documents an already-adopted rule set; it does not introduce new functionality.\n"
      closed_at: "2026-01-05T22:29:58Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T10:05:01Z"
      html_url: "https://github.com/michalholes/audiomason/issues/71"
      labels:
        []
      milestone: null
      number: 71
      state: "closed"
      title: "Chore: document mandatory deterministic patch-script workflow"
      updated_at: "2026-01-05T22:29:58Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-05T22:29:58Z"
        event: "closed"
        id: 21864023593
  -
    comments:
      -
        body: "Resolved: Always display AudioMason version (CLI + config) with a single source of truth, configurable version banner, and deterministic behavior respecting --quiet/--json.\n\nCommit:\n- 5e1e01f"
        created_at: "2026-01-03T19:27:02Z"
        html_url: "https://github.com/michalholes/audiomason/issues/72#issuecomment-3707297116"
        id: 3707297116
        updated_at: "2026-01-03T19:27:02Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\n-------\nAudioMason currently does not reliably display its version unless explicitly invoked with --version.\nIn practice:\n- `am` starts interactive mode without showing version\n- `am --debug` shows config/path info, but version visibility is inconsistent\n- There is no config-level control for version visibility\n\nGoal\n----\nMake AudioMason version visibility explicit, deterministic, and configurable.\n\nRequirements\n------------\n1. CLI behavior\n   - On startup, AudioMason should be able to display its version banner\n   - Version display must be deterministic and not depend on accidental flags\n\n2. Config support\n   - New config option, e.g.:\n       show_version: always | never | debug\n   - Default must preserve current behavior (no breaking change)\n\n3. Interaction rules\n   - show_version: always\n       - version is printed on every run (before any prompts)\n   - show_version: debug\n       - version is printed only when --debug is active\n   - show_version: never\n       - version is never printed automatically\n\n4. Output rules\n   - Version output must be single-line, stable, machine-readable friendly\n   - Example:\n       AudioMason 1.2.0b2\n\nNon-goals\n---------\n- No changes to packaging versioning\n- No changes to semantic version format\n- No unrelated CLI refactors\n\nConstraints\n-----------\n- Deterministic behavior only\n- Config + CLI override rules must be explicit\n- Covered by tests\n- Must follow patch-script rule:\n    tools/patches/issue_<N>.py\n    idempotent, fail-fast, post-assert\n\nStatus\n------\nFeature request. Issue must NOT be auto-closed.\n"
      closed_at: "2026-01-03T19:27:03Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T11:10:37Z"
      html_url: "https://github.com/michalholes/audiomason/issues/72"
      labels:
        []
      milestone: null
      number: 72
      state: "closed"
      title: "Feat: always display AudioMason version (CLI + config)"
      updated_at: "2026-01-03T19:27:03Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-03T19:27:02Z"
        event: "commented"
        id: 3707297116
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-03T19:27:03Z"
        event: "closed"
        id: 21837677619
  -
    comments:
      -
        body: "Resolved: Support user-space config alongside /etc/audiomason/config.yaml with deterministic resolution order (CLI > user-space > system) and fail-fast behavior.\n\nVerified manually:\n- CLI --config has highest priority\n- ~/.config/audiomason/config.yaml overrides /etc\n- /etc used when user-space missing\n- Fail-fast when no config exists\n\nCommits:\n- d3b3140"
        created_at: "2026-01-03T18:35:44Z"
        html_url: "https://github.com/michalholes/audiomason/issues/73#issuecomment-3707265363"
        id: 3707265363
        updated_at: "2026-01-03T18:35:44Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\n-------\nAudioMason currently loads configuration only from a single system-wide path:\n  /etc/audiomason/config.yaml\n\nThis causes friction for:\n- non-root usage\n- per-user customization\n- development and testing\n\nExample:\nUser has a valid config in user space:\n\n  ~/.config/audiomason/config.yaml\n\nwith content like:\n  clean_inbox: ask\n  publish: ask\n  wipe_id3: ask\n  lookup: yes\n\nbut AudioMason ignores it unless --config is explicitly provided.\n\nGoal\n----\nAllow AudioMason to load configuration from both system-wide and user-space locations,\nwith deterministic precedence and no ambiguity.\n\nProposed behavior (authoritative)\n---------------------------------\n1. Config discovery order (deterministic):\n   1) --config <path>          (explicit override, highest priority)\n   2) ~/.config/audiomason/config.yaml\n   3) /etc/audiomason/config.yaml\n\n2. Merge semantics:\n   - Later configs override earlier ones\n   - All merges must be shallow and deterministic\n   - No implicit defaults beyond existing config defaults\n\n3. Debug visibility:\n   - When --debug is enabled, AudioMason must print:\n       [config] loaded_from=[list of paths in order]\n   - Must clearly show which values came from which file (if feasible without refactor)\n\n4. Backward compatibility:\n   - Existing installations relying on /etc/audiomason/config.yaml must keep working\n   - No behavior change unless user-space config exists\n\nNon-goals\n---------\n- No environment-variable-based config paths\n- No interactive config editing\n- No refactors unrelated to config loading\n\nConstraints\n-----------\n- Deterministic behavior only\n- Fail-fast on invalid YAML\n- Covered by tests\n- Must follow mandatory patch-script rule:\n    tools/patches/issue_<N>.py\n    idempotent, fail-fast, post-assert\n- Issue must NOT be auto-closed\n\nStatus\n------\nFeature request.\n"
      closed_at: "2026-01-03T18:35:45Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T11:12:34Z"
      html_url: "https://github.com/michalholes/audiomason/issues/73"
      labels:
        []
      milestone: null
      number: 73
      state: "closed"
      title: "Feat: support user-space config alongside /etc/audiomason/config.yaml"
      updated_at: "2026-01-03T18:35:45Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-03T18:35:44Z"
        event: "commented"
        id: 3707265363
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-03T18:35:45Z"
        event: "closed"
        id: 21837444404
  -
    comments:
      -
        body: "Issue #74 is now complete and verified.\n\nImplemented features:\n- Optional per-source processing log (default OFF)\n- Streaming log write during runtime (no ex-post buffering)\n- One .log file per source\n- Full per-source lifecycle coverage (stdout, stderr, prompts, answers, actions)\n- CLI and configuration support with CLI precedence\n- Deterministic behavior for --dry-run\n\nCommits:\n- e9ab801 Feat: optional per-source processing log file\n- 7935480 Fix: normalize global prompt override in _process_one_source (Issue #74)\n- 70143f9 Docs: document per-source processing log (Issue #74)\n\nVerification:\n- All tests passing (python -m pytest -q)\n- Manual CLI validation completed\n- Canonical documentation updated in docs/FUNCTIONS.md\n\nClosing as DONE."
        created_at: "2026-01-05T22:25:19Z"
        html_url: "https://github.com/michalholes/audiomason/issues/74#issuecomment-3712297188"
        id: 3712297188
        updated_at: "2026-01-05T22:25:19Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Feat: Optional per-source processing log saved to file\n\nGoal\n- Allow optional saving of processing logs to a file named after the processed source.\n\nBehavior\n- Feature is **disabled by default**.\n- When enabled, AudioMason saves a log file for each processed source.\n- Log filename is derived deterministically from the source name.\n\nConfiguration\n- Feature must be configurable via:\n  - CLI option\n  - config file\n- In both cases, user may specify:\n  - only enable logging\n  - enable logging + explicit output directory\n\nDefaults\n- If logging is enabled **without specifying a directory**:\n  - log file is saved into the **stage directory**.\n- If an explicit directory is provided:\n  - log file is saved there.\n\nCLI (example, final naming up to implementation)\n- --log-to-file\n- --log-to-file-dir <path>\n\nConfig (example, final naming up to implementation)\n- log_to_file: true|false\n- log_to_file_dir: <path>\n\nRules\n- CLI options override config.\n- Logging never changes stdout/stderr behavior (logs are additive).\n- Each source gets its own log file (no shared logs).\n- Log writing must be deterministic and append-safe.\n\nAcceptance criteria\n- Feature is off by default.\n- Enabling logging creates one log file per source.\n- File is named after the source in a deterministic, filesystem-safe way.\n- Default location is stage directory if no path is provided.\n- CLI overrides config.\n- Covered by tests.\n\nNotes\n- Intended for later debugging, audits, and GUI/API integrations.\n"
      closed_at: "2026-01-05T22:25:20Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T22:13:57Z"
      html_url: "https://github.com/michalholes/audiomason/issues/74"
      labels:
        []
      milestone: null
      number: 74
      state: "closed"
      title: "Feat: optional per-source processing log saved to file (CLI + config)"
      updated_at: "2026-01-05T22:25:20Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-05T10:21:02Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-05T11:04:06Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "7935480e32cfc9986f813e437cb1ffdb382011ed"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/7935480e32cfc9986f813e437cb1ffdb382011ed"
        created_at: "2026-01-05T18:30:49Z"
        event: "referenced"
        id: 21860458260
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "70143f9aed4b8b8b0d1f5318b4ac8f9d0c93cce9"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/70143f9aed4b8b8b0d1f5318b4ac8f9d0c93cce9"
        created_at: "2026-01-05T21:04:42Z"
        event: "referenced"
        id: 21862832541
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-05T22:25:19Z"
        event: "commented"
        id: 3712297188
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-05T22:25:20Z"
        event: "closed"
        id: 21863965565
  -
    comments:
      -
        body: "Resolved: Issue #75 â€“ correct book discovery, output mapping, and SyntaxError fix.\n\nCommits:\n- 13491fa Fix: escape backslash in _output_dir guard (SyntaxError)\n- d9b9909 Fix: treat each audio folder as separate book and preserve source structure\n- d85dddc Fix: treat each audio folder as separate book and preserve source structure\n- 37499df Fix: treat each audio folder as separate book and preserve source structure"
        created_at: "2026-01-04T21:58:15Z"
        html_url: "https://github.com/michalholes/audiomason/issues/75#issuecomment-3708461703"
        id: 3708461703
        updated_at: "2026-01-04T21:58:15Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "BUG: Nested folder sources collapse multiple books into one (should treat each audio folder as separate book and preserve structure)\n\nRepro A (nested source)\n- Source is a directory with nested subdirectories, where the actual MP3/M4A folders are deeper:\n  source/\n    level1/\n      level2/\n        Book A/\n          01.mp3 ...\n        Book B/\n          01.mp3 ...\n- AudioMason currently treats all discovered audio files as a single book and exports them into one output folder.\n\nRepro B (selecting all sources)\n- When selecting a (all sources) from the inbox menu, similar collapsing happens: nested audio folders under selected sources may be treated as a single book.\n\nObserved\n- All MP3/M4A files found under a source are grouped as one book.\n- Export output structure collapses into a single folder.\n\nExpected\n- AudioMason must treat **each directory that contains MP3/M4A** as a separate book root.\n- For each such book root, process independently (preflight/book prompts per book as needed).\n- Output must preserve the **relative directory structure** from the source:\n  - If audio folder is nested 38 levels deep, the same relative nesting is preserved under the destination (deterministic, filesystem-safe).\n- This must work both for:\n  - a single selected source\n  - selecting a (all sources)\n\nRules / constraints\n- Deterministic discovery order (stable ordering).\n- No cross-contamination of state between books.\n- Filesystem-safe path mapping (no path traversal; normalized).\n\nAcceptance criteria\n- Given a nested source containing N distinct folders with MP3/M4A, AM processes N books (not 1).\n- Destination mirrors the sourceâ€™s relative path structure for each book folder.\n- Works for both single source selection and a (all sources).\n- Covered by tests:\n  - discovery identifies multiple book roots under nested trees\n  - export preserves relative directory structure\n  - regression for a selection path (if relevant)\n\nNotes\n- This is required for large nested archives and batch imports.\n"
      closed_at: "2026-01-04T21:58:16Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T22:20:51Z"
      html_url: "https://github.com/michalholes/audiomason/issues/75"
      labels:
        []
      milestone: null
      number: 75
      state: "closed"
      title: "BUG: nested sources collapse multiple books into one (should preserve folder structure)"
      updated_at: "2026-01-04T21:58:16Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-04T21:58:15Z"
        event: "commented"
        id: 3708461703
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-04T21:58:16Z"
        event: "closed"
        id: 21843514800
  -
    comments:
      -
        body: "Resolved by commits:\n- 2912621 Feat: global prompt disable\n- c39a61c Docs: document prompts.disable global prompt disable"
        created_at: "2026-01-07T23:24:31Z"
        html_url: "https://github.com/michalholes/audiomason/issues/76#issuecomment-3721251192"
        id: 3721251192
        updated_at: "2026-01-07T23:24:31Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Feat: global prompt disable (non-preflight + preflight)\n\nProblem\n- Dnes vieme deterministicky vypÃ­naÅ¥ iba preflight otÃ¡zky cez `preflight_disable` (Issue #67).\n- StÃ¡le vÅ¡ak existujÃº non-preflight interaktÃ­vne prompty, ktorÃ© volajÃº priamo:\n  - `prompt(...)`\n  - `prompt_yes_no(...)`\n  PrÃ­klady:\n  - \"Choose source number, or a for all\"\n  - \"Choose book number, or a for all\"\n  - \"Skip already processed books? [y/N]\"\n  - prÃ­padne ÄalÅ¡ie prompty v import flow\n\nGoal (authoritative)\n- ZaviesÅ¥ globÃ¡lnu konfigurÃ¡ciu, ktorÃ¡ umoÅ¾nÃ­ vypnÃºÅ¥ VÅ ETKY otÃ¡zky (preflight + non-preflight) deterministicky.\n\nNavrhovanÃ½ config\n- NovÃ½ kÄ¾ÃºÄ:\n  prompts:\n    disable:\n      - \"*\"\n- VÃ½znam:\n  - [\"*\"] = vypne vÅ¡etky interaktÃ­vne otÃ¡zky poÄas celÃ©ho behu\n  - voliteÄ¾ne: disable: [choose_source, choose_books, skip_processed_books, ...] pre selektÃ­vne vypnutie mimo preflightu\n\nRequired behavior\n1) Config kÄ¾ÃºÄ\n- ZaviesÅ¥ `prompts.disable` (list)\n- PovoliÅ¥ `*` pre disable-all\n\n2) Determinizmus\n- Ak je prompt vypnutÃ½, musÃ­ sa vyrieÅ¡iÅ¥ deterministicky:\n  - pouÅ¾iÅ¥ existujÃºci default (rovnakÃ½ ako dnes), alebo\n  - pouÅ¾iÅ¥ uloÅ¾enÃ© odpovede (manifest), ak je to relevantnÃ©, alebo\n  - fail-fast, ak prompt nemÃ¡ deterministickÃ© rieÅ¡enie bez otÃ¡zky\n\n3) Fail-fast validÃ¡cia (pred FS zmenami)\n- `prompts.disable` musÃ­ byÅ¥ list\n- neznÃ¡my key -> chyba\n- duplicity -> chyba\n- `*` nesmie byÅ¥ kombinovanÃ© s ÄalÅ¡Ã­mi key (buÄ [\"*\"] alebo konkrÃ©tny zoznam)\n\n4) Default sprÃ¡vanie\n- Ak `prompts.disable` nie je nastavenÃ©:\n  - sprÃ¡vanie musÃ­ zostaÅ¥ presne ako dnes\n\n5) CLI vs config\n- Ak existuje CLI ekvivalent (napr. `--prompts-disable`), CLI mÃ¡ prednosÅ¥ pred configom.\n- Ak CLI eÅ¡te neexistuje, minimÃ¡lny scope mÃ´Å¾e byÅ¥ iba config (deterministicky).\n\nScope (strict)\n- Zmeny iba na:\n  - globÃ¡lne prompt disable mechanizmy\n  - wrappery pre non-preflight prompty\n  - validÃ¡cia + testy\n- Bez refaktorov mimo nutnÃ©ho, bez docs zmien, bez ÄalÅ¡Ã­ch preflight features (order/disable/defaults/non-binary sÃº samostatnÃ© issues).\n\nMinimal non-preflight prompt keys (initial proposal)\n- choose_source -> \"Choose source number, or a for all\"\n- choose_books -> \"Choose book number, or a for all\"\n- skip_processed_books -> \"Skip already processed books? [y/N]\"\n- plus vÅ¡etky ÄalÅ¡ie prompty mimo preflightu po audite (`rg -n \"\\bprompt\\(\" src/audiomason` + `rg -n \"\\bprompt_yes_no\\(\" src/audiomason`)\n\nImplementation strategy (authoritative)\n- ZaviesÅ¥ helpery (napr. v import_flow.py alebo v util module podÄ¾a existujÃºceho patternu):\n  - `_resolved_prompt_disable(cfg) -> set[str]`\n  - `_prompt_disabled_all(cfg) -> bool`\n  - `_q_prompt(cfg, key, text, default) -> str`\n  - `_q_prompt_yes_no(cfg, key, text, default_no) -> bool`\n- PresmerovaÅ¥ non-preflight prompty na wrappery (posÃºvaÅ¥ `cfg` do vÃ½berovÃ½ch funkciÃ­ a call-sites).\n- ZaviesÅ¥ fail-fast validÃ¡ciu na zaÄiatku import flow (pred FS prÃ¡cou).\n- Pri `--debug` logovaÅ¥ preskoÄenie promptu:\n  [TRACE] [prompt] disabled: <key> -> default: <value>\n\nAcceptance criteria\n- `prompts.disable: [\"*\"]` -> nespustÃ­ sa Å¾iadna otÃ¡zka (preflight ani non-preflight)\n- `prompts.disable: [choose_source]` -> preskoÄÃ­ iba vÃ½ber source (deterministicky default \"1\")\n- `skip_processed_books` prompt sa dÃ¡ vypnÃºÅ¥ rovnako\n- invalid config -> fail-fast s jasnou chybou\n- default bez configu -> nezmenenÃ© sprÃ¡vanie\n- testy pokrÃ½vajÃº:\n  - disable-all zamedzÃ­ volaniu prompt/prompt_yes_no\n  - unknown key / duplicate / invalid type -> chyba\n"
      closed_at: "2026-01-07T23:24:31Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-03T23:33:03Z"
      html_url: "https://github.com/michalholes/audiomason/issues/76"
      labels:
        []
      milestone: null
      number: 76
      state: "closed"
      title: "Feat: global prompt disable (non-preflight + preflight)"
      updated_at: "2026-01-07T23:24:31Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "2912621c3253c88880fa7d4ec1e2b9680e05392a"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/2912621c3253c88880fa7d4ec1e2b9680e05392a"
        created_at: "2026-01-07T22:58:09Z"
        event: "referenced"
        id: 21909858263
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "c39a61c2c58390d0970179603ad80102dd846403"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/c39a61c2c58390d0970179603ad80102dd846403"
        created_at: "2026-01-07T23:23:30Z"
        event: "referenced"
        id: 21910194142
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-07T23:24:31Z"
        event: "commented"
        id: 3721251192
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-07T23:24:32Z"
        event: "closed"
        id: 21910207576
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-07T23:29:37Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Feat: allow selecting multiple sources or books by explicit index list (e.g. \"1 4 15\")\n\nProblem\n- Today, selection prompts only support:\n  - a single index (e.g. \"1\")\n  - or \"a\" for all\n- There is no way to select an explicit subset (e.g. authors 1, 4, and 15),\n  which makes batch processing of specific items unnecessarily slow and repetitive.\n\nAffected prompts (examples)\n- Source selection:\n  \"Choose source number, or a for all\"\n- Book selection:\n  \"Choose book number, or a for all\"\n\nGoal (authoritative)\n- Extend selection prompts to support **explicit multi-selection** using index lists.\n\nDesired UX\n- User can enter:\n  - space-separated list: \"1 4 15\"\n  - (optionally later) comma-separated list: \"1,4,15\" (not required for MVP)\n- Result:\n  - Only the selected sources / books are processed\n  - In the order specified by the user (or normalized deterministically)\n\nRules / behavior\n- Supported inputs:\n  - single number (existing behavior)\n  - \"a\" (existing behavior: all)\n  - multi-number list (new behavior)\n- Validation (fail-fast):\n  - non-numeric token (except \"a\") -> error\n  - index out of range -> error\n  - duplicates -> error\n  - mixing \"a\" with numbers -> error\n- Default behavior with empty input stays unchanged.\n\nScope\n- Implement only for:\n  - source selection\n  - book selection\n- No changes to preflight logic itself.\n- No changes to discovery logic.\n- No documentation changes in this issue.\n\nImplementation notes (guidance, not mandate)\n- Centralize parsing logic:\n  - helper like `_parse_index_selection(input: str, max_n: int) -> list[int]`\n- Reuse helper for both source and book selection.\n- Deterministic ordering must be guaranteed.\n\nAcceptance criteria\n- User can select multiple sources via e.g. \"1 4 15\"\n- User can select multiple books via e.g. \"2 3 5\"\n- Existing behaviors (single index, \"a\") remain unchanged.\n- Invalid input fails fast with a clear error message.\n- Covered by tests:\n  - valid multi-select\n  - invalid token\n  - duplicate index\n  - out-of-range index\n  - mixing \"a\" with numbers\n\nNotes\n- This feature complements (but does not replace):\n  - \"a\" (select all)\n  - future global prompt disable / non-interactive modes.\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-04T08:10:00Z"
      html_url: "https://github.com/michalholes/audiomason/issues/77"
      labels:
        []
      milestone: null
      number: 77
      state: "open"
      title: "Feat: allow selecting multiple sources or books by index list (e.g. \"1 4 15\")"
      updated_at: "2026-01-04T08:10:00Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Feat: preflight question to control stage creation per source (disable-able via config/CLI)\n\nProblem\n- AudioMason currently always creates a stage after source selection and works on copied data.\n- There is no way to decide to work directly on files and directories in the inbox without creating a stage.\n\nGoal\n- Introduce a preflight question immediately after source selection that controls whether a stage should be created or not.\n\nPreflight question\n- Question (indicative wording):\n  \"Create stage for this source? [Y/n]\"\n- Default answer: Yes (preserves current behavior)\n\nBehavior\n- If answer = Yes:\n  - stage is created using the existing deterministic stage naming and layout (unchanged)\n  - subsequent processing works on stage data\n- If answer = No:\n  - stage is NOT created\n  - AudioMason works directly with files and directories in the inbox\n  - no data copying occurs\n\nRules / constraints\n- Decision is per source.\n- Default behavior without any configuration must remain unchanged.\n- The answer must be persisted deterministically (for resume / repeated runs).\n\nCritical requirement â€“ prompt control\n- This question (and all future questions introduced in AudioMason) MUST be disable-able deterministically via:\n  - configuration file\n  - command-line options\n- When the prompt is disabled:\n  - the prompt must not be shown\n  - the default answer must be applied deterministically\n- This requirement must integrate with the existing / planned global prompt control mechanism\n  (e.g. global prompt disable or per-prompt disable via config/CLI).\n\nScope\n- Changes limited to:\n  - preflight logic\n  - stage creation flow\n  - validation and tests\n- No changes to:\n  - discovery logic\n  - export logic\n  - documentation (unless explicitly required by the issue)\n\nAcceptance criteria\n- After source selection, a stage creation question is shown.\n- Yes -> behavior identical to current implementation.\n- No -> no stage is created, processing happens directly in inbox.\n- Default answer is Yes.\n- When the prompt is disabled:\n  - no interactive prompt is shown\n  - default Yes is applied deterministically.\n- Covered by tests:\n  - stage enabled\n  - stage disabled\n  - prompt disabled -> default Yes\n\nNotes\n- This feature enables faster workflows without unnecessary data duplication.\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-04T13:14:36Z"
      html_url: "https://github.com/michalholes/audiomason/issues/78"
      labels:
        []
      milestone: null
      number: 78
      state: "open"
      title: "Feat: preflight stage creation toggle per source (disable-able via config/CLI)"
      updated_at: "2026-01-04T13:14:36Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "TRACKING (META) â€” split into sub-issues:\n- # loudnorm determinism\n- # cleanup_stage CLI control\n- # clean_inbox config-hide validation bug\n- # docs audit & alignment\n\nClose #79 only when all sub-issues are closed."
      closed_at: null
      closed_by: null
      created_at: "2026-01-04T23:00:23Z"
      html_url: "https://github.com/michalholes/audiomason/issues/79"
      labels:
        []
      milestone: null
      number: 79
      state: "open"
      title: " CLI enable + config-hide support for all Opts flags"
      updated_at: "2026-01-10T00:16:12Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-04T23:37:58Z"
        event: "renamed"
        id: 21843930555
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T00:19:36Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T00:19:37Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T00:19:38Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T00:19:39Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T00:21:10Z"
        event: "sub_issue_added"
        id: 21958431108
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T00:21:11Z"
        event: "sub_issue_added"
        id: 21958431204
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T00:21:11Z"
        event: "sub_issue_added"
        id: 21958431235
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T00:21:12Z"
        event: "sub_issue_added"
        id: 21958431324
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Fix: util.py has syntax error (unexpected indent)\n\nSummary\n- `src/audiomason/util.py` is syntactically invalid Python and blocks:\n  - importing `audiomason.util`\n  - running tests\n  - running patch scripts\n  - any further development\n\nError\n- Fails with:\n  `IndentationError: unexpected indent` (around line ~62)\n\nRoot cause\n- `util.py` contains top-level code with invalid indentation, e.g. an indented block like:\n  - optional per-source log sink globals\n  - helper functions\n  - contextmanager `out_to_file(...)`\n- This code is not inside any function/class/conditional, yet is indented, which is invalid at module top-level.\n\nImportant notes\n- This is not a patch runner/test issue.\n- This is not a regression caused by Issue #74.\n- The bug exists in the authoritative repo state.\n- Until fixed, no other issues can be worked on safely.\n\nScope of fix\n- Fix indentation / placement in `src/audiomason/util.py` so the module parses/imports again.\n- No behavior changes.\n- No refactors.\n- No new features.\n\nAcceptance criteria\n- `python -c \"import audiomason.util\"` succeeds.\n- `python -m pytest -q` succeeds.\n"
      closed_at: "2026-01-06T05:36:28Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-05T10:21:01Z"
      html_url: "https://github.com/michalholes/audiomason/issues/80"
      labels:
        []
      milestone: null
      number: 80
      state: "closed"
      title: "Fix: util.py has syntax error (unexpected indent)"
      updated_at: "2026-01-06T05:36:28Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-06T05:36:28Z"
        event: "closed"
        id: 21868475424
  -
    comments:
      -
        body: "Fixed by commit 0acc7d8 (Fix: add explicit per-source processing boundary). Introduced a single explicit per-source lifecycle boundary and delegated _run_one_source() to it. No behavior or UX changes. All tests passing (61/61)."
        created_at: "2026-01-05T12:01:13Z"
        html_url: "https://github.com/michalholes/audiomason/issues/81#issuecomment-3710146592"
        id: 3710146592
        updated_at: "2026-01-05T12:01:13Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "BUG: missing explicit per-source processing boundary in import_flow.py blocks cross-cutting features\n\nProblem\nThe current `import_flow.py` does not define a clear, explicit boundary for \"per-source processing\".\n\nThe function `_run_one_source()` mixes:\n- preparation\n- user prompts\n- processing logic\n- error exits\n- cleanup\n\ninto a single, branching control-flow with multiple early returns.\n\nBecause of this, it is not possible to safely:\n- wrap the entire per-source execution in a single context\n- introduce per-source features such as complete processing logs\n- guarantee that such features cover the full lifecycle of a source\n\nThis limitation was discovered while implementing Issue #74\n(\"save processing log to per-source file\").\n\nWhy this is a blocker\nAny attempt to add per-source cross-cutting features (logging, metrics,\ntiming, tracing, cancellation scopes) requires:\n- a single, well-defined entry point\n- a single, well-defined exit point\n\nWithout that boundary, implementations would be:\n- partial\n- heuristic\n- or misleading to users\n\nThis refactor is therefore a design prerequisite, not a cosmetic change.\n\nScope (STRICT)\nThis issue must:\n- Introduce an explicit per-source processing boundary, e.g.:\n  - a dedicated helper such as `_process_one_source(...)`, or\n  - an equivalent clearly defined wrapper\n- Preserve existing behavior exactly\n- Make no functional or UX changes\n- Add no new features by itself\n\nThis issue must NOT:\n- Change pipeline semantics\n- Change prompts or CLI behavior\n- Add logging or other cross-cutting features directly\n\nAcceptance criteria\n- There is a single, explicit function or block that represents\n  \"the full per-source processing lifecycle\"\n- `_run_one_source()` delegates actual processing to this boundary\n- All existing tests pass without modification\n- No user-visible behavior changes\n\nFollow-up\nOnce this refactor is completed, Issue #74\n(\"optional per-source processing log file\")\ncan be implemented cleanly and deterministically.\n"
      closed_at: "2026-01-05T12:01:14Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-05T11:04:05Z"
      html_url: "https://github.com/michalholes/audiomason/issues/81"
      labels:
        []
      milestone: null
      number: 81
      state: "closed"
      title: "BUG: missing explicit per-source processing boundary blocks cross-cutting features"
      updated_at: "2026-01-05T12:01:14Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-05T12:01:13Z"
        event: "commented"
        id: 3710146592
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-05T12:01:14Z"
        event: "closed"
        id: 21852617096
  -
    comments:
      -
        body: "Resolved: allow disabling OpenLibrary lookup via config and CLI.\n\nCommits:\n- e825ea6 Feat: allow disabling OpenLibrary lookup via config and CLI"
        created_at: "2026-01-06T21:45:48Z"
        html_url: "https://github.com/michalholes/audiomason/issues/82#issuecomment-3716480584"
        id: 3716480584
        updated_at: "2026-01-06T21:45:48Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Disable OpenLibrary suggestions via config and CLI\n\nProblem\nAudioMason shows OpenLibrary suggestion prompts (author/book normalization) even when related preflight prompts are disabled.\n\nRoot cause\nOpenLibrary prompts are implemented using prompt_yes_no(...) instead of preflight-aware helpers, so they ignore preflight_disable and non-interactive workflows.\n\nRequired solution\n- Allow disabling OpenLibrary via config (e.g. openlibrary.enabled: false or lookup: false).\n- Allow disabling OpenLibrary via CLI (e.g. --no-openlibrary / --no-lookup).\n- CLI overrides config.\n\nAcceptance criteria\n- No OpenLibrary prompts or network calls when disabled.\n- Existing behavior unchanged when enabled.\n\nScope\n- Only add the ability to disable OpenLibrary.\n- No normalization or UX changes when enabled.\n"
      closed_at: "2026-01-06T21:45:49Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-05T11:58:13Z"
      html_url: "https://github.com/michalholes/audiomason/issues/82"
      labels:
        []
      milestone: null
      number: 82
      state: "closed"
      title: "Feat: disable OpenLibrary suggestions via config and CLI"
      updated_at: "2026-01-06T21:45:49Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-06T21:45:48Z"
        event: "commented"
        id: 3716480584
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-06T21:45:49Z"
        event: "closed"
        id: 21885612114
  -
    comments:
      -
        body: "Resolved: authoritative catalog of all AudioMason prompts.\n\nCommits:\n- 1c735c3 Chore: add authoritative catalog of all AudioMason prompts"
        created_at: "2026-01-06T07:12:34Z"
        html_url: "https://github.com/michalholes/audiomason/issues/83#issuecomment-3713443694"
        id: 3713443694
        updated_at: "2026-01-06T07:12:34Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Chore/Docs: authoritative catalog of all AudioMason prompts (defaults, config, CLI)\n\nGoal\nCreate a single authoritative document that enumerates ALL prompts used by AudioMason.\n\nThis catalog will serve as:\n- the definitive reference for users\n- the authoritative source for future feature work\n- a living document updated by future chats/issues\n\nScope of the catalog\nThe document MUST list every prompt, including:\n- preflight prompts\n- non-preflight prompts\n- prompts that are currently hidden or only reachable in edge cases\n- prompts that may no longer be shown by default but still exist in code\n\nFor EACH prompt, the catalog must include:\n- unique prompt key / identifier\n- human-readable question text\n- phase (preflight / non-preflight / other)\n- default value\n- whether it is interactive by default\n- config key(s) that control it (if any)\n- CLI flag(s) that control it (if any)\n- whether it can be disabled via prompt-control mechanisms\n- deterministic behavior when disabled\n\nFile requirements\n- The catalog must live in a dedicated file in the repository (exact path to be decided in the issue).\n- The file is AUTHORITATIVE.\n- Future chats and issues will rely on this file and update it incrementally.\n\nNon-goals\n- This issue does NOT change behavior.\n- This issue does NOT add new prompts.\n- This issue does NOT refactor code.\n\nAcceptance criteria\n- A single file exists that documents all AudioMason prompts.\n- No known prompt is undocumented.\n- Defaults, config options, and CLI mappings are explicit.\n- The file can be safely referenced by future feature and bugfix issues.\n"
      closed_at: "2026-01-06T07:12:35Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-06T06:19:23Z"
      html_url: "https://github.com/michalholes/audiomason/issues/83"
      labels:
        []
      milestone: null
      number: 83
      state: "closed"
      title: "Chore: authoritative catalog of all AudioMason prompts (defaults, config, CLI)"
      updated_at: "2026-01-06T07:12:35Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-06T07:12:34Z"
        event: "commented"
        id: 3713443694
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-06T07:12:35Z"
        event: "closed"
        id: 21869819665
  -
    comments:
      -
        body: "Resolved: support .opus audiobooks (converted to .mp3).\n\nCommits:\n- 935226c Feat: support .opus inputs (convert to .mp3)\n- 46c71bc Chore: document .opus support (FUNCTIONS.md)"
        created_at: "2026-01-07T07:57:49Z"
        html_url: "https://github.com/michalholes/audiomason/issues/84#issuecomment-3717722949"
        id: 3717722949
        updated_at: "2026-01-07T07:57:49Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Feat: support .opus audiobooks (convert to .mp3 and process normally)\n\nProblem\nAudioMason currently does not support audiobooks stored as .opus files.\nSuch sources are either ignored or fail during processing, even though .opus\nis a common and efficient audiobook format.\n\nGoal\nAdd first-class support for .opus audiobook files by converting them to .mp3\nand then processing them through the standard AudioMason pipeline.\n\nExpected behavior\n- .opus files found in source directories are detected as valid audio inputs\n- Each .opus file is converted to .mp3 using the existing audio toolchain\n- After conversion, processing continues exactly as for native .mp3 sources\n- Folder and book structure semantics remain unchanged\n\nScope (STRICT)\n- Only add support for .opus input files\n- Conversion target format: .mp3\n- No changes to existing .mp3/.m4a behavior\n\nConfiguration / CLI\n- Conversion must be controllable via CLI and config\n- No new prompts by default\n- Any new prompt MUST be disable-able via config/CLI\n\nAcceptance criteria\n- .opus-only audiobooks are fully processed end-to-end\n- Mixed folders (.opus + .mp3/.m4a) behave deterministically\n- All existing tests pass\n- New tests cover .opus detection and conversion\n"
      closed_at: "2026-01-07T07:57:49Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-06T23:13:02Z"
      html_url: "https://github.com/michalholes/audiomason/issues/84"
      labels:
        []
      milestone: null
      number: 84
      state: "closed"
      title: "Feat: support .opus audiobooks (convert to .mp3)"
      updated_at: "2026-01-07T07:57:49Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-07T07:57:49Z"
        event: "closed"
        id: 21892086579
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-07T07:57:49Z"
        event: "commented"
        id: 3717722949
  -
    comments:
      -
        body: "Closed by commit ae08c2d: Docs: cross-link FUNCTIONS and prompt catalog (Issue #85)"
        created_at: "2026-01-07T07:46:40Z"
        html_url: "https://github.com/michalholes/audiomason/issues/85#issuecomment-3717695043"
        id: 3717695043
        updated_at: "2026-01-07T07:46:40Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "## Problem\n\nThere are two canonical documentation files that describe different but related aspects\nof AudioMason behavior:\n\n- `docs/FUNCTIONS.md` â€” canonical source of truth for functional behavior\n- `docs/prompts/catalog.md` â€” canonical source of truth for interactive prompts\n\nWhile they are intentionally separate, the relationship between them is not explicit,\nwhich can lead to confusion or accidental duplication.\n\n## Goal\n\nKeep the documents strictly separated (no merge), but make the relationship explicit\nand self-documenting.\n\n## Requirements (STRICT)\n\n1. Do NOT merge the documents.\n2. Add a short cross-reference in the introduction of both files:\n   - `docs/FUNCTIONS.md` must point to `docs/prompts/catalog.md` for interactive prompts.\n   - `docs/prompts/catalog.md` must point to `docs/FUNCTIONS.md` for functional behavior.\n3. Do NOT duplicate content between the two documents.\n4. Documentation-only change (no functional or behavioral changes).\n\n## Acceptance criteria\n\n- Both documents contain a clear and visible cross-link.\n- Each document keeps its original responsibility and scope.\n- No duplicated descriptions of prompts or functions exist.\n- All tests pass.\n"
      closed_at: "2026-01-07T07:46:41Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-07T00:35:19Z"
      html_url: "https://github.com/michalholes/audiomason/issues/85"
      labels:
        []
      milestone: null
      number: 85
      state: "closed"
      title: "Docs: cross-link canonical FUNCTIONS and prompt catalog (avoid duplication)"
      updated_at: "2026-01-07T07:46:41Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "ae08c2da50e19a05e3f03c076564a51156b79b21"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/ae08c2da50e19a05e3f03c076564a51156b79b21"
        created_at: "2026-01-07T07:46:17Z"
        event: "referenced"
        id: 21891918888
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-07T07:46:40Z"
        event: "commented"
        id: 3717695043
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-07T07:46:41Z"
        event: "closed"
        id: 21891924424
  -
    comments:
      -
        body: "PROCESS-only conversion and publish-at-end ordering implemented and documented. Commits: 0f519ef (code), 11350f3 (docs)."
        created_at: "2026-01-07T09:56:55Z"
        html_url: "https://github.com/michalholes/audiomason/issues/86#issuecomment-3718102320"
        id: 3718102320
        updated_at: "2026-01-07T09:56:55Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "BUG: audio conversion and publish run in the wrong phase/order (opus + m4a)\n\nSummary\nAudioMason performs heavy audio work too early and/or in the wrong order:\n- conversion (confirmed for .opus and .m4a) runs during PREPARE/stage instead of PROCESS\n- output publish/copy to the final library happens at the start of PROCESS, before finalization steps\n\nObserved\n- With .opus sources, ffmpeg conversion logs appear immediately after staging (before PROCESS).\n- The same behavior is confirmed for .m4a.\n- In debug logs, PROCESS begins with copying files from stage/src into the final output directory.\n\nExpected\n- PREPARE must remain lightweight (prompts/validation/manifest/stage setup) and must not run heavy conversions.\n- All audio transformations must happen inside PROCESS (convert/rename/wipe_id3/tags/chapters/split/loudnorm/etc.).\n- Publish/copy to the final output directory must happen only after all finalization steps complete.\n\nScope (strict)\n- Fix phase ordering only.\n- No UX changes.\n- No new features.\n- Preserve existing behavior except for moving work to the correct phase/order.\n\nAcceptance criteria\n- No .opus or .m4a conversion runs during PREPARE/stage.\n- Conversions run only in PROCESS.\n- Final output publish/copy happens after all processing/finalization steps.\n- Existing tests pass; add a regression test if feasible.\n"
      closed_at: "2026-01-07T09:56:56Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-07T00:48:02Z"
      html_url: "https://github.com/michalholes/audiomason/issues/86"
      labels:
        []
      milestone: null
      number: 86
      state: "closed"
      title: "BUG: audio conversion and publish run in the wrong phase/order (opus + m4a)"
      updated_at: "2026-01-07T09:56:56Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e1d7c199f4ceef6853c6a70520ffb6338f92a624"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e1d7c199f4ceef6853c6a70520ffb6338f92a624"
        created_at: "2026-01-07T01:40:32Z"
        event: "referenced"
        id: 21888093187
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "0f519ef75efe3a7c6eada00957ba4c5a2eba4978"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/0f519ef75efe3a7c6eada00957ba4c5a2eba4978"
        created_at: "2026-01-07T09:37:15Z"
        event: "referenced"
        id: 21893858483
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "11350f393d4585688ac2fbb8b6a392bd0c84d82c"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/11350f393d4585688ac2fbb8b6a392bd0c84d82c"
        created_at: "2026-01-07T09:55:24Z"
        event: "referenced"
        id: 21894213276
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-07T09:56:55Z"
        event: "commented"
        id: 3718102320
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-07T09:56:56Z"
        event: "closed"
        id: 21894243339
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Problem\nWhen selecting all sources (input 'a'), AudioMason currently stages (copies) data first and only then asks preflight questions.\nThis creates idle time where the user waits for I/O-heavy staging to finish before answering prompts.\n\nGoal\nAllow the user to answer preflight questions while staging copy is still running.\nThis should work per source, and especially for batch runs when selecting all sources.\n\nProposed behavior\n- For each selected source, start staging copy in the background.\n- While staging is running, ask preflight prompts in the foreground (interactive).\n- Start PROCESS for that source only after BOTH:\n  (1) staging copy completed successfully\n  (2) preflight decisions are completed.\n\nConstraints (strict)\n- Must remain deterministic.\n- Must not break non-interactive / prompt-disable modes.\n- No changes to default behavior unless the feature is enabled.\n- Interactive I/O must remain stable (no garbled output).\n\nConfiguration / CLI\n- Feature should be opt-in via CLI and/or config.\n- If enabled, it applies when multiple sources are selected (e.g. 'a').\n\nAcceptance criteria\n- User can answer preflight questions while staging copy runs.\n- No PROCESS begins before staging is finished.\n- Errors in staging are handled cleanly and fail-fast.\n- Existing tests pass; add a regression test if feasible."
      closed_at: null
      closed_by: null
      created_at: "2026-01-07T02:05:42Z"
      html_url: "https://github.com/michalholes/audiomason/issues/87"
      labels:
        []
      milestone: null
      number: 87
      state: "open"
      title: "Feat: overlap staging copy with preflight prompts when selecting all sources"
      updated_at: "2026-01-07T02:05:42Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      -
        body: "Fix: clean_inbox resolved once per run; prompt never during PROCESS. Docs + repo_manifest updated. Commit: f02dbfe"
        created_at: "2026-01-07T21:20:38Z"
        html_url: "https://github.com/michalholes/audiomason/issues/88#issuecomment-3720861147"
        id: 3720861147
        updated_at: "2026-01-07T21:20:38Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Problem\nWhen selecting all sources ('a'), AudioMason asks the prompt:\nClean inbox after successful import? [y/N]\nwhile already iterating and processing sources, i.e. during the PROCESS phase.\n\nEvidence\nExample log excerpt:\n[ignore] added: Komensky.JanAmos\n[inbox] cleaned: /mnt/warez/abooksinbox/Komensky.JanAmos\n[stage] cleaned: /mnt/warez/_am_stage/Komensky.JanAmos\n[source] 4/14: Lipton.BruceH\nClean inbox after successful import? [y/N]\n\nKey observations:\n- All sources were selected\n- Source iteration is already in progress (4/14)\n- PROCESS phase is active\n- clean_inbox prompt appears mid-run\n\nWhy this is wrong\nThe clean_inbox decision is a global / batch-level concern.\nAsking it during PROCESS:\n- breaks phase separation\n- breaks determinism\n- creates confusing UX\n\nExpected behavior\n- clean_inbox decision must be resolved once per run\n- it must be resolved either:\n  - before any PROCESS starts, or\n  - after all sources finish processing\n- the prompt must never appear mid-PROCESS\n\nActual behavior\n- clean_inbox prompt is evaluated inside the per-source loop\n- it can appear after some sources are already processed\n\nScope (STRICT)\n- Move clean_inbox decision to a clear phase boundary\n- Ensure it is resolved once per batch\n- Preserve existing defaults and config behavior\n- No new features, only phase-correctness"
      closed_at: "2026-01-07T21:20:38Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-07T10:13:08Z"
      html_url: "https://github.com/michalholes/audiomason/issues/88"
      labels:
        []
      milestone: null
      number: 88
      state: "closed"
      title: "Bug: clean_inbox prompt appears during PROCESS when selecting all sources"
      updated_at: "2026-01-07T21:20:38Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "98cd29b80b6370b29d03f05417575e787a6081ff"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/98cd29b80b6370b29d03f05417575e787a6081ff"
        created_at: "2026-01-07T21:02:12Z"
        event: "referenced"
        id: 21908089837
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "f02dbfe17abb6f09f34ccc81468968339db7e552"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/f02dbfe17abb6f09f34ccc81468968339db7e552"
        created_at: "2026-01-07T21:20:33Z"
        event: "referenced"
        id: 21908385057
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-07T21:20:38Z"
        event: "commented"
        id: 3720861147
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-07T21:20:39Z"
        event: "closed"
        id: 21908387343
  -
    comments:
      -
        body: "Implemented CLI override for prompts.disable via --disable-prompt.\n\nCommits:\n- 5d92dd4 Feat/Fix: CLI support for global prompt disable (--disable-prompt)\n- 4cd6c2b Docs: document --disable-prompt CLI override"
        created_at: "2026-01-08T08:14:25Z"
        html_url: "https://github.com/michalholes/audiomason/issues/89#issuecomment-3722709959"
        id: 3722709959
        updated_at: "2026-01-08T08:14:25Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Follow-up to Issue #76.\n\nAdd CLI support for global prompt disable so users can override config at runtime.\n\nRequirements:\n- --disable-prompt '*' disables all prompts\n- --disable-prompt choose_books,choose_source supports selective disable\n- CLI overrides config\n- Same validation rules as config (unknown key, duplicates, '*' exclusivity)\n- Deterministic behavior only (fail-fast if no default)\n\nScope:\n- CLI parsing\n- Wiring into existing prompts.disable mechanism\n- Tests only (no docs in this issue)"
      closed_at: "2026-01-08T08:14:26Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-07T23:29:36Z"
      html_url: "https://github.com/michalholes/audiomason/issues/89"
      labels:
        []
      milestone: null
      number: 89
      state: "closed"
      title: "Feat: CLI flag for global prompt disable (--disable-prompt)"
      updated_at: "2026-01-08T08:14:26Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "5d92dd4e689a5af80bf0e2a9c1b202e2eccd0b4f"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/5d92dd4e689a5af80bf0e2a9c1b202e2eccd0b4f"
        created_at: "2026-01-08T08:04:54Z"
        event: "referenced"
        id: 21916802157
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "4cd6c2baae786f489fe41cd6145af74bd9d0c0e8"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/4cd6c2baae786f489fe41cd6145af74bd9d0c0e8"
        created_at: "2026-01-08T08:11:57Z"
        event: "referenced"
        id: 21916991638
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T08:14:25Z"
        event: "commented"
        id: 3722709959
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-08T08:14:26Z"
        event: "closed"
        id: 21917058993
  -
    comments:
      -
        body: "Implemented default Buy Me a Coffee support banner after successful import. All tests passed. Commit: 8c1db6f"
        created_at: "2026-01-09T21:17:56Z"
        html_url: "https://github.com/michalholes/audiomason/issues/90#issuecomment-3730602394"
        id: 3730602394
        updated_at: "2026-01-09T21:17:56Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "## Goal\n\nEnable optional, non-intrusive financial support for AudioMason via Buy Me a Coffee,\nwithout introducing paywalls, prompts, or behavior changes.\n\nAudioMason remains 100% open-source and fully functional without support.\n\n---\n\n## Scope\n\nThis issue introduces *visibility only*:\n- no feature gating\n- no interactive prompts\n- no conditional behavior\n\n---\n\n## Tasks\n\n### 1. README.md\n- Add a short **Support AudioMason** section\n- Include a single Buy Me a Coffee link\n- Tone: technical, respectful, no guilt-tripping\n\nExample copy (may be adjusted):\n\nAudioMason is free and open-source.\nIf it saves you time or frustration, consider supporting development:\nhttps://buymeacoffee.com/audiomason\n\n---\n\n### 2. CLI output (non-interactive)\n- Print **one informational line** per run\n- No prompts, no input required\n- Must respect unattended / non-interactive runs\n\nExample:\n\nâ˜• Enjoying AudioMason?  \nSupport development: https://buymeacoffee.com/audiomason\n\nPlacement:\n- startup or final summary\n- printed exactly once per invocation\n\n---\n\n### 3. Documentation\n- Add a short support note at the end of user-facing docs\n- Explain that support helps maintenance and long-term quality\n- No mention of money needs or personal finance\n\n---\n\n## Non-goals (explicitly out of scope)\n\n- No paywalled features\n- No supporter-only functionality\n- No ads or banners\n- No additional prompts\n- No behavior changes based on support status\n\n---\n\n## Acceptance criteria\n\n- AudioMason behavior remains unchanged\n- CLI remains fully non-interactive\n- Support link is visible but unobtrusive\n- Documentation updated accordingly\n\n---\n\n## Notes\n\nBuy Me a Coffee page already exists:\nhttps://buymeacoffee.com/audiomason"
      closed_at: "2026-01-09T21:17:57Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-08T00:06:57Z"
      html_url: "https://github.com/michalholes/audiomason/issues/90"
      labels:
        []
      milestone: null
      number: 90
      state: "closed"
      title: "Feat: add Buy Me a Coffee support (non-intrusive monetization)"
      updated_at: "2026-01-09T21:17:57Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "5d41c27bae16c3328a7a9f8296e187a9b04d7217"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/5d41c27bae16c3328a7a9f8296e187a9b04d7217"
        created_at: "2026-01-09T20:22:59Z"
        event: "referenced"
        id: 21955325012
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "f92e75e9ca3f11d826274805619045af92ff92b5"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/f92e75e9ca3f11d826274805619045af92ff92b5"
        created_at: "2026-01-09T20:53:09Z"
        event: "referenced"
        id: 21955752714
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "8c1db6f61f295a17c632b7a778c0cf6a4c1e4ea3"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/8c1db6f61f295a17c632b7a778c0cf6a4c1e4ea3"
        created_at: "2026-01-09T21:14:53Z"
        event: "referenced"
        id: 21956065373
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T21:17:56Z"
        event: "commented"
        id: 3730602394
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-09T21:17:57Z"
        event: "closed"
        id: 21956104648
  -
    comments:
      -
        body: "Sub-issues created:\n- #92 Design: canonical preflight orchestration (step registry + run/source/book levels)\n- #93 Refactor: move preflight prompts under step registry + enforce ordering\n- #94 Cleanup: align docs + repo_manifest + remove legacy inline preflight codepaths"
        created_at: "2026-01-08T20:54:46Z"
        html_url: "https://github.com/michalholes/audiomason/issues/91#issuecomment-3725752407"
        id: 3725752407
        updated_at: "2026-01-08T20:54:46Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Resolved by canonical preflight orchestration refactor (#93) and cleanup/guardrails (#94)."
        created_at: "2026-01-09T18:07:20Z"
        html_url: "https://github.com/michalholes/audiomason/issues/91#issuecomment-3730022467"
        id: 3730022467
        updated_at: "2026-01-09T18:07:20Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Issue #66 introduced preflight_steps with deterministic ordering and fail-fast validation.\nDuring implementation, several architectural limitations were identified.\n\nIssue #66 is correctly implemented and closed.\nThis issue tracks known design gaps discovered during that work.\n\n## Problem statement\n\npreflight_steps currently does not fully control all preflight prompts.\n\nKey gaps:\n- Not all preflight prompts are modeled as steps (run-level, inline prompts)\n- Some step_keys are evaluated as blocks, not individually ordered\n- Side-effect driven prompts weaken ordering guarantees\n- State-dependent steps may never trigger\n- Normalizations and suggestion prompts are not first-class steps\n\n## Goal\n\nDefine and implement a fully preflight-driven orchestration model with:\n- canonical step registry,\n- explicit run/source/book execution levels,\n- precise ordering guarantees,\n- complete and truthful preflight_steps control surface.\n\n## Non-goals\n\n- No changes to Issue #66 behavior\n- No breaking changes without explicit migration\n- No UI / API work\n\n## Acceptance criteria\n\n- All preflight prompts are either canonical steps or explicitly documented exceptions\n- Clear execution-level separation\n- Deterministic model is documented\n- Tests cover ordering and conditional execution\n\n## References\n\n- Issue #66\n- dd7b455 (code + tests)\n- 1cd69c7 (docs + repo_manifest)"
      closed_at: "2026-01-09T18:07:20Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-08T20:51:51Z"
      html_url: "https://github.com/michalholes/audiomason/issues/91"
      labels:
        []
      milestone: null
      number: 91
      state: "closed"
      title: "Enhancement: preflight_steps does not fully control all preflight prompts"
      updated_at: "2026-01-09T18:07:20Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:53:51Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:53:52Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:53:54Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:46Z"
        event: "commented"
        id: 3725752407
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "4da3cf30248eaea00dc2244cc84d5fbb8c85e300"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/4da3cf30248eaea00dc2244cc84d5fbb8c85e300"
        created_at: "2026-01-08T21:00:14Z"
        event: "referenced"
        id: 21932715878
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-09T18:07:20Z"
        event: "closed"
        id: 21953091729
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T18:07:20Z"
        event: "commented"
        id: 3730022467
  -
    comments:
      -
        body: "Parent: #91"
        created_at: "2026-01-08T20:54:49Z"
        html_url: "https://github.com/michalholes/audiomason/issues/92#issuecomment-3725752752"
        id: 3725752752
        updated_at: "2026-01-08T20:54:49Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "## Design brief (Issue #92) â€“ Canonical preflight orchestration\n\n### Problem\nAfter #66, `preflight_steps` exists and is deterministic, but it does not fully control all preflight prompts:\n- some prompts remain inline / outside ordering,\n- some steps behave as blocks (e.g. publishâ†’wipe_id3), so ordering inside the block is not controllable,\n- some prompts are side-effect driven (flow-dependent),\n- some steps are state-dependent (eligible only under certain runtime conditions),\n- sub-prompts (normalizations, â€œapply suggestionâ€¦â€) are not first-class steps.\n\n### Goal (target architecture)\nDefine a fully preflight-driven orchestration model where:\n- every preflight prompt is registered as a canonical step (or explicitly documented exception),\n- execution level is explicit: run / source / book,\n- ordering guarantees are precise and enforceable,\n- conditioned steps are deterministic and auditable,\n- `preflight_steps` becomes a complete and truthful control surface.\n\n### Canonical Step Registry (concept)\nEach step is a first-class registry entry:\n- key (canonical step_key)\n- level: run|source|book\n- eligibility conditions (deterministic predicates)\n- decision outputs (what is set/produced)\n- prompts: list of PromptSpec (ideally 1 prompt == 1 step if we want full ordering control)\n- default policy (for deterministic non-interactive behavior)\n- optional doc_ref\n\n**Rule:** no preflight prompt may exist outside the registry unless explicitly documented as an exception.\n\n### Ordering rules\n- Default order is defined by the registry per level; if no config is provided, behavior MUST match current default order.\n- Config ordering validation per level: unknown key / duplicate / missing required key => FAIL-FAST.\n- Conditioned steps may be present in ordering but skipped if not eligible (deterministic).\n\n### Sub-prompts & suggestions\nDecision: model sub-prompts as **first-class steps** (preferred) so `preflight_steps` can order them.\nAlternative (nested prompts inside a step) reduces step count but prevents full ordering control.\n\n### Block coupling (publish + wipe_id3)\nDesign rule: either\n- split into independently orderable steps (preferred), or\n- explicitly mark as atomic bundle with a single key (then ordering inside is intentionally not controllable).\n\n### Deliverables for #92\n- Design doc in repo (proposed: docs/design/preflight_orchestration.md)\n- Proposed canonical step_key list (run/source/book) + mapping notes\n- Decision points: (A) first-class sub-steps vs nested sub-prompts, (B) future per-level config keys"
        created_at: "2026-01-08T21:08:26Z"
        html_url: "https://github.com/michalholes/audiomason/issues/92#issuecomment-3725809554"
        id: 3725809554
        updated_at: "2026-01-08T21:08:26Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "## Design brief (Issue #92) â€“ Canonical preflight orchestration\n\n### Problem\nAfter #66, `preflight_steps` exists and is deterministic, but it does not fully control all preflight prompts:\n- some prompts remain inline / outside ordering,\n- some steps behave as blocks (e.g. publishâ†’wipe_id3), so ordering inside the block is not controllable,\n- some prompts are side-effect driven (flow-dependent),\n- some steps are state-dependent (eligible only under certain runtime conditions),\n- sub-prompts (normalizations, â€œapply suggestionâ€¦â€) are not first-class steps.\n\n### Goal (target architecture)\nDefine a fully preflight-driven orchestration model where:\n- every preflight prompt is registered as a canonical step (or explicitly documented exception),\n- execution level is explicit: run / source / book,\n- ordering guarantees are precise and enforceable,\n- conditioned steps are deterministic and auditable,\n- `preflight_steps` becomes a complete and truthful control surface.\n\n### Canonical Step Registry (concept)\nEach step is a first-class registry entry:\n- key (canonical step_key)\n- level: run|source|book\n- eligibility conditions (deterministic predicates)\n- decision outputs (what is set/produced)\n- prompts: list of PromptSpec (ideally 1 prompt == 1 step if we want full ordering control)\n- default policy (for deterministic non-interactive behavior)\n- optional doc_ref\n\n**Rule:** no preflight prompt may exist outside the registry unless explicitly documented as an exception.\n\n### Ordering rules\n- Default order is defined by the registry per level; if no config is provided, behavior MUST match current default order.\n- Config ordering validation per level: unknown key / duplicate / missing required key => FAIL-FAST.\n- Conditioned steps may be present in ordering but skipped if not eligible (deterministic).\n\n### Sub-prompts & suggestions\nDecision: model sub-prompts as **first-class steps** (preferred) so `preflight_steps` can order them.\nAlternative (nested prompts inside a step) reduces step count but prevents full ordering control.\n\n### Block coupling (publish + wipe_id3)\nDesign rule: either\n- split into independently orderable steps (preferred), or\n- explicitly mark as atomic bundle with a single key (then ordering inside is intentionally not controllable).\n\n### Deliverables for #92\n- Design doc in repo (proposed: docs/design/preflight_orchestration.md)\n- Proposed canonical step_key list (run/source/book) + mapping notes\n- Decision points: (A) first-class sub-steps vs nested sub-prompts, (B) future per-level config keys"
        created_at: "2026-01-08T21:33:01Z"
        html_url: "https://github.com/michalholes/audiomason/issues/92#issuecomment-3725930497"
        id: 3725930497
        updated_at: "2026-01-08T21:33:01Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "## #92 Design â€“ finalize defaults: required/optional, eligibility, pending decisions, publish scope\n\nThis comment finalizes the actionable design knobs so #93 can implement without ambiguity.\n\n---\n\n## 1) Required vs Optional (for validation)\n\n**Required registry entries** (must exist as canonical steps; may still be skipped via eligibility):\n- `reuse_stage` (source)\n- `clean_stage` (source)\n- `use_manifest_answers` (source)\n- `skip_processed_books` (source, conditioned)\n- `publish` (default scope TBD below)\n- `wipe_id3` (book)\n\n**Optional registry entries** (may be absent depending on features/flow):\n- `clean_inbox` (source)\n- `normalize_author`, `normalize_title`\n- `apply_suggested_author`, `apply_suggested_title`\n- `tags`, `chapters`, `loudnorm`\n\n**Note:** â€œrequiredâ€ means **registry presence**, not that a prompt always appears.\n\n---\n\n## 2) Internal metadata: min_context + deterministic eligibility\n\nEach step defines:\n- `min_context`: `none | source_selected | books_selected`\n- `condition(ctx) -> bool` (deterministic; no heuristics)\n\nProposed defaults:\n- `reuse_stage`: min_context `source_selected`\n- `clean_stage`: `source_selected`\n- `use_manifest_answers`: `source_selected`\n- `skip_processed_books`: `books_selected`,\n  condition: manifest_exists AND processed_books_exist AND reuse_stage AND use_manifest_answers\n- `clean_inbox`: `source_selected`\n- `normalize_*`: `books_selected` (optional)\n- `apply_suggested_*`: `books_selected`, condition: suggestions_available\n- `tags/chapters/loudnorm`: `books_selected` (optional)\n- `publish/wipe_id3`: `books_selected`\n\n---\n\n## 3) Pending decisions (ordering freedom without heuristics)\n\nIf a step appears before `min_context` is satisfied:\n- it is recorded as a **pending decision** (not skipped, not fail-fast),\n- it is **materialized deterministically** once the required context exists.\n\nMaterialization rules:\n- pending decisions materialize in the same order as encountered in `preflight_steps`,\n- override precedence: `book > author > source > run`,\n- at equal scope: **last wins**.\n\nThis enables moving steps â€œearlyâ€ while preserving intended scope.\n\n---\n\n## 4) Default scope decision: `publish`\n\nDesign choice needed for implementation:\n\n- **Option A (recommended):** default `publish` scope = `source`\n  - sets publish behavior for all selected books within the source,\n  - allows later per-book override (when supported).\n- Option B: default scope = `book`\n  - finer control but more prompts by default.\n\n**Proposal:** choose **Option A** (source) to preserve a sane default UX and allow overrides later.\n\n---\n\n## 5) Canonical default ordering (baseline)\n\nSelection steps are non-movable and always first:\n1. `select_source`\n2. `select_books`\n\nDefault movable order proposal (baseline; #93 must verify/freeze against current behavior):\n1. `reuse_stage`\n2. `clean_stage`\n3. `use_manifest_answers`\n4. `skip_processed_books` (conditioned)\n5. `clean_inbox`\n6. `normalize_author`\n7. `normalize_title`\n8. `apply_suggested_author`\n9. `apply_suggested_title`\n10. `tags`\n11. `chapters`\n12. `loudnorm`\n13. `publish`\n14. `wipe_id3` (default after publish to preserve current publishâ†’wipe user experience)\n\n---\n\n## 6) Acceptance for #92 deliverable\n\n- publish default scope decision recorded (A or B),\n- the above defaults become the design contract for #93 refactor work."
        created_at: "2026-01-08T21:47:19Z"
        html_url: "https://github.com/michalholes/audiomason/issues/92#issuecomment-3725975422"
        id: 3725975422
        updated_at: "2026-01-08T21:47:19Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Design completed and implemented by #93 and #94. See docs/design/preflight_orchestration.md."
        created_at: "2026-01-09T18:07:01Z"
        html_url: "https://github.com/michalholes/audiomason/issues/92#issuecomment-3730021504"
        id: 3730021504
        updated_at: "2026-01-09T18:07:01Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Parent: #91\n\n## Goal\nDefine the target architecture for fully preflight-driven orchestration:\n- canonical step registry (all prompts as steps or explicitly documented exceptions)\n- explicit execution levels: run / source / book\n- deterministic ordering guarantees and how they are enforced\n- rules for conditional (state-dependent) steps\n- rules for sub-prompts (normalizations/suggestions) as first-class steps vs. nested prompts\n\n## Deliverables\n- Design doc (in-repo) describing:\n  - step registry API (data model, keys, metadata: level, dependencies, default order)\n  - orchestration algorithm (how steps are executed and skipped)\n  - migration plan from current flow to registry-driven flow\n  - what remains intentionally outside steps (if anything) + rationale\n- Test strategy for ordering and conditional execution\n\n## Acceptance criteria\n- Design doc merged\n- Clear, implementable plan for refactor and cleanup work (scoped into follow-up issues)"
      closed_at: "2026-01-09T18:07:02Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-08T20:53:50Z"
      html_url: "https://github.com/michalholes/audiomason/issues/92"
      labels:
        []
      milestone: null
      number: 92
      state: "closed"
      title: "Design: canonical preflight orchestration (step registry + run/source/book levels) (Follow-up to #91)"
      updated_at: "2026-01-09T18:07:02Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:48Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:49Z"
        event: "commented"
        id: 3725752752
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:52Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T21:08:26Z"
        event: "commented"
        id: 3725809554
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T21:33:01Z"
        event: "commented"
        id: 3725930497
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T21:47:19Z"
        event: "commented"
        id: 3725975422
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "3af2c88473a873a75536606449bf06f5866091a2"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/3af2c88473a873a75536606449bf06f5866091a2"
        created_at: "2026-01-08T21:58:18Z"
        event: "referenced"
        id: 21933762763
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T18:07:01Z"
        event: "commented"
        id: 3730021504
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-09T18:07:02Z"
        event: "closed"
        id: 21953086595
  -
    comments:
      -
        body: "Parent: #91 (depends on #92)"
        created_at: "2026-01-08T20:54:51Z"
        html_url: "https://github.com/michalholes/audiomason/issues/93#issuecomment-3725752995"
        id: 3725752995
        updated_at: "2026-01-08T20:54:51Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "## Execution plan (Issue #93) â€“ CODE + DOCS + repo_manifest (per IL v2.4)\n\nScope for #93 includes:\n- CODE refactor implementing #92 design (step registry + unified ordering + pending decisions)\n- TESTS to lock deterministic behavior and ordering semantics\n- DOCS update describing the new orchestration model (user-facing + internal notes as needed)\n- repo_manifest.yaml update (if new files/anchors are introduced or modified)\n\nNon-movable (excluded from ordering):\n- select_source\n- select_books\n\nMovable ordering control:\n- single global preflight_steps list (everything else)\n\nKey mechanisms to implement:\n- canonical step registry (keys + internal metadata)\n- default ordering baseline (must preserve current default behavior)\n- config validation (unknown/dup/missing required)\n- pending decisions (materialize deterministically when context appears)\n- ensure no preflight prompt executes outside the registry\n\nDeliverables:\n- commit(s) for code+tests\n- docs commit (can be same commit if runner allows; otherwise multi-commit within #93)\n- repo_manifest.yaml updated accordingly"
        created_at: "2026-01-08T21:54:44Z"
        html_url: "https://github.com/michalholes/audiomason/issues/93#issuecomment-3725995752"
        id: 3725995752
        updated_at: "2026-01-08T21:54:44Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Parent: #91\nDepends on: Design issue for #91\n\n## Goal\nRefactor implementation so preflight_steps fully controls ordering by executing prompts via the canonical step registry.\n\n## Scope\n- introduce step registry data structure + dispatcher\n- migrate existing preflight prompts into step-based execution (run/source/book as per design)\n- ensure block-coupled prompts (e.g. publish/wipe_id3) become independently orderable steps (or explicitly justified exception per design)\n- preserve default behavior when preflight_steps is not set\n- preserve existing config semantics unless migration is explicitly designed\n\n## Acceptance criteria\n- preflight_steps ordering is honored for all modeled steps\n- deterministic behavior maintained; invalid config fails fast\n- tests cover:\n  - full ordering control\n  - conditional step skipping (state-dependent) without breaking determinism"
      closed_at: "2026-01-08T23:49:45Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-08T20:53:51Z"
      html_url: "https://github.com/michalholes/audiomason/issues/93"
      labels:
        []
      milestone: null
      number: 93
      state: "closed"
      title: "Refactor: move preflight prompts under step registry + enforce ordering (Follow-up to #91)"
      updated_at: "2026-01-08T23:49:45Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:48Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:51Z"
        event: "commented"
        id: 3725752995
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:53Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T21:47:20Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T21:54:44Z"
        event: "commented"
        id: 3725995752
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "3af2c88473a873a75536606449bf06f5866091a2"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/3af2c88473a873a75536606449bf06f5866091a2"
        created_at: "2026-01-08T21:58:18Z"
        event: "referenced"
        id: 21933762737
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e2df9ccc0235568e79125746e4f96c13eff9ab38"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e2df9ccc0235568e79125746e4f96c13eff9ab38"
        created_at: "2026-01-08T22:01:53Z"
        event: "referenced"
        id: 21933840154
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "384a3a6424d5426a232242621a53f905be369ef6"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/384a3a6424d5426a232242621a53f905be369ef6"
        created_at: "2026-01-08T22:03:01Z"
        event: "referenced"
        id: 21933859379
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "b7b5032090a5da25c453d87dfe2d283bc79936ff"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/b7b5032090a5da25c453d87dfe2d283bc79936ff"
        created_at: "2026-01-08T23:03:26Z"
        event: "referenced"
        id: 21934781320
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e1d2cc1d320d03e0dabe0876d31e95ab74df0be4"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e1d2cc1d320d03e0dabe0876d31e95ab74df0be4"
        created_at: "2026-01-08T23:22:44Z"
        event: "referenced"
        id: 21935084635
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "1fdd207bdcaf9bdab3678f6a103f8b551a8e793b"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/1fdd207bdcaf9bdab3678f6a103f8b551a8e793b"
        created_at: "2026-01-08T23:31:27Z"
        event: "referenced"
        id: 21935223512
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "9526eaaa7871d25906498be58dfb0853da56582b"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/9526eaaa7871d25906498be58dfb0853da56582b"
        created_at: "2026-01-08T23:33:47Z"
        event: "referenced"
        id: 21935255491
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "dcebad517b3aebd09695603989974bad573ac6fa"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/dcebad517b3aebd09695603989974bad573ac6fa"
        created_at: "2026-01-08T23:45:52Z"
        event: "referenced"
        id: 21935402941
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e2344d6e973ddcef1eb0c8e7906096db06e3398c"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e2344d6e973ddcef1eb0c8e7906096db06e3398c"
        created_at: "2026-01-08T23:49:45Z"
        event: "closed"
        id: 21935442692
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "6d24ee71a924e1763ba96cfc5806a03fe17104de"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/6d24ee71a924e1763ba96cfc5806a03fe17104de"
        created_at: "2026-01-09T08:09:53Z"
        event: "referenced"
        id: 21941597097
  -
    comments:
      -
        body: "Parent: #91 (depends on #93)"
        created_at: "2026-01-08T20:54:53Z"
        html_url: "https://github.com/michalholes/audiomason/issues/94#issuecomment-3725753166"
        id: 3725753166
        updated_at: "2026-01-08T20:54:53Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Parent: #91\nDepends on: Refactor issue for #91\n\n## Goal\nClean up and finalize after refactor:\n- remove legacy inline preflight prompt codepaths that bypass registry\n- update docs to reflect the canonical step registry model (including level semantics)\n- update docs/prompt catalog cross-links where applicable\n- ensure docs/repo_manifest.yaml is updated if file structure/anchors changed\n\n## Acceptance criteria\n- no remaining preflight prompts bypass the registry unless explicitly documented exceptions exist\n- docs updated and cross-linked\n- repo_manifest.yaml updated (if applicable)\n- tests remain green"
      closed_at: "2026-01-09T10:00:36Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-08T20:53:53Z"
      html_url: "https://github.com/michalholes/audiomason/issues/94"
      labels:
        []
      milestone: null
      number: 94
      state: "closed"
      title: "Cleanup: align docs + repo_manifest + remove legacy inline preflight codepaths (Follow-up to #91)"
      updated_at: "2026-01-09T10:00:36Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:48Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-08T20:54:53Z"
        event: "commented"
        id: 3725753166
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "4da3cf30248eaea00dc2244cc84d5fbb8c85e300"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/4da3cf30248eaea00dc2244cc84d5fbb8c85e300"
        created_at: "2026-01-08T21:00:14Z"
        event: "referenced"
        id: 21932715899
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "f73a5a8d45e1a97f5aeebddbfbfd945a89883408"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/f73a5a8d45e1a97f5aeebddbfbfd945a89883408"
        created_at: "2026-01-09T07:58:33Z"
        event: "referenced"
        id: 21941405082
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "6d24ee71a924e1763ba96cfc5806a03fe17104de"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/6d24ee71a924e1763ba96cfc5806a03fe17104de"
        created_at: "2026-01-09T08:09:53Z"
        event: "referenced"
        id: 21941597119
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "b084ad21f4d6eb2a3e2cefc05408207e1df7d377"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/b084ad21f4d6eb2a3e2cefc05408207e1df7d377"
        created_at: "2026-01-09T09:35:31Z"
        event: "referenced"
        id: 21943167087
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "4a50b29605aeca4d6f3f48d7d1973036fb0f2793"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/4a50b29605aeca4d6f3f48d7d1973036fb0f2793"
        created_at: "2026-01-09T10:00:37Z"
        event: "closed"
        id: 21943672125
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T18:07:02Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "Implemented governance version helper tool: scripts/gov_versions.py + scripts/gov_versions.md. Pushed in range 874539c..63828b1."
        created_at: "2026-01-09T09:38:05Z"
        html_url: "https://github.com/michalholes/audiomason/issues/95#issuecomment-3728095169"
        id: 3728095169
        updated_at: "2026-01-09T09:38:05Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "\n### Scope clarification (follow-up)\n\nThis issue is extended to require that the helper tool dynamically discovers\n**all current and future governance documents** located in `docs/governance/`.\n\nThe script MUST NOT rely on hardcoded filenames.\nDiscovery MUST be applied consistently to:\n- --list\n- --check\n- --set-version\n\nThis aligns the tool with current governance rules stating that\nall laws with legislative authority (including future ones)\nare part of a single Governance Set.\n\nNo governance documents are to be modified as part of this issue.\n"
        created_at: "2026-01-09T10:16:53Z"
        html_url: "https://github.com/michalholes/audiomason/issues/95#issuecomment-3728274816"
        id: 3728274816
        updated_at: "2026-01-09T10:16:53Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "DONE.\n\nImplementation + tests:\n- b312da4: Fix: make VERSION_RE multiline-safe (Issue #95)\n- b5ca989: Fix: repair broken test_future_law_included block (Issue #95 follow-up)\n\nGovernance alignment (future laws + enforcement):\n- 2b77768: Governance: hard-ban deprecated HANDOFF_CONTRACT across all laws\n- 758f139: Governance: enforce mandatory gov_versions usage and consultant as primary guardian\n- 2ba2573: Governance: finalize consultant as primary guardian and mandatory version checks\n\nNotes:\n- gov_versions discovers docs/governance/*.md (future laws included) with deterministic ordering.\n- Version parsing is header-only (first 60 lines) to avoid body-text example ambiguity.\n- --check defaults to lockstep; use --check --mode independent unless versions are unified via --set-version.\n"
        created_at: "2026-01-09T12:04:39Z"
        html_url: "https://github.com/michalholes/audiomason/issues/95#issuecomment-3728638327"
        id: 3728638327
        updated_at: "2026-01-09T12:04:39Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "## Goal\n\nAdd a deterministic script to verify (and optionally synchronize) versions across governance documents in `docs/governance/`.\n\n**Important constraint:** this issue must NOT change any governance documents or their versions. The user wants to review the script first; only later will we decide whether to run it and/or amend governance rules.\n\n---\n\n## Scope\n\n### MUST\n- Add a script that scans `docs/governance/*.md` and reads `Version:` (case-insensitive).\n- Implement `--check` (read-only):\n  - exit non-zero if any file is missing `Version:`\n  - in `lockstep` mode, exit non-zero if versions are not identical\n- Implement `--set-version X.Y` (write mode):\n  - update only the `Version:` line in all governance docs\n  - preserve the rest of each file unchanged\n  - fail-fast if `Version:` cannot be uniquely located/updated\n- Deterministic, fail-fast behavior\n- Add pytest tests:\n  - `--check` fails when a file is missing `Version:`\n  - `--set-version` updates versions consistently\n\n### SHOULD\n- `--list` prints `file -> version`\n- `--mode lockstep|independent` (default lockstep)\n- `--dry-run` for `--set-version`\n\n### MUST NOT\n- Do NOT edit any governance documents in `docs/governance/` as part of this issue.\n- Do NOT change the Project Constitution or any laws.\n- Do NOT create/close issues from the implementation chat.\n\n---\n\n## Acceptance Criteria\n\n- Running `python <script> --check` works on the repo and returns correct exit status.\n- Running `python <script> --list` shows all governance docs and versions.\n- Tests pass.\n- No governance document content is modified in this issue.\n\n---\n\n## Notes\n\nThis script will later be referenced by governance rules, but that is explicitly out of scope for this issue.\n"
      closed_at: "2026-01-09T12:04:48Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-09T08:57:26Z"
      html_url: "https://github.com/michalholes/audiomason/issues/95"
      labels:
        -
          name: "governance"
      milestone: null
      number: 95
      state: "closed"
      title: "Chore: add governance version sync checker script (check + set-version) with tests"
      updated_at: "2026-01-09T12:04:48Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-09T08:57:27Z"
        event: "labeled"
        id: 21942414284
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "b312da411c480dd46808646dd29bb7a8c6dfc51f"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/b312da411c480dd46808646dd29bb7a8c6dfc51f"
        created_at: "2026-01-09T09:06:28Z"
        event: "referenced"
        id: 21942589858
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T09:38:05Z"
        event: "commented"
        id: 3728095169
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-09T09:38:06Z"
        event: "closed"
        id: 21943220855
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-09T10:16:42Z"
        event: "reopened"
        id: 21944025209
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T10:16:53Z"
        event: "commented"
        id: 3728274816
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "b5ca98907b2020f4c6fd50e6114663fa77c83207"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/b5ca98907b2020f4c6fd50e6114663fa77c83207"
        created_at: "2026-01-09T11:15:16Z"
        event: "referenced"
        id: 21945126582
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T12:04:39Z"
        event: "commented"
        id: 3728638327
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-09T12:04:48Z"
        event: "closed"
        id: 21945970855
  -
    comments:
      -
        body: "Additional requirement: This tool is expected to be used immediately after  and  as the next command in the workflow. Design the CLI and behavior so it can act as a natural follow-up step after issue state changes, with fast execution, deterministic output, and zero interactive prompts."
        created_at: "2026-01-09T13:51:14Z"
        html_url: "https://github.com/michalholes/audiomason/issues/96#issuecomment-3728994711"
        id: 3728994711
        updated_at: "2026-01-09T13:51:14Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Issue #96 closed.\n\nFinal commit:\n- 78542b4\n\nAll acceptance criteria met. No follow-ups required."
        created_at: "2026-01-09T16:44:35Z"
        html_url: "https://github.com/michalholes/audiomason/issues/96#issuecomment-3729753033"
        id: 3729753033
        updated_at: "2026-01-09T16:44:35Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "## Problem\nWe maintain two authoritative archive files in the repository:\n\n- `docs/contracts/projects/open_issues.md`\n- `docs/contracts/projects/closed_issues.md`\n\nThese files must reflect the **current state of GitHub issues**, including their **full bodies**.\nToday, this synchronization is manual and error-prone, which leads to drift.\n\n## Goal\nCreate a **standalone helper tool** that:\n\n1. Fetches issues from GitHub (open + closed)\n2. Renders them into a deterministic markdown archive format\n3. Updates `open_issues.md` and `closed_issues.md`\n4. Commits and pushes changes **only if a real diff exists**\n\nThis tool is intended to be run **immediately after** `gh issue open` or `gh issue close`\nas the next command in the workflow.\n\n## Non-goals\n- This tool is **NOT** part of AudioMason runtime or CLI.\n- No UI, no daemon, no long-running service.\n- No issue creation, editing, or closing.\n- No GitHub project or milestone management.\n\n## Requirements (must)\n\n### 1. Tool nature\n- Must be a **standalone helper script**, e.g. under `scripts/`\n- Must NOT import or depend on AudioMason code\n- Must be safe to run repeatedly (idempotent)\n\n### 2. Data source\n- GitHub is the **only source of truth**\n- Must fetch **full issue bodies**, not just titles\n- For each issue, archive must include:\n  - Issue number + title\n  - State (OPEN / CLOSED)\n  - Labels (if any)\n  - Assignees (if any)\n  - Milestone (if any)\n  - Created timestamp\n  - Updated timestamp\n  - Closed timestamp (for closed issues)\n  - Full issue body (verbatim, markdown preserved)\n\n### 3. Output files\nOnly these two files may be modified:\n- `docs/contracts/projects/open_issues.md`\n- `docs/contracts/projects/closed_issues.md`\n\nOrdering rules:\n- Open issues: ascending by issue number\n- Closed issues: descending by closed date, tie-break by issue number\n\nRendering rules:\n- Stable headings and delimiters per issue\n- No â€œgenerated at nowâ€ timestamps\n- Output must be byte-stable across runs if issues did not change\n\n### 4. Execution & safety\n- Non-interactive by default (no prompts)\n- Must FAIL-FAST with clear error if:\n  - GitHub auth is missing or invalid\n  - Rate limit prevents fetching\n  - Target files are missing\n  - Working tree is dirty (unless explicitly overridden)\n\n### 5. Git behavior\n- Must not commit if there is no diff\n- Deterministic commit message:\n  - `Docs: sync GitHub issues archive (open/closed)`\n- Default behavior:\n  - write files\n  - commit if diff exists\n  - push to default remote branch\n- Flags must allow:\n  - `--dry-run`\n  - `--no-commit`\n  - `--no-push`\n  - optional override for dirty working tree\n\n### 6. CLI\nCanonical invocation:\n```bash\npython3 scripts/sync_issues_archive.py\n```\n\nRequired flags:\n- `--repo <owner/name>` (default: auto-detect from git remote if possible)\n- `--dry-run`\n- `--no-commit`\n- `--no-push`\n\n### 7. Workflow intent (explicit)\nThis tool is designed to be used as a **natural follow-up command**:\n\n```bash\ngh issue open â€¦\npython3 scripts/sync_issues_archive.py\n```\n\n```bash\ngh issue close â€¦\npython3 scripts/sync_issues_archive.py\n```\n\nThe tool itself must not require chaining or interaction.\n\n## Acceptance criteria\n- Archives fully match GitHub issues (including full bodies)\n- Ordering and rendering are deterministic\n- Re-running with no issue changes produces no diff and no commit\n- With changes present, files are updated, committed, and pushed\n- Unit tests cover:\n  - ordering rules\n  - rendering stability\n  - no-diff â†’ no commit behavior\n  - correct open/closed split\n- `docs/repo_manifest.yaml` is updated if new scripts or tests are added\n\n## Notes\n- This is a project/tooling issue.\n- Implementation must follow Implementation Law for patch delivery and execution.\n"
      closed_at: "2026-01-09T16:44:35Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-09T13:48:41Z"
      html_url: "https://github.com/michalholes/audiomason/issues/96"
      labels:
        []
      milestone: null
      number: 96
      state: "closed"
      title: "Tooling: sync GitHub issues to open_issues.md + closed_issues.md (full bodies)"
      updated_at: "2026-01-09T16:44:35Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T13:51:14Z"
        event: "commented"
        id: 3728994711
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "78542b4447bb3e009184486c1e38482149f84687"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/78542b4447bb3e009184486c1e38482149f84687"
        created_at: "2026-01-09T16:36:56Z"
        event: "referenced"
        id: 21951439199
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-09T16:44:35Z"
        event: "closed"
        id: 21951586181
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-09T16:44:35Z"
        event: "commented"
        id: 3729753033
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Child of #79.\n\nMissing (per verification):\n- preflight prompt\n- --no-loudnorm\n- tests\n\nScope:\n- Add preflight prompt: \"Apply loudnorm? [y/N]\" (default No)\n- Add CLI symmetry: --loudnorm and --no-loudnorm\n- Allow config-hide/disable for the loudnorm prompt\n- Deterministic resolution: CLI > config > default\n- Tests: default, config-hide default, CLI override\n\nAcceptance criteria:\n- Deterministic behavior proven by tests\n- No interactive leakage in non-interactive contexts\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-10T00:19:35Z"
      html_url: "https://github.com/michalholes/audiomason/issues/97"
      labels:
        []
      milestone: null
      number: 97
      state: "open"
      title: "Sub-issue: loudnorm determinism (prompt + CLI symmetry + tests)"
      updated_at: "2026-01-10T00:22:18Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T00:21:10Z"
        event: "parent_issue_added"
        id: 21958431110
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Child of #79.\n\nMissing (per verification):\n- cleanup_stage is hardcoded True and not CLI-controllable\n\nScope:\n- Remove hardcoded cleanup_stage=True\n- Add explicit CLI enable/disable\n- Preserve default behavior unless overridden\n- Tests for CLI override + determinism\n\nAcceptance criteria:\n- CLI can explicitly control cleanup_stage\n- Default behavior unchanged unless explicitly overridden\n- Tests prove override\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-10T00:19:36Z"
      html_url: "https://github.com/michalholes/audiomason/issues/98"
      labels:
        []
      milestone: null
      number: 98
      state: "open"
      title: "Sub-issue: cleanup_stage must be CLI-controllable (remove hardcoded True)"
      updated_at: "2026-01-10T00:22:19Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T00:21:11Z"
        event: "parent_issue_added"
        id: 21958431242
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Child of #79.\n\nMissing (per verification):\n- clean_inbox prompt exists, but config-hide key is rejected by validation\n\nScope:\n- Fix validation to accept intended config-hide key\n- Ensure prompt hide works deterministically\n- Regression tests\n\nAcceptance criteria:\n- Valid config key passes validation\n- Hidden prompt applies deterministic behavior\n- Regression tests cover the bug\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-10T00:19:37Z"
      html_url: "https://github.com/michalholes/audiomason/issues/99"
      labels:
        []
      milestone: null
      number: 99
      state: "open"
      title: "Sub-issue: fix clean_inbox config-hide validation bug"
      updated_at: "2026-01-10T00:22:20Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T00:21:11Z"
        event: "parent_issue_added"
        id: 21958431209
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Child of #79.\n\nMissing (per verification):\n- docs do not reflect final behavior for the full Opts list\n\nScope:\n- Audit full Opts list from #79\n- Align docs with actual behavior:\n  - CLI flags\n  - config-hide/disable behavior\n  - determinism rules (CLI > config > default)\n\nFiles (expected):\n- README.md\n- docs/CLI.md\n- docs/CONFIGURATION.md\n\nAcceptance criteria:\n- Docs match actual behavior\n- No contradictions\n- Explicitly covers full Opts list from #79\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-10T00:19:38Z"
      html_url: "https://github.com/michalholes/audiomason/issues/100"
      labels:
        []
      milestone: null
      number: 100
      state: "open"
      title: "Sub-issue: docs audit & alignment for Opts CLI + config-hide behavior"
      updated_at: "2026-01-10T00:22:21Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T00:21:12Z"
        event: "parent_issue_added"
        id: 21958431330
  -
    comments:
      -
        body: "Fixed, validated, and tested. Docs and repo manifest in sync. Verified at SHA f78ef02."
        created_at: "2026-01-10T15:45:12Z"
        html_url: "https://github.com/michalholes/audiomason/issues/101#issuecomment-3733059529"
        id: 3733059529
        updated_at: "2026-01-10T15:45:12Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Observed in scripts/gov_versions.py:\n- VERSION_VALUE_RE expects vX.Y\n- set_version() writes Version: <new_version> without validating format\n\nImpact:\n- Tool can write a value that later fails validation, breaking lockstep/version checks.\n\nAcceptance criteria:\n- --set-version validates input against the same rules as --check (vX.Y)\n- tests updated/added to cover invalid input\n- docs/help output clearly states required format"
      closed_at: "2026-01-10T15:45:13Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T11:01:33Z"
      html_url: "https://github.com/michalholes/audiomason/issues/101"
      labels:
        []
      milestone: null
      number: 101
      state: "closed"
      title: "Bug: gov_versions.py --set-version allows invalid version, then --check fails"
      updated_at: "2026-01-10T15:45:13Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "f78ef02b871a0a502147843f13f73ee0f18d00c4"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/f78ef02b871a0a502147843f13f73ee0f18d00c4"
        created_at: "2026-01-10T15:39:20Z"
        event: "referenced"
        id: 21964150119
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T15:45:12Z"
        event: "commented"
        id: 3733059529
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T15:45:13Z"
        event: "closed"
        id: 21964199693
  -
    comments:
      -
        body: "Completed and verified. Launcher is now portable; no hardcoded paths."
        created_at: "2026-01-10T15:53:44Z"
        html_url: "https://github.com/michalholes/audiomason/issues/102#issuecomment-3733071885"
        id: 3733071885
        updated_at: "2026-01-10T15:53:44Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Current root script `am` hardcodes DIR=\"/home/pi/apps/audiomason\" and uses .venv from there.\n\nImpact:\n- Breaks on non-pi users or different install paths.\n- Makes fresh installs/migrations brittle.\n\nAcceptance criteria:\n- Launcher resolves repo root dynamically (relative to script location or via env var)\n- Works when repo is cloned to any path\n- Update docs accordingly"
      closed_at: "2026-01-10T15:53:44Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T11:02:30Z"
      html_url: "https://github.com/michalholes/audiomason/issues/102"
      labels:
        []
      milestone: null
      number: 102
      state: "closed"
      title: "Feat: Make ./am launcher portable (no hardcoded /home/pi path)"
      updated_at: "2026-01-10T15:53:44Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "6c2a6549062e81bcedddf71d6288ac47bad86d1e"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/6c2a6549062e81bcedddf71d6288ac47bad86d1e"
        created_at: "2026-01-10T15:52:33Z"
        event: "referenced"
        id: 21964268328
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T15:53:44Z"
        event: "commented"
        id: 3733071885
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T15:53:45Z"
        event: "closed"
        id: 21964275922
  -
    comments:
      -
        body: "Docs-only policy applied for .deb artifacts (docs-hosted APT). Closed at SHA 690a857."
        created_at: "2026-01-10T16:12:25Z"
        html_url: "https://github.com/michalholes/audiomason/issues/103#issuecomment-3733124934"
        id: 3733124934
        updated_at: "2026-01-10T16:12:25Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Repo contains multiple .deb artifacts under docs/apt/pool/main/...\n\nQuestion:\n- Should these live in Git (docs-hosted APT repo), or be released via GitHub Releases/Artifacts?\n\nAcceptance criteria:\n- Document chosen policy (where .deb live)\n- If moving out of Git: remove from repo and add guardrails\n- If keeping in Git: document update process and size expectations"
      closed_at: "2026-01-10T16:12:25Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T11:02:50Z"
      html_url: "https://github.com/michalholes/audiomason/issues/103"
      labels:
        []
      milestone: null
      number: 103
      state: "closed"
      title: "Repo hygiene: Decide how to store .deb artifacts (docs/apt/pool) and document policy"
      updated_at: "2026-01-10T16:12:25Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "690a857b8d69c6b046117ff3928a9579c6411c87"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/690a857b8d69c6b046117ff3928a9579c6411c87"
        created_at: "2026-01-10T16:11:23Z"
        event: "referenced"
        id: 21964438059
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T16:12:25Z"
        event: "closed"
        id: 21964446741
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T16:12:25Z"
        event: "commented"
        id: 3733124934
  -
    comments:
      -
        body: "Docs-only complete (LICENSE, SECURITY.md, CONTRIBUTING.md). Closed at SHA 6f7472f."
        created_at: "2026-01-10T16:33:16Z"
        html_url: "https://github.com/michalholes/audiomason/issues/104#issuecomment-3733174177"
        id: 3733174177
        updated_at: "2026-01-10T16:33:16Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Repo is missing standard policy docs:\n- LICENSE\n- SECURITY.md\n- CONTRIBUTING.md\n\nAcceptance criteria:\n- Add LICENSE (selected license)\n- Add SECURITY.md (vuln reporting)\n- Add CONTRIBUTING.md (dev/test workflow)\n- Mention in README"
      closed_at: "2026-01-10T16:33:16Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T11:02:59Z"
      html_url: "https://github.com/michalholes/audiomason/issues/104"
      labels:
        []
      milestone: null
      number: 104
      state: "closed"
      title: "Docs/Policy: Add LICENSE + SECURITY.md + CONTRIBUTING.md"
      updated_at: "2026-01-10T16:33:16Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T16:33:16Z"
        event: "closed"
        id: 21964619554
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T16:33:16Z"
        event: "commented"
        id: 3733174177
  -
    comments:
      -
        body: "CLI lazy-load config refactor complete. Closed at SHA 2f3a088."
        created_at: "2026-01-10T19:02:53Z"
        html_url: "https://github.com/michalholes/audiomason/issues/105#issuecomment-3733393387"
        id: 3733393387
        updated_at: "2026-01-10T19:02:53Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Decision: Variant A (lazy-load config).\n\nProblem:\n- CLI currently loads config during argument parsing, which breaks clean environments and makes tests brittle.\n\nScope:\n- _parse_args() must not call load_config().\n- Parse args first, then load config as part of command execution.\n\nAcceptance criteria:\n- `audiomason --help` and `audiomason --version` work without /etc config or user config.\n- `audiomason import ...` can be invoked in a clean env (unless config is truly required for that path).\n- Add/adjust tests to cover running without /etc/audiomason/config.yaml.\n- If `--config` is provided, it must be honored without requiring the default config file to exist."
      closed_at: "2026-01-10T19:02:54Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T11:14:39Z"
      html_url: "https://github.com/michalholes/audiomason/issues/105"
      labels:
        []
      milestone: null
      number: 105
      state: "closed"
      title: "Refactor: CLI arg parsing must not require config load (lazy-load config)"
      updated_at: "2026-01-10T19:02:54Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "2f3a0889419a825222ea73e7dca5be2f90c70e58"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/2f3a0889419a825222ea73e7dca5be2f90c70e58"
        created_at: "2026-01-10T18:58:50Z"
        event: "referenced"
        id: 21965532427
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T19:02:53Z"
        event: "commented"
        id: 3733393387
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T19:02:54Z"
        event: "closed"
        id: 21965556460
  -
    comments:
      -
        body: "Dev tooling (ruff + mypy) integrated. Closed at SHA c7bb850."
        created_at: "2026-01-10T20:10:13Z"
        html_url: "https://github.com/michalholes/audiomason/issues/106#issuecomment-3733452595"
        id: 3733452595
        updated_at: "2026-01-10T20:10:13Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Decision: Variant B (ruff + mypy).\n\nGoal:\n- Add lightweight, fast quality gates (lint/format + types) without heavy developer friction.\n\nScope:\n- Add `ruff` (lint + formatter).\n- Add `mypy` for static type checks (scope can start with src/audiomason only).\n- Wire into CI.\n\nAcceptance criteria:\n- `ruff check .` passes in CI.\n- `ruff format --check .` passes in CI.\n- `mypy` runs in CI (initially at least `src/audiomason`).\n- Document the commands in README or CONTRIBUTING (if present).\n- No changes required to end-user installs (dev/test extras only)."
      closed_at: "2026-01-10T20:10:13Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T11:14:45Z"
      html_url: "https://github.com/michalholes/audiomason/issues/106"
      labels:
        []
      milestone: null
      number: 106
      state: "closed"
      title: "Dev tooling: add ruff + mypy (CI + local workflow)"
      updated_at: "2026-01-10T20:10:13Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "c7bb850614a620d31f5e952cfab31124c5f98178"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/c7bb850614a620d31f5e952cfab31124c5f98178"
        created_at: "2026-01-10T20:08:41Z"
        event: "referenced"
        id: 21965853760
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T20:10:13Z"
        event: "commented"
        id: 3733452595
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T20:10:14Z"
        event: "closed"
        id: 21965860398
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T20:55:17Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "CI no longer writes to /etc; uses AUDIOMASON_CONFIG with documented precedence supporting CLI override, user (XDG), and system (/etc) configs."
        created_at: "2026-01-11T11:13:27Z"
        html_url: "https://github.com/michalholes/audiomason/issues/107#issuecomment-3734411726"
        id: 3734411726
        updated_at: "2026-01-11T11:13:27Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Decision: Variant A.\n\nProblem:\n- CI currently writes config to /etc/audiomason/config.yaml using sudo.\n- This makes tests less isolated and hides config-loading brittleness.\n\nScope:\n- Remove sudo copy into /etc from CI workflow.\n- Use `--config <repo>/debian/config.yaml` (or equivalent) in CI invocations.\n\nAcceptance criteria:\n- CI completes without writing to /etc and without sudo copy of config.\n- CI explicitly points CLI to a config via `--config`.\n- At least one test/execution path runs in a clean env (no /etc config present) to prevent regressions."
      closed_at: "2026-01-11T11:13:28Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T11:14:52Z"
      html_url: "https://github.com/michalholes/audiomason/issues/107"
      labels:
        []
      milestone: null
      number: 107
      state: "closed"
      title: "CI: avoid writing /etc/audiomason/config.yaml; use --config with repo config"
      updated_at: "2026-01-11T11:13:28Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T11:13:27Z"
        event: "commented"
        id: 3734411726
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "f5ebc4d0157f1079931a98ff7dd9792e1a27959c"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/f5ebc4d0157f1079931a98ff7dd9792e1a27959c"
        created_at: "2026-01-11T11:13:27Z"
        event: "referenced"
        id: 21969667826
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T11:13:28Z"
        event: "closed"
        id: 21969667937
  -
    comments:
      -
        body: "COMPLETE. Implemented in 0aa6d11. CI fix: gov_versions now accepts X.Y and vX.Y; tests passing."
        created_at: "2026-01-10T15:05:15Z"
        html_url: "https://github.com/michalholes/audiomason/issues/108#issuecomment-3732972515"
        id: 3732972515
        updated_at: "2026-01-10T15:05:15Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "CI fails on tests/test_gov_versions.py::test_set_version_makes_lockstep because test expectations are inconsistent with the canonical governance version format (vX.Y). The goal is to align the test and/or gov_versions behavior so --set-version and --check are consistent and CI passes. Out of scope: governance changes, new features, or refactors outside version tooling."
      closed_at: "2026-01-10T15:05:16Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T11:53:39Z"
      html_url: "https://github.com/michalholes/audiomason/issues/108"
      labels:
        -
          name: "bug"
      milestone: null
      number: 108
      state: "closed"
      title: "CI: fix gov_versions lockstep test to match canonical version format"
      updated_at: "2026-01-10T15:05:16Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T11:53:40Z"
        event: "labeled"
        id: 21962326507
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "0aa6d11eceae3275bb462717588cff14554bd53c"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/0aa6d11eceae3275bb462717588cff14554bd53c"
        created_at: "2026-01-10T14:55:23Z"
        event: "referenced"
        id: 21963675603
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T15:05:15Z"
        event: "commented"
        id: 3732972515
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T15:05:16Z"
        event: "closed"
        id: 21963784783
  -
    comments:
      -
        body: "Status @ 8753103:\n- ruff check .: OK (All checks passed)\n- ruff format --check .: OK (77 files already formatted)\n- mypy src/audiomason: OK (Success: no issues found)\n- pytest -q: OK (101 passed in 17.79s, Python 3.11.2, venv)"
        created_at: "2026-01-12T11:33:40Z"
        html_url: "https://github.com/michalholes/audiomason/issues/109#issuecomment-3738120983"
        id: 3738120983
        updated_at: "2026-01-12T11:33:40Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Closed @ 8753103: ruff + mypy strict cleanup complete; pytest green."
        created_at: "2026-01-12T11:33:41Z"
        html_url: "https://github.com/michalholes/audiomason/issues/109#issuecomment-3738121053"
        id: 3738121053
        updated_at: "2026-01-12T11:33:41Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "GOAL (AUTHORITATIVE)\nSystematically clean up the existing codebase so that:\n- ruff check .\n- ruff format --check .\n- mypy src/audiomason\nall pass with no exceptions in strict mode, without changing user-facing behavior.\n\nSCOPE (STRICT)\n- Cleanup only (no new features)\n- No CLI UX changes\n- No new runtime dependencies\n- No governance changes\n\nOUT OF SCOPE\n- New features\n- Architectural refactors unless strictly required for typing\n- CI wiring changes (introduced in #106)\n\nACCEPTANCE CRITERIA (EPIC)\n- Repo is ruff-clean and mypy-clean\n- CI can be re-enabled for push triggers after cleanup\n- Cleanup is delivered via small, auditable sub-issues\n\nEXECUTION RULE\n- Each sub-issue: small diff, isolated commit, independently closable\n- Close this EPIC only after all sub-issues are closed.\n\nSUB-ISSUES\n- Ruff: apply formatter repo-wide\n- Ruff: autofix all fixable lint errors\n- Ruff: resolve remaining lint findings\n- Mypy: fix Optional & None handling\n- Mypy: fix return types & helpers\n- Mypy: resolve remaining typing errors\n- CI: re-enable push-triggered runs\n"
      closed_at: "2026-01-12T11:33:41Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T20:55:16Z"
      html_url: "https://github.com/michalholes/audiomason/issues/109"
      labels:
        []
      milestone: null
      number: 109
      state: "closed"
      title: "EPIC: Codebase cleanup for strict ruff + mypy compliance"
      updated_at: "2026-01-12T11:33:41Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T09:17:02Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T15:31:35Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "304197feb50ef755156ae306ad0f4d56dd89a62a"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/304197feb50ef755156ae306ad0f4d56dd89a62a"
        created_at: "2026-01-11T16:13:34Z"
        event: "referenced"
        id: 21972011734
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "9b18f881593deb7ab79d6679db64e057163d8d0f"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/9b18f881593deb7ab79d6679db64e057163d8d0f"
        created_at: "2026-01-11T16:42:37Z"
        event: "referenced"
        id: 21972373957
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "c3ef2170ec6f46e0c994a96655da04d27f830de5"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/c3ef2170ec6f46e0c994a96655da04d27f830de5"
        created_at: "2026-01-11T17:49:27Z"
        event: "referenced"
        id: 21973216422
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "c7c95ed601ef022dd9251897bd74b208b25bd91f"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/c7c95ed601ef022dd9251897bd74b208b25bd91f"
        created_at: "2026-01-11T18:07:49Z"
        event: "referenced"
        id: 21973456355
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "71bdef339ab76eb62836d40b8b3516b7b34b0a2a"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/71bdef339ab76eb62836d40b8b3516b7b34b0a2a"
        created_at: "2026-01-11T18:11:35Z"
        event: "referenced"
        id: 21973509253
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "40ba7e7c1af40e45cbc969901be571d46dde4997"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/40ba7e7c1af40e45cbc969901be571d46dde4997"
        created_at: "2026-01-11T18:16:01Z"
        event: "referenced"
        id: 21973575745
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "bc7ab46deb4589d829b3f842058957258064659d"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/bc7ab46deb4589d829b3f842058957258064659d"
        created_at: "2026-01-12T01:53:58Z"
        event: "referenced"
        id: 21978942420
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "f8e601b1ce3b7c94e2377e3717a0628a71d1d71a"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/f8e601b1ce3b7c94e2377e3717a0628a71d1d71a"
        created_at: "2026-01-12T01:58:21Z"
        event: "referenced"
        id: 21978969882
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "0f7b265fd92ca840b0ee1ba9d02b494dc9b53e31"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/0f7b265fd92ca840b0ee1ba9d02b494dc9b53e31"
        created_at: "2026-01-12T09:28:20Z"
        event: "referenced"
        id: 21984483837
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-12T11:33:40Z"
        event: "commented"
        id: 3738120983
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-12T11:33:41Z"
        event: "commented"
        id: 3738121053
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-12T11:33:42Z"
        event: "closed"
        id: 21987238008
  -
    comments:
      -
        body: "Ruff formatter applied repo-wide; ruff check clean. Test failures tracked separately (tests rely on brittle source-code string matching)."
        created_at: "2026-01-11T10:49:30Z"
        html_url: "https://github.com/michalholes/audiomason/issues/110#issuecomment-3734393622"
        id: 3734393622
        updated_at: "2026-01-11T10:49:30Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "SCOPE\n- Run ruff formatter across the repo (one-time normalization).\n- No intentional behavior changes.\n\nACCEPTANCE CRITERIA\n- `ruff format --check .` passes.\n- Tests still pass.\n\nNOTES\n- Large file count is expected; this is mechanical churn only.\n"
      closed_at: "2026-01-11T10:49:31Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T20:55:17Z"
      html_url: "https://github.com/michalholes/audiomason/issues/110"
      labels:
        []
      milestone: null
      number: 110
      state: "closed"
      title: "Ruff: apply formatter repo-wide"
      updated_at: "2026-01-11T10:49:31Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T10:49:30Z"
        event: "commented"
        id: 3734393622
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "27e7c30472d2ebb24eda6d07c901e310f52eda58"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/27e7c30472d2ebb24eda6d07c901e310f52eda58"
        created_at: "2026-01-11T10:49:30Z"
        event: "referenced"
        id: 21969563733
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T10:49:31Z"
        event: "closed"
        id: 21969563782
  -
    comments:
      -
        body: "Completed via ruff autofix. Implemented in commit 50766e8."
        created_at: "2026-01-10T21:11:39Z"
        html_url: "https://github.com/michalholes/audiomason/issues/111#issuecomment-3733558025"
        id: 3733558025
        updated_at: "2026-01-10T21:11:39Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "SCOPE\n- Apply `ruff check --fix` for all safe/auto-fixable findings.\n- Keep changes mechanical where possible.\n\nACCEPTANCE CRITERIA\n- Ruff error count is significantly reduced.\n- No user-facing behavior changes.\n- Tests pass.\n"
      closed_at: "2026-01-10T21:11:40Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T20:55:18Z"
      html_url: "https://github.com/michalholes/audiomason/issues/111"
      labels:
        []
      milestone: null
      number: 111
      state: "closed"
      title: "Ruff: autofix all fixable lint errors"
      updated_at: "2026-01-10T21:11:40Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "50766e87069b74b69f01025b3ec777254caedb9b"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/50766e87069b74b69f01025b3ec777254caedb9b"
        created_at: "2026-01-10T21:09:56Z"
        event: "referenced"
        id: 21966165002
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T21:11:39Z"
        event: "commented"
        id: 3733558025
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T21:11:40Z"
        event: "closed"
        id: 21966172325
  -
    comments:
      -
        body: "Status: Done (tests green)\n\n- Fixed all actionable Ruff issues and correctness problems encountered during cleanup (imports, ambiguous vars, invalid identifiers, AppleDouble E902 handling).\n- Tests: 101 passed.\n- Remaining Ruff violations are now confined to a single legacy file: src/audiomason/import_flow.py (E501 only).\n\nNext step: track import_flow.py refactor in a dedicated issue (split monolith + address E501 structurally)."
        created_at: "2026-01-10T23:58:19Z"
        html_url: "https://github.com/michalholes/audiomason/issues/112#issuecomment-3733702581"
        id: 3733702581
        updated_at: "2026-01-10T23:58:19Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "SCOPE\n- Manually address remaining ruff findings after formatter + autofix.\n- Prefer minimal edits; no unrelated refactors.\n\nACCEPTANCE CRITERIA\n- `ruff check .` passes.\n- Tests pass.\n"
      closed_at: "2026-01-10T23:58:19Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T20:55:19Z"
      html_url: "https://github.com/michalholes/audiomason/issues/112"
      labels:
        []
      milestone: null
      number: 112
      state: "closed"
      title: "Ruff: resolve remaining lint findings"
      updated_at: "2026-01-10T23:58:19Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "40389ac7516025f7715448b6b0bb8db6a3a55ad9"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/40389ac7516025f7715448b6b0bb8db6a3a55ad9"
        created_at: "2026-01-10T21:50:17Z"
        event: "referenced"
        id: 21966394617
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e340aed4797fe100d22eb0c2ef10d659501227c2"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e340aed4797fe100d22eb0c2ef10d659501227c2"
        created_at: "2026-01-10T22:14:31Z"
        event: "referenced"
        id: 21966516417
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "5c7ac22c5fe89a2758bab32417979586d20ac78a"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/5c7ac22c5fe89a2758bab32417979586d20ac78a"
        created_at: "2026-01-10T22:18:00Z"
        event: "referenced"
        id: 21966532210
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "74b27527274a96213cb30892a17ef9bb88251ab9"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/74b27527274a96213cb30892a17ef9bb88251ab9"
        created_at: "2026-01-10T22:21:22Z"
        event: "referenced"
        id: 21966544194
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e17607aad15f1664aad1b9eca93e10204ba50eb2"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e17607aad15f1664aad1b9eca93e10204ba50eb2"
        created_at: "2026-01-10T22:38:23Z"
        event: "referenced"
        id: 21966607007
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "38f4d13324abfacbe0f9c41e5c42e0829835a1c0"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/38f4d13324abfacbe0f9c41e5c42e0829835a1c0"
        created_at: "2026-01-10T23:06:11Z"
        event: "referenced"
        id: 21966706387
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "8665becfdd17f679fe4bc00341136ea135e108aa"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/8665becfdd17f679fe4bc00341136ea135e108aa"
        created_at: "2026-01-10T23:07:08Z"
        event: "referenced"
        id: 21966710144
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "af17495867e601d784f0b10a85b84ce04dd12c54"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/af17495867e601d784f0b10a85b84ce04dd12c54"
        created_at: "2026-01-10T23:09:03Z"
        event: "referenced"
        id: 21966717131
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "5b64aa3f8e5eec833a215848b173a43ff187af4d"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/5b64aa3f8e5eec833a215848b173a43ff187af4d"
        created_at: "2026-01-10T23:10:39Z"
        event: "referenced"
        id: 21966723076
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "1a0e202b58337ad8312f520914b464d66860cc54"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/1a0e202b58337ad8312f520914b464d66860cc54"
        created_at: "2026-01-10T23:14:09Z"
        event: "referenced"
        id: 21966735888
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "405514f6697f507ed12dc2a49051d41a14ddc9d1"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/405514f6697f507ed12dc2a49051d41a14ddc9d1"
        created_at: "2026-01-10T23:23:52Z"
        event: "referenced"
        id: 21966769803
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "59259ee6d6ea774ccc2f99da0157f13c5e5383cb"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/59259ee6d6ea774ccc2f99da0157f13c5e5383cb"
        created_at: "2026-01-10T23:37:49Z"
        event: "referenced"
        id: 21966815731
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "319007a7d962c44fd5e72d4d36b93abddfd1a7fa"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/319007a7d962c44fd5e72d4d36b93abddfd1a7fa"
        created_at: "2026-01-10T23:49:17Z"
        event: "referenced"
        id: 21966864845
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "f088d8e5052901656050dbd08aa2afe111e9ce46"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/f088d8e5052901656050dbd08aa2afe111e9ce46"
        created_at: "2026-01-10T23:53:32Z"
        event: "referenced"
        id: 21966892982
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-10T23:58:19Z"
        event: "closed"
        id: 21966925154
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-10T23:58:19Z"
        event: "commented"
        id: 3733702581
  -
    comments:
      -
        body: "Closed via micro-patches (no behavior changes; tests green).\nImplemented:\n- 857bb65: narrow Google Books volumeInfo typing + fix paths.py cache type (Path|None)\n- da570c7: guard state.OPTS usage in audio.py + handle None dir_path in ignore.py\n\nResults:\n- pytest -q remains green (101 passed).\n- mypy reduced from 44 errors / 9 files to 25 errors / 5 files.\nRemaining mypy findings are outside #113 scope (helpers/deps/3rd-party typing + import_flow structural items) and are tracked in #114/#115 and #117."
        created_at: "2026-01-11T08:43:06Z"
        html_url: "https://github.com/michalholes/audiomason/issues/113#issuecomment-3734249342"
        id: 3734249342
        updated_at: "2026-01-11T08:43:06Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "SCOPE\n- Fix mypy errors related to Optional/None (guards, asserts, casts as needed).\n- Keep changes minimal; avoid broad refactors.\n\nACCEPTANCE CRITERIA\n- Mypy error count is reduced for Optional/None-related issues.\n- Tests pass.\n"
      closed_at: "2026-01-11T08:43:06Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T20:55:21Z"
      html_url: "https://github.com/michalholes/audiomason/issues/113"
      labels:
        []
      milestone: null
      number: 113
      state: "closed"
      title: "Mypy: fix Optional & None handling"
      updated_at: "2026-01-11T08:43:06Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T08:43:06Z"
        event: "closed"
        id: 21968954561
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T08:43:06Z"
        event: "commented"
        id: 3734249342
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T08:44:55Z"
        event: "cross-referenced"
        id: null
  -
    comments:
      -
        body: "Starting #114 after closing #113.\nCurrent mypy baseline after #113: 25 errors / 5 files.\nPlanned split (micro-commits):\n- 114A: manifest.py remove unused ignore + config.py DEFAULTS annotation\n- 114B: yaml typing policy (types-PyYAML vs mypy config) + implement\n- 114C: util.py subprocess.Popen monkeypatch typing fix\n(Keeping import_flow.py structural typing issues for #117, and mutagen APIC typing for #115)."
        created_at: "2026-01-11T08:44:54Z"
        html_url: "https://github.com/michalholes/audiomason/issues/114#issuecomment-3734253222"
        id: 3734253222
        updated_at: "2026-01-11T08:44:54Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Issue #114 resolved.\n\nCommits:\n- ade4b79 â€” annotate config defaults, remove unused ignore\n- 25c1689 â€” add types-PyYAML dev dependency\n- 44c1e90 â€” attempt: TRACE typing (superseded)\n- d58533d â€” final fix: TRACE monkeypatch typed via direct Popen subclass\n\nResult:\n- mypy errors reduced to 19 across 2 files (covers.py, import_flow.py)\n- util.py mypy clean\n- pytest: 101 passed"
        created_at: "2026-01-11T09:35:08Z"
        html_url: "https://github.com/michalholes/audiomason/issues/114#issuecomment-3734305359"
        id: 3734305359
        updated_at: "2026-01-11T09:35:08Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "SCOPE\n- Fix mypy errors related to return types, helper utilities, and implicit Any.\n- Minimal annotations/overloads where appropriate.\n\nACCEPTANCE CRITERIA\n- Mypy error count is further reduced.\n- Tests pass.\n"
      closed_at: "2026-01-11T09:35:08Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T20:55:22Z"
      html_url: "https://github.com/michalholes/audiomason/issues/114"
      labels:
        []
      milestone: null
      number: 114
      state: "closed"
      title: "Mypy: fix return types & helpers"
      updated_at: "2026-01-11T09:35:08Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T08:43:06Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T08:44:54Z"
        event: "commented"
        id: 3734253222
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T09:17:02Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T09:35:08Z"
        event: "closed"
        id: 21969207339
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T09:35:08Z"
        event: "commented"
        id: 3734305359
  -
    comments:
      -
        body: "Scope lock (authoritative for #115)\n\nGoal: Refactor src/audiomason/covers.py for maintainability while preserving exact existing behavior, and resolve mypy attr-defined errors related to mutagen APIC fields.\n\nStrict constraints:\n- No behavior changes. Output messages, return values, file writes, prompt flow, and exception swallowing must remain identical to current behavior.\n- src/audiomason/import_flow.py is explicitly out of scope (belongs to #117).\n- Keep pytest green. Do not introduce new runtime dependencies.\n\nBehavioral invariants (must remain identical):\n- extract_embedded_cover_from_mp3():\n  - ID3NoHeaderError -> return None.\n  - Use the first APIC-like frame with truthy .data; keep the same mime fallback behavior.\n- extract_cover_from_m4a():\n  - Swallow any failure via  (ffmpeg/run_cmd/IO/etc.).\n- choose_cover():\n  - Same mode semantics (skip/embedded/file/interactive), same prompt defaults, same KeyboardInterrupt behavior (skip).\n  - Same write targets (cover filename + location), same conversion behavior (non-JPEG via ffmpeg), same dry-run behavior (no writes).\n- convert_image_to_jpg():\n  - Missing ffmpeg must still hard-fail via die(...) exactly as before.\n\nAllowed refactor scope:\n- Extract internal helpers to reduce duplication (selection, writing, conversion wrapper).\n- Introduce a single local typing boundary for mutagen frames (e.g., Protocol + cast) to eliminate mypy attr-defined for APIC fields.\n- Improve readability without changing logic ordering or outcomes.\n\nTyping policy:\n- Prefer Protocol/cast over .\n- Use targeted ignores only as last resort and keep them local + justified."
        created_at: "2026-01-11T09:57:21Z"
        html_url: "https://github.com/michalholes/audiomason/issues/115#issuecomment-3734338640"
        id: 3734338640
        updated_at: "2026-01-11T09:57:21Z"
        user:
          id: 26916462
          login: "michalholes"
      -
        body: "Resolved in commit 37cc3c3.\n\n- Refactored src/audiomason/covers.py for maintainability with NO behavior change.\n- Fixed mypy attr-defined errors for mutagen APIC fields using a local Protocol/cast boundary.\n- Verification: mypy clean; pytest: 101 passed."
        created_at: "2026-01-11T10:24:28Z"
        html_url: "https://github.com/michalholes/audiomason/issues/115#issuecomment-3734364538"
        id: 3734364538
        updated_at: "2026-01-11T10:24:28Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "SCOPE\n- Resolve all remaining mypy errors in `src/audiomason`.\n- Use minimal, explicit typing fixes; avoid architecture changes.\n\nACCEPTANCE CRITERIA\n- `mypy src/audiomason` passes.\n- Tests pass.\n"
      closed_at: "2026-01-11T10:24:28Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-10T20:55:23Z"
      html_url: "https://github.com/michalholes/audiomason/issues/115"
      labels:
        []
      milestone: null
      number: 115
      state: "closed"
      title: "Mypy: resolve remaining typing errors"
      updated_at: "2026-01-11T10:24:28Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T08:43:06Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T08:44:55Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T09:17:02Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T09:57:21Z"
        event: "commented"
        id: 3734338640
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "37cc3c323de053c35b70a9e6e59c5de8c065a44b"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/37cc3c323de053c35b70a9e6e59c5de8c065a44b"
        created_at: "2026-01-11T10:24:27Z"
        event: "referenced"
        id: 21969443539
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T10:24:28Z"
        event: "closed"
        id: 21969443612
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T10:24:28Z"
        event: "commented"
        id: 3734364538
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "SCOPE\n- Restore CI workflow trigger to run on both push and pull_request.\n\nCHANGE\n- In `.github/workflows/ci.yml`, set:\n  on:\n    push:\n    pull_request:\n\nACCEPTANCE CRITERIA\n- CI runs on push and PR.\n- CI passes with ruff + mypy + pytest.\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-10T20:55:24Z"
      html_url: "https://github.com/michalholes/audiomason/issues/116"
      labels:
        []
      milestone: null
      number: 116
      state: "open"
      title: "CI: re-enable push-triggered runs"
      updated_at: "2026-01-10T20:55:24Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      []
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "## ðŸ“Œ PM SUMMARY â€” Issue #117\n**Refactor `import_flow` (safety-first, contract-driven)**\n\n**Status:** âœ… DONE / CLOSED  \n**Dependency:** Issue #118 â€” Behavior-based contract tests (completed, stable)\n\n---\n\n### 1. Goal (PM Perspective)\n\nThe goal of #117 was **not to change user-visible behavior**, but to:\n\n- reduce technical debt in `import_flow`,\n- separate responsibilities (discovery, preflight, processing, logging),\n- prepare the codebase for future changes,\n- **without any regression risk**.\n\nThis work was executed strictly under the protection of **behavior-based contracts introduced in #118**.\n\n> From a PM perspective: **#117 is infrastructure work, not a feature.**\n\n---\n\n### 2. Key Decisions (Authoritative)\n\n#### 2.1 Contracts are absolute\n- Tests from **#118 are authoritative**.\n- Any refactor that removes symbols, changes importability, or alters behavior is **invalid**, even if architecturally cleaner.\n\n#### 2.2 `import_flow` is NOT a thin orchestrator\n- `import_flow` functions as a **contract faÃ§ade module**.\n- Many â€œprivateâ€ helpers are imported **directly by tests**.\n- Attempting to convert it into a thin orchestrator at this stage was **strategically incorrect**.\n\n---\n\n### 3. Execution Summary\n\n#### Phase A â€” Preparation (SUCCESS)\n- #118 introduced behavior-based contract tests.\n- A stable, non-negotiable reference point was established.\n\n#### Phase B â€” Safe Refactors (SUCCESS)\nSteps 1â€“7:\n- helper extraction (discovery, preflight, processing, logging),\n- **no behavior change**,\n- ruff / pytest / mypy remained green.\n\n#### Phase C â€” Step 8 (CANCELLED)\n- Attempted thin-orchestrator refactor of `import_flow`.\n- Resulted in massive contract breakage (~40 failing tests).\n- **Step 8 was invalidated and reverted**, not fixed.\n\n---\n\n### 4. Final Resolution\n\n- Step 8 is **explicitly cancelled**\n- No Step 8 changes exist on `main`\n- `import_flow` remains a **contract faÃ§ade**\n\n---\n\n### 5. Outcome\n\n- Branch: `main`\n- Tests: **111/111 passing**\n- Ruff: clean\n- Mypy: clean\n- Zero user-visible behavior change\n- Technical debt reduced safely\n\n---\n\n### 6. Commits Included in #117\n\n```\na9bf732 Refactor: extract BookGroup type + ruff import ordering (Step 1 fix) (Issue #117)\n1efa9b6 Refactor: fix discovery step ruff issues (unused imports, ordering) (Step 2 fix) (Issue #117)\nc8c540f Refactor: Step 3 final mypy fix â€” guard state.OPTS None (Issue #117)\n226d4bb Refactor: Step 4 fix â€” staging imports ruff-clean (Issue #117)\n2ff1be4 Refactor: Step 5 fix â€” provide full write_tags signature (mypy clean) (Issue #117)\ne1d7f9a Refactor: Step 6 fix â€” ruff clean imports (Issue #117)\nb0bc6f7 Refactor: Step 7 fix â€” ruff clean logging imports (Issue #117)\n```\n\n*(Authoritative source: git history)*\n\n---\n\n### 7. One-Sentence PM Summary\n\nIssue #117 successfully reduced technical debt and prepared `import_flow` for future work without changing behavior; an attempted thin-orchestrator refactor was correctly cancelled thanks to contract tests from #118, preventing regressions.\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-10T23:58:24Z"
      html_url: "https://github.com/michalholes/audiomason/issues/117"
      labels:
        []
      milestone: null
      number: 117
      state: "open"
      title: "Refactor: split import_flow.py monolith (address E501 structurally)"
      updated_at: "2026-01-13T00:14:46Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T08:43:06Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T08:44:55Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T09:17:02Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T09:57:22Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "a9bf7329dcd59b30f52c884372afc2972c0ae68f"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/a9bf7329dcd59b30f52c884372afc2972c0ae68f"
        created_at: "2026-01-12T23:06:56Z"
        event: "referenced"
        id: 22001772315
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "1efa9b61d7260a87bc688b5151e9bb11627b40bc"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/1efa9b61d7260a87bc688b5151e9bb11627b40bc"
        created_at: "2026-01-12T23:10:01Z"
        event: "referenced"
        id: 22001815008
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "c8c540f1457ce50ca2e09f34c77c008f375ebc34"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/c8c540f1457ce50ca2e09f34c77c008f375ebc34"
        created_at: "2026-01-12T23:18:11Z"
        event: "referenced"
        id: 22001918937
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "226d4bbc385d4faa650d2a6f347065458c7959bd"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/226d4bbc385d4faa650d2a6f347065458c7959bd"
        created_at: "2026-01-12T23:20:18Z"
        event: "referenced"
        id: 22001943067
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "2ff1be4bb90ea9f5854b2bf4cfc91737bd5477bb"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/2ff1be4bb90ea9f5854b2bf4cfc91737bd5477bb"
        created_at: "2026-01-12T23:26:40Z"
        event: "referenced"
        id: 22002015619
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e1d7f9a158c305d6aba17ff8cdccf1cc04b5dbc5"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e1d7f9a158c305d6aba17ff8cdccf1cc04b5dbc5"
        created_at: "2026-01-12T23:29:01Z"
        event: "referenced"
        id: 22002041784
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "b0bc6f72485f6d36a4f3c8d619574dd3020d96b9"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/b0bc6f72485f6d36a4f3c8d619574dd3020d96b9"
        created_at: "2026-01-12T23:31:43Z"
        event: "referenced"
        id: 22002075506
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "26b4d65af4c0ff169639ddb2b9cdd12f7c83cc26"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/26b4d65af4c0ff169639ddb2b9cdd12f7c83cc26"
        created_at: "2026-01-13T00:20:51Z"
        event: "referenced"
        id: 22002762692
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "d154905a1cf86c356c2b6987e7bc78b9cb35b7e7"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/d154905a1cf86c356c2b6987e7bc78b9cb35b7e7"
        created_at: "2026-01-13T00:28:43Z"
        event: "referenced"
        id: 22002873795
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "### Problem\n\nThe current test suite execution time is excessively long (multiple minutes),\nwhich significantly slows down iterative development and cleanup work.\n\nThis is a practical developer productivity issue: frequent `pytest -q` runs\nare required during refactors and typing fixes, and test runtime dominates\nfeedback time.\n\n### Scope (this issue)\n\nThis issue is **test-only refactor / hygiene**:\n- No production code changes\n- No behavior changes\n- No reduction of test coverage\n\nThe goal is **performance and structure**, not semantics.\n\n### Observations\n\nLikely contributors (to be confirmed during implementation):\n- Repeated expensive setup across tests\n- Integration-style tests mixed with unit tests\n- Heavy filesystem and subprocess usage\n- Missing or suboptimal fixture scoping\n- No clear separation between fast and slow tests\n\n### Non-goals\n\n- Do NOT change application behavior\n- Do NOT weaken assertions just to gain speed\n- Do NOT mix this work with unrelated refactors (typing, ruff, core logic)\n\n### Expected outcomes\n\n- Significantly reduced wall-clock time for default `pytest` runs\n- Clear separation of fast unit tests vs slow integration tests\n- Ability to run a fast test subset during development\n- Optional markers (e.g. `@pytest.mark.slow`) for expensive tests\n\n### Notes\n\nThis issue is intentionally deferred until after current cleanup work\n(#109 / #114 / #115 / #117). It should be addressed once the codebase\nis structurally clean and typing noise is reduced.\n"
      closed_at: null
      closed_by: null
      created_at: "2026-01-11T09:17:01Z"
      html_url: "https://github.com/michalholes/audiomason/issues/118"
      labels:
        -
          name: "bug"
        -
          name: "tech-debt"
        -
          name: "performance"
        -
          name: "tests"
      milestone: null
      number: 118
      state: "open"
      title: "Refactor test suite to reduce execution time"
      updated_at: "2026-01-11T09:17:01Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T09:17:02Z"
        event: "labeled"
        id: 21969131206
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T09:17:02Z"
        event: "labeled"
        id: 21969131211
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T09:17:02Z"
        event: "labeled"
        id: 21969131216
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T09:17:02Z"
        event: "labeled"
        id: 21969131219
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-12T18:35:56Z"
        event: "cross-referenced"
        id: null
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "8e84d058902bfe89afb203839b922f75c2da855d"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/8e84d058902bfe89afb203839b922f75c2da855d"
        created_at: "2026-01-12T21:43:52Z"
        event: "referenced"
        id: 22000475118
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "04a9aa95e61c2061783aa3670b17a896d387a79f"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/04a9aa95e61c2061783aa3670b17a896d387a79f"
        created_at: "2026-01-12T22:24:05Z"
        event: "referenced"
        id: 22001206690
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Problem\n- Cover download from URL should accept more image types (e.g., PNG, GIF, AVIF) and normalize to a single on-disk format for consistency.\n\nScope\n- When a cover is provided via URL, allow common image formats (at least: jpg/jpeg, png, gif, avif).\n- Normalize output to a single format (default: JPEG) using the existing conversion mechanism (ffmpeg), preserving current cover filename conventions.\n- Maintain existing behavior for non-URL cover selection modes.\n\nAcceptance criteria\n- URL-based covers work for png/gif/avif (when ffmpeg supports the input).\n- Output is normalized to the chosen standard format (JPEG) whenever conversion is required.\n- No behavior changes for non-URL modes.\n- pytest stays green.\n\nNotes\n- If ffmpeg is missing, behavior must remain consistent with current conversion behavior (hard-fail via die(...) where conversion is required)."
      closed_at: null
      closed_by: null
      created_at: "2026-01-11T09:55:39Z"
      html_url: "https://github.com/michalholes/audiomason/issues/119"
      labels:
        -
          name: "enhancement"
      milestone: null
      number: 119
      state: "open"
      title: "Feat: Accept more image formats from URL and normalize cover output"
      updated_at: "2026-01-11T09:58:25Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T09:55:40Z"
        event: "labeled"
        id: 21969310433
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Problem\n- Some books have no embedded cover in the audio files, but a cover image exists in the same directory with a non-standard filename.\n\nScope\n- During cover selection, search the book/audio directory for image files (at least: *.jpg, *.jpeg, *.png, *.gif, *.avif).\n- Use a conservative heuristic:\n  - Prefer names that look like covers (cover, folder, front, jacket, artwork).\n  - If multiple candidates exist, select the best candidate deterministically.\n- Prompt the user to confirm using the detected file (respect --yes / non-interactive behavior).\n- Normalize to the standard cover output format and filename, preserving existing conversion rules.\n\nAcceptance criteria\n- If a directory image exists, the tool offers it as a candidate.\n- Heuristic is conservative (does not pick random images without prompting).\n- Existing behavior for embedded/file/url modes remains unchanged unless this new detection path is reached.\n- pytest stays green."
      closed_at: null
      closed_by: null
      created_at: "2026-01-11T09:56:08Z"
      html_url: "https://github.com/michalholes/audiomason/issues/120"
      labels:
        -
          name: "enhancement"
      milestone: null
      number: 120
      state: "open"
      title: "Feat: Detect cover images next to audio files (various filenames) and prompt to use them"
      updated_at: "2026-01-11T09:58:37Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T09:56:09Z"
        event: "labeled"
        id: 21969312844
  -
    comments:
      -
        body: "Refactored brittle source-code string matching to formatting-robust regex checks. Verified by pytest (101 passed). Commit: 0426583"
        created_at: "2026-01-11T12:54:22Z"
        html_url: "https://github.com/michalholes/audiomason/issues/121#issuecomment-3734523573"
        id: 3734523573
        updated_at: "2026-01-11T12:54:22Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        []
      body: "Several tests fail after ruff format because they assert exact source-code string layouts instead of semantic behavior.\\n\\nExamples:\\n- test_pipeline_steps_wired_into_process_book\\n- test_preflight_disable_callsites_do_not_bypass_pf_prompt_yes_no\\n- test_preflight_disable_cover_override_is_routed_via_pf_prompt\\n\\nUnderlying behavior is unchanged; only formatting/layout differs. Tests should assert semantics, not raw text."
      closed_at: "2026-01-11T12:54:22Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-11T10:48:31Z"
      html_url: "https://github.com/michalholes/audiomason/issues/121"
      labels:
        -
          name: "bug"
        -
          name: "cleanup"
      milestone: null
      number: 121
      state: "closed"
      title: "Bug: Tests rely on brittle source-code string matching (break on formatting)"
      updated_at: "2026-01-11T12:54:22Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T10:48:32Z"
        event: "labeled"
        id: 21969559995
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T10:48:32Z"
        event: "labeled"
        id: 21969560003
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "0426583dee991b95deebaf6d08c80e3cadb8cf52"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/0426583dee991b95deebaf6d08c80e3cadb8cf52"
        created_at: "2026-01-11T12:54:19Z"
        event: "referenced"
        id: 21970183597
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-11T12:54:22Z"
        event: "closed"
        id: 21970183871
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-11T12:54:22Z"
        event: "commented"
        id: 3734523573
  -
    comments:
      -
        body: "Implemented and merged: am_patch runner consolidated upgrades."
        created_at: "2026-01-12T10:45:46Z"
        html_url: "https://github.com/michalholes/audiomason/issues/122#issuecomment-3737919076"
        id: 3737919076
        updated_at: "2026-01-12T10:45:46Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        -
          id: 26916462
          login: "michalholes"
      body: "## Goal\nUpgrade the am_patch runner in a single, consolidated change set.\n\nThis issue intentionally groups multiple accepted improvements to avoid fragmented runner behavior and repeated migrations.\n\n---\n\n## Scope (ACCEPTED)\n\n### 1) Pre-flight guards\n- Fail if HEAD is detached\n- Fail if branch has no upstream (before push)\n- Fail early if venv / required tools are missing\n\n### 2) Verify-only mode\n- Run patch + tests\n- No commit, no push\n- Explicit READY / NOT READY output\n\n### 3) Logs: dedicated directory + retention\n- Log dir: `/home/pi/apps/patches/logs/`\n- Per-run logs: `am_patch_<ISSUE>_<YYYYmmdd_HHMMSS>.log`\n- Stable symlink: `/home/pi/apps/patches/am_patch.log` â†’ latest log\n- Automatic retention: keep last **20** logs\n- Prune only files matching `am_patch_*_*.log`\n\n### 4) Static validation of patch scripts (pre-exec gate)\n- Enforce required sections / anchors\n- Reject dangerous operations (e.g. shell-outs, destructive ops, network)\n\n### 5) Git diff / stat outputs\n- Print `git diff --name-status`\n- Print `git diff --stat`\n- Emit on success and on failure paths\n\n### 6) Lock outside patches directory\n- Primary: `/run/audiomason/am_patch.lock`\n- Fallback: `/tmp/audiomason/am_patch.lock`\n\n### 7) Test policy switches (safe-by-default)\n- Default remains strict (all tests)\n- Optional flags: `--tests`, `--no-mypy`, `--no-ruff`\n\n---\n\n## Non-goals\n- No change to core patch semantics beyond what is listed\n- No JSON summary output (explicitly deferred)\n\n## Notes\n- All changes must be deterministic, idempotent, and fully documented.\n- Documentation (`scripts/am_patch.md`) and repo manifest must be updated accordingly."
      closed_at: "2026-01-12T10:45:47Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-12T10:11:25Z"
      html_url: "https://github.com/michalholes/audiomason/issues/122"
      labels:
        -
          name: "tooling"
      milestone: null
      number: 122
      state: "closed"
      title: "am_patch: consolidate runner upgrades (logs, validation, guards, verify-only, lock, tests)"
      updated_at: "2026-01-12T10:45:47Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-12T10:11:25Z"
        event: "assigned"
        id: 21985440591
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-12T10:11:26Z"
        event: "labeled"
        id: 21985441030
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "b1ed00f974fe6abf0c567d28a5bf53f77ddbd63b"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/b1ed00f974fe6abf0c567d28a5bf53f77ddbd63b"
        created_at: "2026-01-12T10:44:28Z"
        event: "referenced"
        id: 21986140126
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-12T10:45:46Z"
        event: "commented"
        id: 3737919076
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-12T10:45:47Z"
        event: "closed"
        id: 21986168482
  -
    comments:
      -
        body: "Closed as fixed.\n\nFix: 1949c89\nDocs/manifest: 8ffc64b"
        created_at: "2026-01-13T09:09:32Z"
        html_url: "https://github.com/michalholes/audiomason/issues/123#issuecomment-3743071478"
        id: 3743071478
        updated_at: "2026-01-13T09:09:32Z"
        user:
          id: 26916462
          login: "michalholes"
    issue:
      assignees:
        -
          id: 26916462
          login: "michalholes"
      body: "## Summary\n\nAfter the recent refactor, AudioMason logs that the user config was loaded, but runtime behavior ignores configured paths and falls back to the default XDG data directory.\n\n## Reproduction\n\n1. Ensure config exists at:\n   /home/pi/.config/audiomason/config.yaml\n2. Run:\n   am --debug\n\nObserved output:\n[TRACE] [config] loaded_from=/home/pi/.config/audiomason/config.yaml\n\n## Actual behavior\n\nDespite the config being reported as loaded, AudioMason writes data to:\n  ~/.local/share/audiomason/\n\nExample:\n  ~/.local/share/audiomason/abooks\n  ~/.local/share/audiomason/abooks_ready\n  ~/.local/share/audiomason/_am_stage\n\n## Expected behavior\n\nConfigured paths from config.yaml must be respected.\n\nExpected roots:\n- inbox:   /mnt/warez/am/inbox\n- library: /mnt/warez/abooks\n- staging: /mnt/warez/am/staging\n- cache:   /mnt/warez/am/.audiomason-cache\n- trash:   /mnt/media/am/.audiomason-trash\n\nNo writes should occur under ~/.local/share/audiomason unless explicitly configured.\n\n## Config used\n\npaths:\n  inbox: /mnt/warez/am/inbox\n  library: /mnt/warez/abooks\n  staging: /mnt/warez/am/staging\n  cache: /mnt/warez/am/.audiomason-cache\n  trash: /mnt/media/am/.audiomason-trash\n\n## Notes\n\nThis looks like a regression introduced by the refactor:\n- config is discovered and parsed (loaded_from is printed),\n- but paths are either not propagated into runtime state,\n  overridden later by defaults, or downstream code reads a different config object.\n\nThe bug is observable immediately on am --debug, without running an import.\n\n## Acceptance criteria\n\n- Configured paths.* are applied consistently across runtime.\n- No fallback to XDG data dir when paths are explicitly configured.\n- Add a regression test asserting path propagation."
      closed_at: "2026-01-13T09:09:33Z"
      closed_by:
        id: 26916462
        login: "michalholes"
      created_at: "2026-01-13T00:40:58Z"
      html_url: "https://github.com/michalholes/audiomason/issues/123"
      labels:
        -
          name: "bug"
      milestone: null
      number: 123
      state: "closed"
      title: "Bug: config.yaml is loaded but paths are ignored (fallback to ~/.local/share/audiomason)"
      updated_at: "2026-01-13T09:09:33Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T00:40:59Z"
        event: "assigned"
        id: 22003025664
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T00:41:00Z"
        event: "labeled"
        id: 22003025912
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "1949c89fda1b9c956b0a32309e938f1682f46ba2"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/1949c89fda1b9c956b0a32309e938f1682f46ba2"
        created_at: "2026-01-13T07:58:27Z"
        event: "referenced"
        id: 22009391189
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "8ffc64b8c306e71895d6397a21e924333c89ba4b"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/8ffc64b8c306e71895d6397a21e924333c89ba4b"
        created_at: "2026-01-13T08:53:02Z"
        event: "referenced"
        id: 22010647147
      -
        actor:
          id: 26916462
          login: "michalholes"
        created_at: "2026-01-13T09:09:32Z"
        event: "commented"
        id: 3743071478
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T09:09:33Z"
        event: "closed"
        id: 22011026287
  -
    comments:
      []
    issue:
      assignees:
        -
          id: 26916462
          login: "michalholes"
      body: "## Summary\n\nAudioMason does not preflight-check required external tools and capabilities.\nAs a result, valid inputs can fail late and with unclear errors when a required\nexternal program or capability is missing on the system.\n\n## Problem\n\nExample failure:\n- Valid RAR archive\n- System does not have unrar and current 7z build cannot extract it\n- Runtime error:\n  External tool failed: 7z (exit 2)\n  Sub items Errors: 152\n\nAt this point the user cannot distinguish:\n- corrupted archive\n- missing system capability\n- unsupported format on this platform\n\nSimilar issues apply to other required tools (e.g. ffmpeg).\n\n## Root cause\n\nAudioMason invokes external tools opportunistically but does NOT verify\ntool presence or capability up front. The pipeline therefore fails late\ninstead of fail-fast.\n\n## Expected behavior\n\nAudioMason MUST perform a preflight capability check before processing.\n\nAt minimum:\n- Detect required external tools:\n  - 7z / p7zip-full\n  - unrar (when RAR archive is detected)\n  - ffmpeg (when audio processing or cover conversion is required)\n- Fail fast with a clear, actionable error if a requirement is missing.\n- Design must allow adding future tool checks centrally.\n\n## Scope\n\nIN SCOPE:\n- Centralized external tool / capability detection\n- Clear fail-fast errors for missing tools\n- Extensible design for future tools\n\nOUT OF SCOPE:\n- Implementing new extractors\n- Bundling external binaries\n- Changing archive formats or workflows\n\n## Acceptance criteria\n\n- Missing required tools are detected before runtime execution.\n- Error messages clearly explain WHAT is missing and WHY execution cannot continue.\n- ffmpeg presence is validated before it is required.\n- Future tool checks can be added without ad-hoc logic."
      closed_at: null
      closed_by: null
      created_at: "2026-01-13T08:23:11Z"
      html_url: "https://github.com/michalholes/audiomason/issues/124"
      labels:
        -
          name: "bug"
      milestone: null
      number: 124
      state: "open"
      title: "Bug: missing preflight detection of required external tools (7z/unrar/ffmpeg)"
      updated_at: "2026-01-13T08:23:11Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T08:23:11Z"
        event: "assigned"
        id: 22009937915
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T08:23:12Z"
        event: "labeled"
        id: 22009938285
  -
    comments:
      []
    issue:
      assignees:
        -
          id: 26916462
          login: "michalholes"
      body: "## Summary\n\nAfter recent refactors, AudioMason no longer produces visible logging output.\nLogs are missing both in console output and expected log destinations, even\nwhen running with debug enabled.\n\nThis makes troubleshooting and error diagnosis extremely difficult.\n\n## Observed behavior\n\n- Running AudioMason produces little to no log output.\n- Debug mode does not visibly increase logging.\n- No clear indication where logs are written (if at all).\n\n## Expected behavior\n\n- AudioMason must emit logs consistently:\n  - to console (respecting verbosity / debug flags),\n  - and/or to a defined log destination when configured.\n- Logging behavior must be deterministic and documented.\n- Debug mode must visibly increase logging detail.\n\n## Suspected cause\n\nLogging initialization or propagation was lost or altered during refactor:\n- missing or broken logging configuration,\n- logger hierarchy not wired correctly across modules,\n- handlers not attached or log level overridden.\n\n## Scope\n\nIN SCOPE:\n- Restore functional logging\n- Ensure logs are visible and actionable\n- Fix regression introduced by refactor\n\nOUT OF SCOPE:\n- Redesign of logging system\n- New logging features\n- Log format changes (unless strictly required)\n\n## Acceptance criteria\n\n- Logs are visible during normal execution.\n- Debug mode produces clearly more verbose logs.\n- Logging works across refactored modules.\n- No silent execution without logs."
      closed_at: null
      closed_by: null
      created_at: "2026-01-13T08:26:21Z"
      html_url: "https://github.com/michalholes/audiomason/issues/125"
      labels:
        -
          name: "bug"
      milestone: null
      number: 125
      state: "open"
      title: "Bug: logging output missing after refactor (no visible logs)"
      updated_at: "2026-01-13T08:26:21Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T08:26:21Z"
        event: "assigned"
        id: 22010010998
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T08:26:22Z"
        event: "labeled"
        id: 22010011264
  -
    comments:
      []
    issue:
      assignees:
        -
          id: 26916462
          login: "michalholes"
      body: "## Summary\n\nAudioMason writes the ignored-books state file into the inbox directory.\nInbox is an input-only area and must never be polluted with runtime or state artifacts.\n\nAffected file:\n- .abook_ignore\n\n## Evidence (authoritative)\n\nThe following file is present in the inbox after a run:\n/mnt/warez/am/inbox/.abook_ignore\n\nThis file is created by AudioMason during processing and is not part of the original input.\n\n## Actual behavior\n\n- .abook_ignore is written directly into the inbox directory.\n- Inbox content is modified as a side effect of a run.\n\n## Expected behavior\n\n- .abook_ignore MUST NOT be written into inbox.\n- It must be stored in the run working directory:\n  - stage directory, or\n  - per-run / per-source state directory,\n  - or another canonical working/state location defined by the pipeline.\n- Inbox must remain input-only and unchanged by runtime artifacts.\n\n## Why this is a bug\n\n- Inbox is a discovery and input contract and must remain clean.\n- Writing state into inbox breaks determinism and hygiene.\n- It can silently affect future runs by changing discovery behavior.\n- Users reasonably expect inbox contents to be user-controlled only.\n\n## Scope\n\nIN SCOPE:\n- Move .abook_ignore out of inbox into the canonical working/state directory.\n- Ensure no runtime artifacts are written into inbox.\n\nOUT OF SCOPE:\n- Redesign of ignore semantics.\n- Changes to ignore file format or naming.\n- Any new features.\n\n## Acceptance criteria\n\n- .abook_ignore is no longer created in inbox.\n- It is written only into the canonical working/state directory.\n- Inbox remains unchanged after a run (except explicit, user-driven actions).\n- A regression test asserts the correct artifact location."
      closed_at: null
      closed_by: null
      created_at: "2026-01-13T08:38:17Z"
      html_url: "https://github.com/michalholes/audiomason/issues/126"
      labels:
        -
          name: "bug"
      milestone: null
      number: 126
      state: "open"
      title: "Bug: ignored-books file is written into inbox instead of the run working directory"
      updated_at: "2026-01-13T08:41:00Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T08:38:17Z"
        event: "assigned"
        id: 22010297570
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T08:38:19Z"
        event: "labeled"
        id: 22010297996
  -
    comments:
      []
    issue:
      assignees:
        -
          id: 26916462
          login: "michalholes"
      body: "## Summary\n\nThe test suite can be fully green while core user-visible behaviors are broken.\nThis indicates missing or ineffective coverage (false-green regressions), especially after refactors.\n\n## Evidence / recent regressions not caught by tests\n\n- Config is reported as loaded, but configured paths are ignored (fallback to XDG defaults).\n- Logging output missing after refactor.\n- .abook_ignore artifact written into inbox instead of a working/state directory.\n- Missing preflight detection of required external tools/capabilities (7z/unrar/ffmpeg), causing late unclear failures.\n\n## Expected behavior\n\n- For every user-visible contract, tests must fail when the behavior is broken.\n- Refactors must be protected by behavior-based contract tests, not just unit tests of helpers.\n\n## Scope\n\nIN SCOPE:\n- Add/strengthen behavior-based tests that cover the critical contracts:\n  - config path propagation to runtime\n  - logging visibility/initialization contract\n  - artifact placement contract (no writes into inbox)\n  - external tool/capability preflight checks\n- Ensure each regression test fails on the broken state and passes after the fix.\n\nOUT OF SCOPE:\n- Test performance refactor (tracked separately).\n- Large architectural redesign.\n\n## Acceptance criteria\n\n- Each known regression has a corresponding test that fails before the fix and passes after.\n- Test suite prevents repeating these regressions in future refactors."
      closed_at: null
      closed_by: null
      created_at: "2026-01-13T08:43:45Z"
      html_url: "https://github.com/michalholes/audiomason/issues/127"
      labels:
        -
          name: "bug"
      milestone: null
      number: 127
      state: "open"
      title: "Bug: test suite is green but misses key behaviors (false-green regressions)"
      updated_at: "2026-01-13T08:43:45Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T08:43:45Z"
        event: "assigned"
        id: 22010420034
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T08:43:47Z"
        event: "labeled"
        id: 22010420586
  -
    comments:
      []
    issue:
      assignees:
        -
          id: 26916462
          login: "michalholes"
      body: "After recent fixes around logging initialization, it is clear that\nsrc/audiomason/cli.py mixes:\n\n- argument parsing\n- environment / logging initialization\n- runtime execution\n- error handling (nested try/except)\n\nin a single large control flow.\n\nThis makes safe integration of cross-cutting concerns (logging, metrics,\nprofiling) fragile and error-prone.\n\nGoal of this issue:\n- split CLI flow into explicit phases:\n  - init / setup\n  - runtime execution\n- reduce indentation depth and nested try/except blocks\n- make the CLI entrypoint structurally safe for future infra changes\n\nOut of scope:\n- behavioral changes\n- logging redesign (already handled elsewhere)\n- feature changes\n\nThis is a pure structural refactor."
      closed_at: null
      closed_by: null
      created_at: "2026-01-13T09:53:30Z"
      html_url: "https://github.com/michalholes/audiomason/issues/128"
      labels:
        -
          name: "refactor"
      milestone: null
      number: 128
      state: "open"
      title: "Refactor: split CLI init and runtime execution"
      updated_at: "2026-01-13T09:53:30Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T09:53:30Z"
        event: "assigned"
        id: 22012037135
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: null
        commit_url: null
        created_at: "2026-01-13T09:53:31Z"
        event: "labeled"
        id: 22012037870
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "e0c0d80c8f859ed117a6b2c89ae70f9c6b6ab668"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/e0c0d80c8f859ed117a6b2c89ae70f9c6b6ab668"
        created_at: "2026-01-13T20:28:46Z"
        event: "referenced"
        id: 22026936219
  -
    comments:
      []
    issue:
      assignees:
        []
      body: "Extend sync_issues_archive tool to additionally generate a single deterministic YAML file containing all issues (open + closed), including full comments, timeline events, close metadata, and commit SHA references explaining when, why, and how issues were closed."
      closed_at: null
      closed_by: null
      created_at: "2026-01-14T17:52:03Z"
      html_url: "https://github.com/michalholes/audiomason/issues/131"
      labels:
        []
      milestone: null
      number: 131
      state: "open"
      title: "Tooling: extend sync_issues_archive with full YAML issues export"
      updated_at: "2026-01-14T17:52:03Z"
      user:
        id: 26916462
        login: "michalholes"
    timeline:
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "357c3379ad0f2765a85a79a80ea9e9592d97258b"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/357c3379ad0f2765a85a79a80ea9e9592d97258b"
        created_at: "2026-01-14T18:24:32Z"
        event: "referenced"
        id: 22050349985
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "84b817df0639111ad2ed26b934550ac4f35391ba"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/84b817df0639111ad2ed26b934550ac4f35391ba"
        created_at: "2026-01-14T18:43:33Z"
        event: "referenced"
        id: 22050733162
      -
        actor:
          id: 26916462
          login: "michalholes"
        commit_id: "c260d35ccf6f7dffd385650cf4bfc23088138eb7"
        commit_url: "https://api.github.com/repos/michalholes/audiomason/commits/c260d35ccf6f7dffd385650cf4bfc23088138eb7"
        created_at: "2026-01-14T20:40:05Z"
        event: "referenced"
        id: 22052948703
repo: "michalholes/audiomason"
